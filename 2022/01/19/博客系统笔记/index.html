<!DOCTYPE HTML>
<html lang="zh-CN">


<head>
    <meta charset="utf-8">
    <meta name="keywords" content="陈豪的博客">
    <meta name="description" content="博客系统笔记一、项目讲解说明
提供前端工程，只需要实现后端接口即可
项目以单体架构入手，先快速开发，不考虑项目优化，降低开发负担
开发完成后，开始优化项目，提升编程思维能力
比如页面静态化，缓存，云存储，日志等
docker部署上线
云服务">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <meta name="renderer" content="webkit|ie-stand|ie-comp">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="format-detection" content="telephone=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="referrer" content="no-referrer-when-downgrade">
    <!-- Global site tag (gtag.js) - Google Analytics -->


    <title>陈豪的博客</title>
    <link rel="icon" type="image/png" href="/favicon.png">

    <link rel="stylesheet" type="text/css" href="/libs/awesome/css/all.min.css">
    <link rel="stylesheet" type="text/css" href="/libs/materialize/materialize.min.css">
    <link rel="stylesheet" type="text/css" href="/libs/aos/aos.css">
    <link rel="stylesheet" type="text/css" href="/libs/animate/animate.min.css">
    <link rel="stylesheet" type="text/css" href="/libs/lightGallery/css/lightgallery.min.css">
    <link rel="stylesheet" type="text/css" href="/css/matery.css">
    <link rel="stylesheet" type="text/css" href="/css/my.css">

    <script src="/libs/jquery/jquery-3.6.0.min.js"></script>

<meta name="generator" content="Hexo 6.0.0">
<style>.github-emoji { position: relative; display: inline-block; width: 1.2em; min-height: 1.2em; overflow: hidden; vertical-align: top; color: transparent; }  .github-emoji > span { position: relative; z-index: 10; }  .github-emoji img, .github-emoji .fancybox { margin: 0 !important; padding: 0 !important; border: none !important; outline: none !important; text-decoration: none !important; user-select: none !important; cursor: auto !important; }  .github-emoji img { height: 1.2em !important; width: 1.2em !important; position: absolute !important; left: 50% !important; top: 50% !important; transform: translate(-50%, -50%) !important; user-select: none !important; cursor: auto !important; } .github-emoji-fallback { color: inherit; } .github-emoji-fallback img { opacity: 0 !important; }</style>
</head>




<body>
    <header class="navbar-fixed">
    <nav id="headNav" class="bg-color nav-transparent">
        <div id="navContainer" class="nav-wrapper container">
            <div class="brand-logo">
                <a href="/" class="waves-effect waves-light">
                    
                    <img src="/medias/logo.png" class="logo-img" alt="LOGO">
                    
                    <span class="logo-span">陈豪的博客</span>
                </a>
            </div>
            

<a href="#" data-target="mobile-nav" class="sidenav-trigger button-collapse"><i class="fas fa-bars"></i></a>
<ul class="right nav-menu">
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/" class="waves-effect waves-light">
      
      <i class="fas fa-home" style="zoom: 0.6;"></i>
      
      <span>首页</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/tags" class="waves-effect waves-light">
      
      <i class="fas fa-tags" style="zoom: 0.6;"></i>
      
      <span>标签</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/archives" class="waves-effect waves-light">
      
      <i class="fas fa-archive" style="zoom: 0.6;"></i>
      
      <span>归档</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/about" class="waves-effect waves-light">
      
      <i class="fas fa-user-circle" style="zoom: 0.6;"></i>
      
      <span>关于</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/contact" class="waves-effect waves-light">
      
      <i class="fas fa-comments" style="zoom: 0.6;"></i>
      
      <span>留言板</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/galleries" class="waves-effect waves-light">
      
      <i class="fas fa-image" style="zoom: 0.6;"></i>
      
      <span>相册</span>
    </a>
    
  </li>
  
  <li>
    <a href="#searchModal" class="modal-trigger waves-effect waves-light">
      <i id="searchIcon" class="fas fa-search" title="搜索" style="zoom: 0.85;"></i>
    </a>
  </li>
</ul>


<div id="mobile-nav" class="side-nav sidenav">

    <div class="mobile-head bg-color">
        
        <img src="/medias/logo.png" class="logo-img circle responsive-img">
        
        <div class="logo-name">陈豪的博客</div>
        <div class="logo-desc">
            
            本网站是个人兴趣爱好，总结分享经验，记录生活点滴的平台，希望在以后的学习旅途中，走出自己的风景
            
        </div>
    </div>

    <ul class="menu-list mobile-menu-list">
        
        <li class="m-nav-item">
	  
		<a href="/" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-home"></i>
			
			首页
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/tags" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-tags"></i>
			
			标签
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/archives" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-archive"></i>
			
			归档
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/about" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-user-circle"></i>
			
			关于
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/contact" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-comments"></i>
			
			留言板
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/galleries" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-image"></i>
			
			相册
		</a>
          
        </li>
        
        
    </ul>
</div>


        </div>

        
    </nav>

</header>

    



<div class="bg-cover pd-header post-cover" style="background-image: url('/medias/featureimages/0.jpg')">
    <div class="container" style="right: 0px;left: 0px;">
        <div class="row">
            <div class="col s12 m12 l12">
                <div class="brand">
                    <h1 class="description center-align post-title"></h1>
                </div>
            </div>
        </div>
    </div>
</div>




<main class="post-container content">

    
    <link rel="stylesheet" href="/libs/tocbot/tocbot.css">
<style>
    #articleContent h1::before,
    #articleContent h2::before,
    #articleContent h3::before,
    #articleContent h4::before,
    #articleContent h5::before,
    #articleContent h6::before {
        display: block;
        content: " ";
        height: 100px;
        margin-top: -100px;
        visibility: hidden;
    }

    #articleContent :focus {
        outline: none;
    }

    .toc-fixed {
        position: fixed;
        top: 64px;
    }

    .toc-widget {
        width: 345px;
        padding-left: 20px;
    }

    .toc-widget .toc-title {
        padding: 35px 0 15px 17px;
        font-size: 1.5rem;
        font-weight: bold;
        line-height: 1.5rem;
    }

    .toc-widget ol {
        padding: 0;
        list-style: none;
    }

    #toc-content {
        padding-bottom: 30px;
        overflow: auto;
    }

    #toc-content ol {
        padding-left: 10px;
    }

    #toc-content ol li {
        padding-left: 10px;
    }

    #toc-content .toc-link:hover {
        color: #42b983;
        font-weight: 700;
        text-decoration: underline;
    }

    #toc-content .toc-link::before {
        background-color: transparent;
        max-height: 25px;

        position: absolute;
        right: 23.5vw;
        display: block;
    }

    #toc-content .is-active-link {
        color: #42b983;
    }

    #floating-toc-btn {
        position: fixed;
        right: 15px;
        bottom: 76px;
        padding-top: 15px;
        margin-bottom: 0;
        z-index: 998;
    }

    #floating-toc-btn .btn-floating {
        width: 48px;
        height: 48px;
    }

    #floating-toc-btn .btn-floating i {
        line-height: 48px;
        font-size: 1.4rem;
    }
</style>
<div class="row">
    <div id="main-content" class="col s12 m12 l9">
        <!-- 文章内容详情 -->
<div id="artDetail">
    <div class="card">
        <div class="card-content article-info">
            <div class="row tag-cate">
                <div class="col s7">
                    
                          <div class="article-tag">
                            <span class="chip bg-color">无标签</span>
                          </div>
                    
                </div>
                <div class="col s5 right-align">
                    
                </div>
            </div>

            <div class="post-info">
                
                <div class="post-date info-break-policy">
                    <i class="far fa-calendar-minus fa-fw"></i>发布日期:&nbsp;&nbsp;
                    2022-01-19
                </div>
                

                

                

                

                
            </div>
        </div>
        <hr class="clearfix">

        

        

        <div class="card-content article-card-content">
            <div id="articleContent">
                <h1 id="博客系统笔记"><a href="#博客系统笔记" class="headerlink" title="博客系统笔记"></a>博客系统笔记</h1><h1 id="一、项目讲解说明"><a href="#一、项目讲解说明" class="headerlink" title="一、项目讲解说明"></a>一、项目讲解说明</h1><ul>
<li>提供前端工程，只需要实现后端接口即可</li>
<li>项目以单体架构入手，先快速开发，不考虑项目优化，降低开发负担</li>
<li>开发完成后，开始优化项目，提升编程思维能力</li>
<li>比如页面静态化，缓存，云存储，日志等</li>
<li>docker部署上线</li>
<li>云服务器购买，域名购买，域名备案等</li>
<li>项目使用技术 ：SpringBoot + MybatisPlus+Redis+Mysql</li>
</ul>
<h1 id="二、工程搭建"><a href="#二、工程搭建" class="headerlink" title="二、工程搭建"></a>二、工程搭建</h1><h2 id="2-1-前端工程搭建"><a href="#2-1-前端工程搭建" class="headerlink" title="2.1 前端工程搭建"></a>2.1 前端工程搭建</h2><p>将下载好的前端源码导入Hbuilder X中，然后执行以下操作：</p>
<figure class="highlight shell"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">npm install</span><br><span class="line">npm run build</span><br><span class="line">npm run dev</span><br></pre></td></tr></tbody></table></figure>

<p>①在package.json所在目录下运行cmd，然后输入npm install下载所需依赖</p>
<p>②在Hbuilder X客户端点击npm run build进行环境搭建</p>
<p>③在Hbuilder X客户端点击npm run dev运行前端</p>
<h2 id="2-2-后端工程搭建"><a href="#2-2-后端工程搭建" class="headerlink" title="2.2 后端工程搭建"></a>2.2 后端工程搭建</h2><p>①通过Spring Initializr新建一个SpringBoot工程，勾选以下依赖：</p>
<p><img src="C:\Users\95671\AppData\Roaming\Typora\typora-user-images\image-20220119212055325.png" alt="image-20220119212055325"></p>
<p>②添加另外一些可以简化开发的依赖</p>
<figure class="highlight xml"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--专门处理日期时间的库--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>joda-time<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>joda-time<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.9.8<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></tbody></table></figure>

<p>③配置文件</p>
<figure class="highlight yml"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#设置端口号为8888，避免于前端端口号8080冲突</span></span><br><span class="line"><span class="attr">server:</span></span><br><span class="line">  <span class="attr">port:</span> <span class="number">8888</span></span><br><span class="line"></span><br><span class="line"><span class="attr">spring:</span></span><br><span class="line">  <span class="attr">application:</span></span><br><span class="line">    <span class="attr">name:</span> <span class="string">blog</span>  <span class="comment">#起到了唯一标识的作用</span></span><br><span class="line">    </span><br><span class="line">  <span class="attr">datasource:</span>   <span class="comment">#连接数据库</span></span><br><span class="line">    <span class="attr">driver-class-name:</span> <span class="string">com.mysql.cj.jdbc.Driver</span></span><br><span class="line">    <span class="attr">url:</span> <span class="string">jdbc:mysql://localhost:3306/blog?useSSL=true&amp;useUnicode=true&amp;characterEncoding=UTF-8&amp;serverTimezone=UTC</span></span><br><span class="line">    <span class="attr">username:</span> <span class="string">root</span></span><br><span class="line">    <span class="attr">password:</span> <span class="number">123456</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#声明数据库表表名前缀，以及声明数控表采用id自增策略</span></span><br><span class="line"><span class="attr">mybatis-plus:</span></span><br><span class="line">  <span class="attr">global-config:</span></span><br><span class="line">    <span class="attr">db-config:</span></span><br><span class="line">      <span class="attr">table-prefix:</span> <span class="string">ms_</span></span><br><span class="line">      <span class="attr">id-type:</span> <span class="string">auto</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#打印输出mybaits日志</span></span><br><span class="line">  <span class="attr">configuration:</span></span><br><span class="line">    <span class="attr">log-impl:</span> <span class="string">org.apache.ibatis.logging.stdout.StdOutImpl</span></span><br></pre></td></tr></tbody></table></figure>

<p>④配置类</p>
<figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//配置一个拦截器，使mybatis的分页功能起作用</span></span><br><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MPConfig</span> </span>{</span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> MybatisPlusInterceptor <span class="title">mybatisPlusInterceptor</span><span class="params">()</span></span>{</span><br><span class="line">        MybatisPlusInterceptor interceptor=<span class="keyword">new</span> MybatisPlusInterceptor();</span><br><span class="line">        interceptor.addInnerInterceptor(<span class="keyword">new</span> PaginationInnerInterceptor());</span><br><span class="line">        <span class="keyword">return</span> interceptor;</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

<figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//进行跨域配置，因为前端的访问端口是8080，后端的端口是8888</span></span><br><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">WebConfig</span> <span class="keyword">implements</span> <span class="title">WebMvcConfigurer</span> </span>{</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">addCorsMappings</span><span class="params">(CorsRegistry registry)</span> </span>{</span><br><span class="line">        <span class="comment">//允许http://localhost:8080地址对后端访问</span></span><br><span class="line">        registry.addMapping(<span class="string">"/**"</span>).allowedOrigins(<span class="string">"http://localhost:8080"</span>);</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

<h1 id="三、项目实现"><a href="#三、项目实现" class="headerlink" title="三、项目实现"></a>三、项目实现</h1><h2 id="3-1-创建数据库表"><a href="#3-1-创建数据库表" class="headerlink" title="3.1 创建数据库表"></a>3.1 创建数据库表</h2><figure class="highlight sql"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"> Navicat Premium Data Transfer</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"> Source Server         : test</span></span><br><span class="line"><span class="comment"> Source Server Type    : MySQL</span></span><br><span class="line"><span class="comment"> Source Server Version : 80020</span></span><br><span class="line"><span class="comment"> Source Host           : localhost:3306</span></span><br><span class="line"><span class="comment"> Source Schema         : blog</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"> Target Server Type    : MySQL</span></span><br><span class="line"><span class="comment"> Target Server Version : 80020</span></span><br><span class="line"><span class="comment"> File Encoding         : 65001</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"> Date: 21/06/2021 22:42:03</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">SET</span> NAMES utf8mb4;</span><br><span class="line"><span class="keyword">SET</span> FOREIGN_KEY_CHECKS <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- ----------------------------</span></span><br><span class="line"><span class="comment">-- Table structure for ms_admin</span></span><br><span class="line"><span class="comment">-- ----------------------------</span></span><br><span class="line"><span class="keyword">DROP</span> <span class="keyword">TABLE</span> IF <span class="keyword">EXISTS</span> `ms_admin`;</span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> `ms_admin`  (</span><br><span class="line">  `id` <span class="type">bigint</span>(<span class="number">0</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span> AUTO_INCREMENT,</span><br><span class="line">  `username` <span class="type">varchar</span>(<span class="number">255</span>) <span class="type">CHARACTER</span> <span class="keyword">SET</span> utf8mb4 <span class="keyword">COLLATE</span> utf8mb4_unicode_ci <span class="keyword">NOT</span> <span class="keyword">NULL</span>,</span><br><span class="line">  `password` <span class="type">varchar</span>(<span class="number">255</span>) <span class="type">CHARACTER</span> <span class="keyword">SET</span> utf8mb4 <span class="keyword">COLLATE</span> utf8mb4_unicode_ci <span class="keyword">NOT</span> <span class="keyword">NULL</span>,</span><br><span class="line">  <span class="keyword">PRIMARY</span> KEY (`id`) <span class="keyword">USING</span> BTREE</span><br><span class="line">) ENGINE <span class="operator">=</span> InnoDB <span class="type">CHARACTER</span> <span class="keyword">SET</span> <span class="operator">=</span> utf8mb4 <span class="keyword">COLLATE</span> <span class="operator">=</span> utf8mb4_unicode_ci ROW_FORMAT <span class="operator">=</span> <span class="keyword">Dynamic</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- ----------------------------</span></span><br><span class="line"><span class="comment">-- Records of ms_admin</span></span><br><span class="line"><span class="comment">-- ----------------------------</span></span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `ms_admin` <span class="keyword">VALUES</span> (<span class="number">1</span>, <span class="string">'admin'</span>, <span class="string">'$2a$10$RZECQ90DjOT/t1mhnXsl5.XSuZWc0Sa1XduPxj2rb4yaSYcje3nWW'</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `ms_admin` <span class="keyword">VALUES</span> (<span class="number">2</span>, <span class="string">'mszlu'</span>, <span class="string">'$2a$10$RZECQ90DjOT/t1mhnXsl5.XSuZWc0Sa1XduPxj2rb4yaSYcje3nWW'</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">-- ----------------------------</span></span><br><span class="line"><span class="comment">-- Table structure for ms_admin_permission</span></span><br><span class="line"><span class="comment">-- ----------------------------</span></span><br><span class="line"><span class="keyword">DROP</span> <span class="keyword">TABLE</span> IF <span class="keyword">EXISTS</span> `ms_admin_permission`;</span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> `ms_admin_permission`  (</span><br><span class="line">  `id` <span class="type">bigint</span>(<span class="number">0</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span> AUTO_INCREMENT,</span><br><span class="line">  `admin_id` <span class="type">bigint</span>(<span class="number">0</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span>,</span><br><span class="line">  `permission_id` <span class="type">bigint</span>(<span class="number">0</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span>,</span><br><span class="line">  <span class="keyword">PRIMARY</span> KEY (`id`) <span class="keyword">USING</span> BTREE</span><br><span class="line">) ENGINE <span class="operator">=</span> InnoDB <span class="type">CHARACTER</span> <span class="keyword">SET</span> <span class="operator">=</span> utf8mb4 <span class="keyword">COLLATE</span> <span class="operator">=</span> utf8mb4_unicode_ci ROW_FORMAT <span class="operator">=</span> <span class="keyword">Dynamic</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- ----------------------------</span></span><br><span class="line"><span class="comment">-- Records of ms_admin_permission</span></span><br><span class="line"><span class="comment">-- ----------------------------</span></span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `ms_admin_permission` <span class="keyword">VALUES</span> (<span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `ms_admin_permission` <span class="keyword">VALUES</span> (<span class="number">2</span>, <span class="number">2</span>, <span class="number">1</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">-- ----------------------------</span></span><br><span class="line"><span class="comment">-- Table structure for ms_article</span></span><br><span class="line"><span class="comment">-- ----------------------------</span></span><br><span class="line"><span class="keyword">DROP</span> <span class="keyword">TABLE</span> IF <span class="keyword">EXISTS</span> `ms_article`;</span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> `ms_article`  (</span><br><span class="line">  `id` <span class="type">bigint</span>(<span class="number">0</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span> AUTO_INCREMENT,</span><br><span class="line">  `comment_counts` <span class="type">int</span>(<span class="number">0</span>) <span class="keyword">NULL</span> <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">'评论数量'</span>,</span><br><span class="line">  `create_date` <span class="type">bigint</span>(<span class="number">0</span>) <span class="keyword">NULL</span> <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">'创建时间'</span>,</span><br><span class="line">  `summary` <span class="type">varchar</span>(<span class="number">255</span>) <span class="type">CHARACTER</span> <span class="keyword">SET</span> utf8 <span class="keyword">COLLATE</span> utf8_general_ci <span class="keyword">NULL</span> <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">'简介'</span>,</span><br><span class="line">  `title` <span class="type">varchar</span>(<span class="number">64</span>) <span class="type">CHARACTER</span> <span class="keyword">SET</span> utf8 <span class="keyword">COLLATE</span> utf8_general_ci <span class="keyword">NULL</span> <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">'标题'</span>,</span><br><span class="line">  `view_counts` <span class="type">int</span>(<span class="number">0</span>) <span class="keyword">NULL</span> <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">'浏览数量'</span>,</span><br><span class="line">  `weight` <span class="type">int</span>(<span class="number">0</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span> COMMENT <span class="string">'是否置顶'</span>,</span><br><span class="line">  `author_id` <span class="type">bigint</span>(<span class="number">0</span>) <span class="keyword">NULL</span> <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">'作者id'</span>,</span><br><span class="line">  `body_id` <span class="type">bigint</span>(<span class="number">0</span>) <span class="keyword">NULL</span> <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">'内容id'</span>,</span><br><span class="line">  `category_id` <span class="type">int</span>(<span class="number">0</span>) <span class="keyword">NULL</span> <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">'类别id'</span>,</span><br><span class="line">  <span class="keyword">PRIMARY</span> KEY (`id`) <span class="keyword">USING</span> BTREE</span><br><span class="line">) ENGINE <span class="operator">=</span> InnoDB AUTO_INCREMENT <span class="operator">=</span> <span class="number">1405916999732707331</span> <span class="type">CHARACTER</span> <span class="keyword">SET</span> <span class="operator">=</span> utf8 <span class="keyword">COLLATE</span> <span class="operator">=</span> utf8_general_ci ROW_FORMAT <span class="operator">=</span> <span class="keyword">Dynamic</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- ----------------------------</span></span><br><span class="line"><span class="comment">-- Records of ms_article</span></span><br><span class="line"><span class="comment">-- ----------------------------</span></span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `ms_article` <span class="keyword">VALUES</span> (<span class="number">1</span>, <span class="number">1</span>, <span class="number">1621947720727</span>, <span class="string">'通过Spring Boot实现的服务，只需要依靠一个Java类，把它打包成jar，并通过`java -jar`命令就可以运行起来。\r\n\r\n这一切相较于传统Spring应用来说，已经变得非常的轻便、简单。'</span>, <span class="string">'springboot介绍以及入门案例'</span>, <span class="number">125</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `ms_article` <span class="keyword">VALUES</span> (<span class="number">9</span>, <span class="number">0</span>, <span class="number">1613947720727</span>, <span class="string">'Vue (读音 /vjuː/，类似于 view) 是一套用于构建用户界面的渐进式框架。'</span>, <span class="string">'Vue.js 到底是什么'</span>, <span class="number">3</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">20</span>, <span class="number">2</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `ms_article` <span class="keyword">VALUES</span> (<span class="number">10</span>, <span class="number">0</span>, <span class="number">1523947720727</span>, <span class="string">'本节将介绍如何在项目中使用 Element。'</span>, <span class="string">'Element相关'</span>, <span class="number">10</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">21</span>, <span class="number">2</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `ms_article` <span class="keyword">VALUES</span> (<span class="number">1405564731300831233</span>, <span class="number">0</span>, <span class="number">1623947720727</span>, <span class="string">'66666666666'</span>, <span class="string">'666666666666666'</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1405564731351162882</span>, <span class="number">2</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `ms_article` <span class="keyword">VALUES</span> (<span class="number">1405909844724051969</span>, <span class="number">0</span>, <span class="number">1624030002164</span>, <span class="string">'123'</span>, <span class="string">'123123'</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1405909844828909569</span>, <span class="number">3</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `ms_article` <span class="keyword">VALUES</span> (<span class="number">1405916999732707330</span>, <span class="number">0</span>, <span class="number">1624031708047</span>, <span class="string">'springboot入门案例'</span>, <span class="string">'SpringBoot入门案例'</span>, <span class="number">5</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1405916999854342146</span>, <span class="number">2</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">-- ----------------------------</span></span><br><span class="line"><span class="comment">-- Table structure for ms_article_body</span></span><br><span class="line"><span class="comment">-- ----------------------------</span></span><br><span class="line"><span class="keyword">DROP</span> <span class="keyword">TABLE</span> IF <span class="keyword">EXISTS</span> `ms_article_body`;</span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> `ms_article_body`  (</span><br><span class="line">  `id` <span class="type">bigint</span>(<span class="number">0</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span> AUTO_INCREMENT,</span><br><span class="line">  `content` longtext <span class="type">CHARACTER</span> <span class="keyword">SET</span> utf8 <span class="keyword">COLLATE</span> utf8_general_ci <span class="keyword">NULL</span>,</span><br><span class="line">  `content_html` longtext <span class="type">CHARACTER</span> <span class="keyword">SET</span> utf8 <span class="keyword">COLLATE</span> utf8_general_ci <span class="keyword">NULL</span>,</span><br><span class="line">  `article_id` <span class="type">bigint</span>(<span class="number">0</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span>,</span><br><span class="line">  <span class="keyword">PRIMARY</span> KEY (`id`) <span class="keyword">USING</span> BTREE,</span><br><span class="line">  INDEX `article_id`(`article_id`) <span class="keyword">USING</span> BTREE</span><br><span class="line">) ENGINE <span class="operator">=</span> InnoDB AUTO_INCREMENT <span class="operator">=</span> <span class="number">1405916999854342147</span> <span class="type">CHARACTER</span> <span class="keyword">SET</span> <span class="operator">=</span> utf8 <span class="keyword">COLLATE</span> <span class="operator">=</span> utf8_general_ci ROW_FORMAT <span class="operator">=</span> <span class="keyword">Dynamic</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- ----------------------------</span></span><br><span class="line"><span class="comment">-- Records of ms_article_body</span></span><br><span class="line"><span class="comment">-- ----------------------------</span></span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `ms_article_body` <span class="keyword">VALUES</span> (<span class="number">1</span>, <span class="string">'# 1. Spring Boot介绍\r\n\r\n## 1.1 简介\r\n\r\n在您第1次接触和学习Spring框架的时候，是否因为其繁杂的配置而退却了？\r\n\r\n在你第n次使用Spring框架的时候，是否觉得一堆反复黏贴的配置有一些厌烦？\r\n\r\n那么您就不妨来试试使用Spring Boot来让你更易上手，更简单快捷地构建Spring应用！\r\n\r\nSpring Boot让我们的Spring应用变的更轻量化。\r\n\r\n我们不必像以前那样繁琐的构建项目、打包应用、部署到Tomcat等应用服务器中来运行我们的业务服务。\r\n\r\n通过Spring Boot实现的服务，只需要依靠一个Java类，把它打包成jar，并通过`java -jar`命令就可以运行起来。\r\n\r\n这一切相较于传统Spring应用来说，已经变得非常的轻便、简单。\r\n\r\n**总结一下Spring Boot的主要优点：**\r\n\r\n1. 为所有Spring开发者更快的入门\r\n2. 开箱即用，提供各种默认配置来简化项目配置\r\n3. 内嵌式容器简化Web项目\r\n4. 没有冗余代码生成和XML配置的要求\r\n5. 统一的依赖管理\r\n6. 自动装配，更易使用，更易扩展\r\n\r\n## 1.2 使用版本说明\r\n\r\nSpringboot版本：使用最新的2.5.0版本\r\n\r\n教程参考了官方文档进行制作，权威。\r\n\r\n其他依赖版本：\r\n\r\n	1. Maven  需求：3.5+\r\n\r\n   	2. JDK 需求  8+\r\n   	3. Spring Framework 5.3.7以上版本\r\n   	4. Tomcat 9.0\r\n   	5. Servlet版本 4.0  但是可以部署到Servlet到3.1+的容器中\r\n\r\n# 2. 快速入门\r\n\r\n快速的创建一个Spring Boot应用，并且实现一个简单的Http请求处理。通过这个例子对Spring Boot有一个初步的了解，并体验其结构简单、开发快速的特性。\r\n\r\n教程使用的Idea版本：2019.3\r\n\r\n## 2.1 创建基础项目\r\n\r\n**第一步：** 创建maven项目\r\n\r\npom.xml :\r\n\r\n~~~xml\r\n&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;\r\n&lt;project xmlns=\"http://maven.apache.org/POM/4.0.0\"\r\n         xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\"\r\n         xsi:schemaLocation=\"http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd\"&gt;\r\n    &lt;modelVersion&gt;4.0.0&lt;/modelVersion&gt;\r\n\r\n    &lt;groupId&gt;com.xiaopizhu&lt;/groupId&gt;\r\n    &lt;artifactId&gt;helloSpringBoot&lt;/artifactId&gt;\r\n    &lt;version&gt;1.0-SNAPSHOT&lt;/version&gt;\r\n	&lt;!--springboot的父工程其中定义了常用的依赖，并且无依赖冲突--&gt;\r\n    &lt;parent&gt;\r\n        &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\r\n        &lt;artifactId&gt;spring-boot-starter-parent&lt;/artifactId&gt;\r\n        &lt;version&gt;2.5.0&lt;/version&gt;\r\n    &lt;/parent&gt;\r\n&lt;/project&gt;\r\n~~~\r\n\r\n注意上方的parent必须加，其中定义了springboot官方支持的n多依赖，基本上常用的已经有了，所以接下来导入依赖的时候，绝大部分都可以不加版本号。\r\n\r\n此时的工程结构为：\r\n\r\n![image-20210523173241557](img/image-20210523173241557.png)\r\n\r\n**第二步：** 添加web依赖\r\n\r\n~~~xml\r\n&lt;dependencies&gt;\r\n    &lt;dependency&gt;\r\n        &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\r\n        &lt;artifactId&gt;spring-boot-starter-web&lt;/artifactId&gt;\r\n    &lt;/dependency&gt;\r\n&lt;/dependencies&gt;\r\n~~~\r\n\r\n添加上方的web依赖，其中间接依赖了spring-web，spring-webmvc，spring-core等spring和springmvc的包，并且集成了tomcat。\r\n\r\n**第三步：** 编写启动类\r\n\r\n~~~java\r\npackage com.xiaopizhu.springboot;\r\n\r\nimport org.springframework.boot.SpringApplication;\r\nimport org.springframework.boot.autoconfigure.SpringBootApplication;\r\n\r\n@SpringBootApplication\r\npublic class HelloApp {\r\n\r\n    public static void main(String[] args) {\r\n        SpringApplication.run(HelloApp.class,args);\r\n    }\r\n}\r\n\r\n~~~\r\n\r\n@SpringBootApplication注解标识了HelloApp为启动类，也是Spring Boot的核心。\r\n\r\n**第四步：** 运行启动类的main方法\r\n\r\n![image-20210523173712142](img/image-20210523173712142.png)\r\n\r\n看到如上配置，证明启动成功，tomcat端口号默认为8080。\r\n\r\n**第五步：**  如果想要修改端口号，可以在resources目录下新建application.properties\r\n\r\n~~~properties\r\nserver.port=8082\r\n~~~\r\n\r\n**第六步：** 重新运行\r\n\r\n![image-20210523174011613](img/image-20210523174011613.png)\r\n\r\n此时的项目结构为：\r\n\r\n![image-20210523174032053](img/image-20210523174032053.png)\r\n\r\n**src/main/java :**  编写java代码，注意启动类需要放在项目的根包下。\r\n\r\n**src/main/resources:**  放置资源的目录，比如springboot的配置文件，静态文件，mybatis配置，日志配置等。\r\n\r\n**src/test/java:**  测试代码\r\n\r\n## 2.2 编写一个Http接口\r\n\r\n**第一步：**创建`HelloController`类，内容如下：\r\n\r\n~~~java\r\npackage com.xiaopizhu.springboot.controller;\r\n\r\nimport org.springframework.web.bind.annotation.GetMapping;\r\nimport org.springframework.web.bind.annotation.RequestMapping;\r\nimport org.springframework.web.bind.annotation.RestController;\r\n\r\n@RestController\r\n@RequestMapping(\"hello\")\r\npublic class HelloController {\r\n\r\n    @GetMapping(\"boot\")\r\n    public String hello(){\r\n        return \"hello spring boot\";\r\n    }\r\n\r\n}\r\n\r\n~~~\r\n\r\n**注意包名，必须在启动类所在的包名下。**\r\n\r\n**第二步：**重启程序，使用postman或者直接在浏览器输入http://localhost:8082/hello/boot\r\n\r\n得到结果：hello spring boot\r\n\r\n## 2.3 编写单元测试用例\r\n\r\n**第一步：**添加spring boot测试依赖\r\n\r\n~~~xml\r\n		&lt;dependency&gt;\r\n            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\r\n            &lt;artifactId&gt;spring-boot-starter-test&lt;/artifactId&gt;\r\n            &lt;scope&gt;test&lt;/scope&gt;\r\n        &lt;/dependency&gt;\r\n~~~\r\n\r\n**第二步：**在src/test 下，编写测试用例\r\n\r\n~~~java\r\npackage com.xiaopizhu.springboot.controller;\r\n\r\nimport org.junit.jupiter.api.BeforeAll;\r\nimport org.junit.jupiter.api.BeforeEach;\r\nimport org.junit.jupiter.api.Test;\r\nimport org.springframework.boot.test.context.SpringBootTest;\r\nimport org.springframework.http.MediaType;\r\nimport org.springframework.test.web.servlet.MockMvc;\r\nimport org.springframework.test.web.servlet.request.MockMvcRequestBuilders;\r\nimport org.springframework.test.web.servlet.setup.MockMvcBuilders;\r\n\r\nimport static org.hamcrest.Matchers.equalTo;\r\nimport static org.springframework.test.web.servlet.result.MockMvcResultMatchers.content;\r\nimport static org.springframework.test.web.servlet.result.MockMvcResultMatchers.status;\r\n\r\n@SpringBootTest\r\npublic class TestHelloController {\r\n\r\n    private MockMvc mockMvc;\r\n\r\n    @BeforeEach\r\n    public void beforeEach(){\r\n        mockMvc = MockMvcBuilders.standaloneSetup(new HelloController()).build();\r\n    }\r\n    @Test\r\n    public void testHello() throws Exception {\r\n        mockMvc.perform(MockMvcRequestBuilders.get(\"/hello/boot\")\r\n                .accept(MediaType.APPLICATION_JSON))\r\n                .andExpect(status().isOk())\r\n                .andExpect(content().string(equalTo(\"hello spring boot\")));\r\n    }\r\n}\r\n\r\n~~~\r\n\r\n上面的测试用例，是构建一个空的`WebApplicationContext`，并且在before中加载了HelloController，得以在测试用例中mock调用，模拟请求。\r\n\r\n## 2.4 打包为jar运行\r\n\r\n**第一步：**添加打包(maven构建springboot)插件\r\n\r\n~~~xml\r\n  &lt;build&gt;\r\n        &lt;plugins&gt;\r\n            &lt;plugin&gt;\r\n                &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\r\n                &lt;artifactId&gt;spring-boot-maven-plugin&lt;/artifactId&gt;\r\n            &lt;/plugin&gt;\r\n        &lt;/plugins&gt;\r\n    &lt;/build&gt;\r\n~~~\r\n\r\n在idea的右侧 maven中，使用package来打包程序，打包完成后，在target目录下生成helloSpringBoot-1.0-SNAPSHOT.jar\r\n\r\n![image-20210523181737720](img/image-20210523181737720.png)\r\n\r\n**第二步：**打开cmd：找到jar对应的目录\r\n\r\n输入命令\r\n\r\n~~~shell\r\njava -jar helloSpringBoot-1.0-SNAPSHOT.jar\r\n~~~\r\n\r\n![image-20210523182426404](img/image-20210523182426404.png)\r\n\r\n**第三步：**测试，使用postman或者直接在浏览器输入http://localhost:8082/hello/boot\r\n\r\n得到结果：hello spring boot\r\n\r\n## 2.5 查看jar包内容\r\n\r\n~~~shell\r\njar tvf helloSpringBoot-1.0-SNAPSHOT.jar\r\n~~~\r\n\r\n# 3. 小结\r\n\r\n1. 通过Maven构建了一个空白Spring Boot项目，再通过引入web模块实现了一个简单的请求处理。\r\n2. 通过修改配置文件，更改端口号\r\n3. 编写了测试用例\r\n4. 打包jar包运行\r\n\r\n'</span>, <span class="string">'&lt;h2&gt;2018-01-04&lt;/h2&gt;\n&lt;pre&gt;&lt;code class=\"lang-\"&gt;# 使用vue的Webpack模板生成脚手架\n&lt;/code&gt;&lt;/pre&gt;\n&lt;h2&gt;2018-01-05&lt;/h2&gt;\n&lt;pre&gt;&lt;code class=\"lang-\"&gt;# 引入ElementUI\n\n# babel-plugin-component自定义主题\n# 首页\n# 登陆页\n# 注册页面\n# 日志页\n&lt;/code&gt;&lt;/pre&gt;\n&lt;h2&gt;2018-01-07&lt;/h2&gt;\n&lt;pre&gt;&lt;code class=\"lang-\"&gt;# 调整底部栏始终固定在底部\n# 日志页 添加时间轴\n# 首页的文章列表\n&lt;/code&gt;&lt;/pre&gt;\n&lt;h2&gt;2018-01-08&lt;/h2&gt;\n&lt;pre&gt;&lt;code class=\"lang-\"&gt;# 使用组件-博客作者tab页 \n# 添加第三方图标\n&lt;/code&gt;&lt;/pre&gt;\n&lt;h2&gt;2018-01-09&lt;/h2&gt;\n&lt;pre&gt;&lt;code class=\"lang-\"&gt;# 调整顶部导航栏：激活文字颜色，click点击\n# 组件-最新文章tab页\n\n# 最新文章、最热文章使用相同组件\n# 底部栏设计\n# 页面与两边边距改为100\n&lt;/code&gt;&lt;/pre&gt;\n&lt;h2&gt;2018-01-10&lt;/h2&gt;\n&lt;pre&gt;&lt;code class=\"lang-\"&gt;# 写博客 引入mavonEditor编辑器\n# 顶部导航栏都放入一个Menu中\n# 写文章页面\n#　mavonEditor局部引入\n\n#　页面的中间区域固定宽度，自动居中\n# 发布和取消\n# 发布dialog\n\n&lt;/code&gt;&lt;/pre&gt;\n&lt;h2&gt;2018-01-11&lt;/h2&gt;\n&lt;pre&gt;&lt;code class=\"lang-\"&gt;# 文章组件用守卫来改变body背景色\n# 调整登陆和注册页面，使其居中\n\n#子页面调整根元素为div\n#文章详情页\n\n&lt;/code&gt;&lt;/pre&gt;\n&lt;h2&gt;2018-01-12&lt;/h2&gt;\n&lt;pre&gt;&lt;code class=\"lang-\"&gt;# 文章详情页  内容  评论等\n\n&lt;/code&gt;&lt;/pre&gt;\n&lt;h2&gt;2018-01-13&lt;/h2&gt;\n&lt;pre&gt;&lt;code class=\"lang-\"&gt;## 重新调整页面结构	\n#顶部和底部 抽成  BaseHeader BaseFooter 组件\n#BlogView为单独页，以前是Home的子路由\n\n&lt;/code&gt;&lt;/pre&gt;\n&lt;h2&gt;2018-01-15&lt;/h2&gt;\n&lt;pre&gt;&lt;code class=\"lang-\"&gt;# 文章分类去掉子级\n# 将首页的文章列表抽成 ArticleItem组件\n# 增加文章的评论展示\n# 增加文章分类、标签页\n\n&lt;/code&gt;&lt;/pre&gt;\n&lt;h2&gt;2018-01-15  2&lt;/h2&gt;\n&lt;pre&gt;&lt;code class=\"lang-\"&gt;# 回到顶部去掉过渡动画（影响顶部导航栏）\n# 顶部导航栏 增加登录后菜单\n# 首页增加 最热标签\n# 增加 文章分类 标签的详情页\n# 将文章详情页、 文章分类标签页 改为Home的子路由（以前单独页）\n# Home组件增加路由判断：更正导航栏的状态、条件显示底部栏\n\n&lt;/code&gt;&lt;/pre&gt;\n&lt;h2&gt;2018-01-16&lt;/h2&gt;\n&lt;pre&gt;&lt;code class=\"lang-\"&gt;# 将写文章的顶部Header合并到BaseHeader中\n# 图片都放到了static目录下\n\n&lt;/code&gt;&lt;/pre&gt;\n&lt;h2&gt;2018-01-24&lt;/h2&gt;\n&lt;pre&gt;&lt;code class=\"lang-\"&gt;# 将自定义的theme放到assets下\n# 加入axios\n# 加入vuex\n# 实现登录\n# 实现退出\n\n&lt;/code&gt;&lt;/pre&gt;\n&lt;h2&gt;2018-01-25&lt;/h2&gt;\n&lt;pre&gt;&lt;code class=\"lang-\"&gt;# 实现注册逻辑\n# 写文章功能实现\n# 写文章时支持插入图片\n\n&lt;/code&gt;&lt;/pre&gt;\n&lt;h2&gt;2018-01-26&lt;/h2&gt;\n&lt;pre&gt;&lt;code class=\"lang-\"&gt;# 引入lodash工具类\n# 优化写文章的工具栏：滚动时固定顶部\n# 写文章 后台获取文章分类和标签\n\n# 首页的文章列表\n\n&lt;/code&gt;&lt;/pre&gt;\n&lt;h2&gt;2018-01-27&lt;/h2&gt;\n&lt;pre&gt;&lt;code class=\"lang-\"&gt;# 修改首页文章列表的样式\n# 首页加载文章功能\n# 文章查看功能\n# 文章分类和标签功能列表\n\n&lt;/code&gt;&lt;/pre&gt;\n&lt;h2&gt;2018-01-28&lt;/h2&gt;\n&lt;pre&gt;&lt;code class=\"lang-\"&gt;# 文章分类和标签详情\n\n&lt;/code&gt;&lt;/pre&gt;\n&lt;h2&gt;2018-01-29&lt;/h2&gt;\n&lt;pre&gt;&lt;code class=\"lang-\"&gt;# 文章分类和标签的文章数\n# 首页最热文章\n# 首页最新文章\n# 首页最热标签\n\n&lt;/code&gt;&lt;/pre&gt;\n&lt;h2&gt;2018-01-30&lt;/h2&gt;\n&lt;pre&gt;&lt;code class=\"lang-\"&gt;# BaseHeader放回views中\n# 修改Axios后置拦截，全局处理错误\n# 将登录 退出 和头像 放到一起\n\n&lt;/code&gt;&lt;/pre&gt;\n'</span>, <span class="number">1</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `ms_article_body` <span class="keyword">VALUES</span> (<span class="number">20</span>, <span class="string">'Vue (读音 /vjuː/，类似于 view) 是一套用于构建用户界面的渐进式框架。与其它大型框架不同的是，Vue 被设计为可以自底向上逐层应用。Vue 的核心库只关注视图层，不仅易于上手，还便于与第三方库或既有项目整合。另一方面，当与现代化的工具链以及各种支持类库结合使用时，Vue 也完全能够为复杂的单页应用提供驱动。\n\n如果你想在深入学习 Vue 之前对它有更多了解，我们制作了一个视频，带您了解其核心概念和一个示例工程。\n如果你已经是有经验的前端开发者，想知道 Vue 与其它库/框架有哪些区别，请查看对比其它框架。\n\n# 起步\n\n&gt; 官方指南假设你已了解关于 HTML、CSS 和 JavaScript 的中级知识。如果你刚开始学习前端开发，将框架作为你的第一步可能不是最好的主意——掌握好基础知识再来吧！之前有其它框架的使用经验会有帮助，但这不是必需的。\n\n尝试 Vue.js 最简单的方法是使用 JSFiddle 上的 Hello World 例子。你可以在浏览器新标签页中打开它，跟着例子学习一些基础用法。或者你也可以创建一个 .html 文件，然后通过如下方式引入 Vue：\n\n```javascript\n&lt;script src=\"https://cdn.jsdelivr.net/npm/vue\"&gt;&lt;/script&gt;\n\n```\n安装教程给出了更多安装 Vue 的方式。请注意我们不推荐新手直接使用 vue-cli，尤其是在你还不熟悉基于 Node.js 的构建工具时。\n\n# 声明式渲染\nVue.js 的核心是一个允许采用简洁的模板语法来声明式地将数据渲染进 DOM 的系统：\n```javascript\n&lt;div id=\"app\"&gt;\n  {{ message }}\n&lt;/div&gt;\n\n```\n```javascript\nvar app = new Vue({\n  el: \'</span>#app\<span class="string">',\n  data: {\n    message: \'</span>Hello Vue<span class="operator">!</span>\<span class="string">'\n  }\n})\n\n```\n我们已经成功创建了第一个 Vue 应用！看起来这跟渲染一个字符串模板非常类似，但是 Vue 在背后做了大量工作。现在数据和 DOM 已经被建立了关联，所有东西都是响应式的。我们要怎么确认呢？打开你的浏览器的 JavaScript 控制台 (就在这个页面打开)，并修改 app.message 的值，你将看到上例相应地更新。\n\n除了文本插值，我们还可以像这样来绑定元素特性：\n\n\n\n\n\n\n'</span>, <span class="string">'&lt;p&gt;Vue (读音 /vjuː/，类似于 view) 是一套用于构建用户界面的渐进式框架。与其它大型框架不同的是，Vue 被设计为可以自底向上逐层应用。Vue 的核心库只关注视图层，不仅易于上手，还便于与第三方库或既有项目整合。另一方面，当与现代化的工具链以及各种支持类库结合使用时，Vue 也完全能够为复杂的单页应用提供驱动。&lt;/p&gt;\n&lt;p&gt;如果你想在深入学习 Vue 之前对它有更多了解，我们制作了一个视频，带您了解其核心概念和一个示例工程。&lt;br /&gt;\n如果你已经是有经验的前端开发者，想知道 Vue 与其它库/框架有哪些区别，请查看对比其它框架。&lt;/p&gt;\n&lt;h1&gt;起步&lt;/h1&gt;\n&lt;blockquote&gt;\n&lt;p&gt;官方指南假设你已了解关于 HTML、CSS 和 JavaScript 的中级知识。如果你刚开始学习前端开发，将框架作为你的第一步可能不是最好的主意——掌握好基础知识再来吧！之前有其它框架的使用经验会有帮助，但这不是必需的。&lt;/p&gt;\n&lt;/blockquote&gt;\n&lt;p&gt;尝试 Vue.js 最简单的方法是使用 JSFiddle 上的 Hello World 例子。你可以在浏览器新标签页中打开它，跟着例子学习一些基础用法。或者你也可以创建一个 .html 文件，然后通过如下方式引入 Vue：&lt;/p&gt;\n&lt;pre&gt;&lt;div class=\"hljs\"&gt;&lt;code class=\"lang-javascript\"&gt;&amp;lt;script src=&lt;span class=\"hljs-string\"&gt;\"https://cdn.jsdelivr.net/npm/vue\"&lt;/span&gt;&amp;gt;&lt;span class=\"xml\"&gt;&lt;span class=\"hljs-tag\"&gt;&amp;lt;/&lt;span class=\"hljs-name\"&gt;script&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;\n\n&lt;/code&gt;&lt;/div&gt;&lt;/pre&gt;\n&lt;p&gt;安装教程给出了更多安装 Vue 的方式。请注意我们不推荐新手直接使用 vue-cli，尤其是在你还不熟悉基于 Node.js 的构建工具时。&lt;/p&gt;\n&lt;h1&gt;声明式渲染&lt;/h1&gt;\n&lt;p&gt;Vue.js 的核心是一个允许采用简洁的模板语法来声明式地将数据渲染进 DOM 的系统：&lt;/p&gt;\n&lt;pre&gt;&lt;div class=\"hljs\"&gt;&lt;code class=\"lang-javascript\"&gt;&amp;lt;div id=&lt;span class=\"hljs-string\"&gt;\"app\"&lt;/span&gt;&amp;gt;\n  {{ message }}\n&amp;lt;&lt;span class=\"hljs-regexp\"&gt;/div&amp;gt;\n\n&lt;/span&gt;&lt;/code&gt;&lt;/div&gt;&lt;/pre&gt;\n&lt;pre&gt;&lt;div class=\"hljs\"&gt;&lt;code class=\"lang-javascript\"&gt;&lt;span class=\"hljs-keyword\"&gt;var&lt;/span&gt; app = &lt;span class=\"hljs-keyword\"&gt;new&lt;/span&gt; Vue({\n  &lt;span class=\"hljs-attr\"&gt;el&lt;/span&gt;: &lt;span class=\"hljs-string\"&gt;\'</span>#app\<span class="string">'&lt;/span&gt;,\n  &lt;span class=\"hljs-attr\"&gt;data&lt;/span&gt;: {\n    &lt;span class=\"hljs-attr\"&gt;message&lt;/span&gt;: &lt;span class=\"hljs-string\"&gt;\'</span>Hello Vue<span class="operator">!</span>\<span class="string">'&lt;/span&gt;\n  }\n})\n\n&lt;/code&gt;&lt;/div&gt;&lt;/pre&gt;\n&lt;p&gt;我们已经成功创建了第一个 Vue 应用！看起来这跟渲染一个字符串模板非常类似，但是 Vue 在背后做了大量工作。现在数据和 DOM 已经被建立了关联，所有东西都是响应式的。我们要怎么确认呢？打开你的浏览器的 JavaScript 控制台 (就在这个页面打开)，并修改 app.message 的值，你将看到上例相应地更新。&lt;/p&gt;\n&lt;p&gt;除了文本插值，我们还可以像这样来绑定元素特性：&lt;/p&gt;\n'</span>, <span class="number">9</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `ms_article_body` <span class="keyword">VALUES</span> (<span class="number">21</span>, <span class="string">'## 快速上手\n\n本节将介绍如何在项目中使用 Element。\n\n### 使用 Starter Kit\n我们提供了通用的项目模板，你可以直接使用。对于 Laravel 用户，我们也准备了相应的模板，同样可以直接下载使用。\n\n如果不希望使用我们提供的模板，请继续阅读。\n\n### 使用 vue-cli\n\n我们还可以使用 vue-cli 初始化项目，命令如下：\n\n```language\n&gt; npm i -g vue-cli\n&gt; mkdir my-project &amp;&amp; cd my-project\n&gt; vue init webpack\n&gt; npm i &amp;&amp; npm i element-ui\n```\n\n### 引入 Element\n你可以引入整个 Element，或是根据需要仅引入部分组件。我们先介绍如何引入完整的 Element。\n\n#### 完整引入\n在 main.js 中写入以下内容：\n```javascript\nimport Vue from \'</span>vue\<span class="string">'\nimport ElementUI from \'</span>element<span class="operator">-</span>ui\<span class="string">'\nimport \'</span>element<span class="operator">-</span>ui<span class="operator">/</span>lib<span class="operator">/</span>theme<span class="operator">-</span>chalk<span class="operator">/</span>index.css\<span class="string">'\nimport App from \'</span>.<span class="operator">/</span>App.vue\<span class="string">'\n\nVue.use(ElementUI)\n\nnew Vue({\n  el: \'</span>#app\<span class="string">',\n  render: h =&gt; h(App)\n})\n\n```\n以上代码便完成了 Element 的引入。需要注意的是，样式文件需要单独引入。\n\n#### 按需引入\n借助 babel-plugin-component，我们可以只引入需要的组件，以达到减小项目体积的目的。\n\n首先，安装 babel-plugin-component：\n\n'</span>, <span class="string">'&lt;h2&gt;快速上手&lt;/h2&gt;\n&lt;p&gt;本节将介绍如何在项目中使用 Element。&lt;/p&gt;\n&lt;h3&gt;使用 Starter Kit&lt;/h3&gt;\n&lt;p&gt;我们提供了通用的项目模板，你可以直接使用。对于 Laravel 用户，我们也准备了相应的模板，同样可以直接下载使用。&lt;/p&gt;\n&lt;p&gt;如果不希望使用我们提供的模板，请继续阅读。&lt;/p&gt;\n&lt;h3&gt;使用 vue-cli&lt;/h3&gt;\n&lt;p&gt;我们还可以使用 vue-cli 初始化项目，命令如下：&lt;/p&gt;\n&lt;pre&gt;&lt;code class=\"lang-language\"&gt;&amp;gt; npm i -g vue-cli\n&amp;gt; mkdir my-project &amp;amp;&amp;amp; cd my-project\n&amp;gt; vue init webpack\n&amp;gt; npm i &amp;amp;&amp;amp; npm i element-ui\n&lt;/code&gt;&lt;/pre&gt;\n&lt;h3&gt;引入 Element&lt;/h3&gt;\n&lt;p&gt;你可以引入整个 Element，或是根据需要仅引入部分组件。我们先介绍如何引入完整的 Element。&lt;/p&gt;\n&lt;h4&gt;完整引入&lt;/h4&gt;\n&lt;p&gt;在 main.js 中写入以下内容：&lt;/p&gt;\n&lt;pre&gt;&lt;div class=\"hljs\"&gt;&lt;code class=\"lang-javascript\"&gt;&lt;span class=\"hljs-keyword\"&gt;import&lt;/span&gt; Vue &lt;span class=\"hljs-keyword\"&gt;from&lt;/span&gt; &lt;span class=\"hljs-string\"&gt;\'</span>vue\<span class="string">'&lt;/span&gt;\n&lt;span class=\"hljs-keyword\"&gt;import&lt;/span&gt; ElementUI &lt;span class=\"hljs-keyword\"&gt;from&lt;/span&gt; &lt;span class=\"hljs-string\"&gt;\'</span>element<span class="operator">-</span>ui\<span class="string">'&lt;/span&gt;\n&lt;span class=\"hljs-keyword\"&gt;import&lt;/span&gt; &lt;span class=\"hljs-string\"&gt;\'</span>element<span class="operator">-</span>ui<span class="operator">/</span>lib<span class="operator">/</span>theme<span class="operator">-</span>chalk<span class="operator">/</span>index.css\<span class="string">'&lt;/span&gt;\n&lt;span class=\"hljs-keyword\"&gt;import&lt;/span&gt; App &lt;span class=\"hljs-keyword\"&gt;from&lt;/span&gt; &lt;span class=\"hljs-string\"&gt;\'</span>.<span class="operator">/</span>App.vue\<span class="string">'&lt;/span&gt;\n\nVue.use(ElementUI)\n\n&lt;span class=\"hljs-keyword\"&gt;new&lt;/span&gt; Vue({\n  &lt;span class=\"hljs-attr\"&gt;el&lt;/span&gt;: &lt;span class=\"hljs-string\"&gt;\'</span>#app\<span class="string">'&lt;/span&gt;,\n  &lt;span class=\"hljs-attr\"&gt;render&lt;/span&gt;: &lt;span class=\"hljs-function\"&gt;&lt;span class=\"hljs-params\"&gt;h&lt;/span&gt; =&amp;gt;&lt;/span&gt; h(App)\n})\n\n&lt;/code&gt;&lt;/div&gt;&lt;/pre&gt;\n&lt;p&gt;以上代码便完成了 Element 的引入。需要注意的是，样式文件需要单独引入。&lt;/p&gt;\n&lt;h4&gt;按需引入&lt;/h4&gt;\n&lt;p&gt;借助 babel-plugin-component，我们可以只引入需要的组件，以达到减小项目体积的目的。&lt;/p&gt;\n&lt;p&gt;首先，安装 babel-plugin-component：&lt;/p&gt;\n'</span>, <span class="number">10</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `ms_article_body` <span class="keyword">VALUES</span> (<span class="number">1405564731351162882</span>, <span class="string">'666666666666'</span>, <span class="string">'&lt;p&gt;666666666666&lt;/p&gt;\n'</span>, <span class="number">1405564731300831233</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `ms_article_body` <span class="keyword">VALUES</span> (<span class="number">1405909844828909569</span>, <span class="string">'# 1. Spring Boot介绍\n\n## 1.1 简介\n\n在您第1次接触和学习Spring框架的时候，是否因为其繁杂的配置而退却了？\n\n在你第n次使用Spring框架的时候，是否觉得一堆反复黏贴的配置有一些厌烦？\n\n那么您就不妨来试试使用Spring Boot来让你更易上手，更简单快捷地构建Spring应用！\n\nSpring Boot让我们的Spring应用变的更轻量化。\n\n我们不必像以前那样繁琐的构建项目、打包应用、部署到Tomcat等应用服务器中来运行我们的业务服务。\n\n通过Spring Boot实现的服务，只需要依靠一个Java类，把它打包成jar，并通过`java -jar`命令就可以运行起来。\n\n这一切相较于传统Spring应用来说，已经变得非常的轻便、简单。\n\n**总结一下Spring Boot的主要优点：**\n\n1. 为所有Spring开发者更快的入门\n2. 开箱即用，提供各种默认配置来简化项目配置\n3. 内嵌式容器简化Web项目\n4. 没有冗余代码生成和XML配置的要求\n5. 统一的依赖管理\n6. 自动装配，更易使用，更易扩展\n\n## 1.2 使用版本说明\n\nSpringboot版本：使用最新的2.5.0版本\n\n教程参考了官方文档进行制作，权威。\n\n其他依赖版本：\n\n	1. Maven  需求：3.5+\n\n   	2. JDK 需求  8+\n   	3. Spring Framework 5.3.7以上版本\n   	4. Tomcat 9.0\n   	5. Servlet版本 4.0  但是可以部署到Servlet到3.1+的容器中\n\n# 2. 快速入门\n\n快速的创建一个Spring Boot应用，并且实现一个简单的Http请求处理。通过这个例子对Spring Boot有一个初步的了解，并体验其结构简单、开发快速的特性。\n\n教程使用的Idea版本：2019.3\n\n## 2.1 创建基础项目\n\n**第一步：** 创建maven项目\n\npom.xml :\n\n~~~xml\n&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;\n&lt;project xmlns=\"http://maven.apache.org/POM/4.0.0\"\n         xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\"\n         xsi:schemaLocation=\"http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd\"&gt;\n    &lt;modelVersion&gt;4.0.0&lt;/modelVersion&gt;\n\n    &lt;groupId&gt;com.xiaopizhu&lt;/groupId&gt;\n    &lt;artifactId&gt;helloSpringBoot&lt;/artifactId&gt;\n    &lt;version&gt;1.0-SNAPSHOT&lt;/version&gt;\n	&lt;!--springboot的父工程其中定义了常用的依赖，并且无依赖冲突--&gt;\n    &lt;parent&gt;\n        &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\n        &lt;artifactId&gt;spring-boot-starter-parent&lt;/artifactId&gt;\n        &lt;version&gt;2.5.0&lt;/version&gt;\n    &lt;/parent&gt;\n&lt;/project&gt;\n~~~\n\n注意上方的parent必须加，其中定义了springboot官方支持的n多依赖，基本上常用的已经有了，所以接下来导入依赖的时候，绝大部分都可以不加版本号。\n\n此时的工程结构为：\n\n![image20210523173241557.png](https://static.mszlu.com/6fc39758-0db2-431d-9f94-a705aa2c7e59.png)\n\n**第二步：** 添加web依赖\n\n~~~xml\n&lt;dependencies&gt;\n    &lt;dependency&gt;\n        &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\n        &lt;artifactId&gt;spring-boot-starter-web&lt;/artifactId&gt;\n    &lt;/dependency&gt;\n&lt;/dependencies&gt;\n~~~\n\n添加上方的web依赖，其中间接依赖了spring-web，spring-webmvc，spring-core等spring和springmvc的包，并且集成了tomcat。\n\n**第三步：** 编写启动类\n\n~~~java\npackage com.xiaopizhu.springboot;\n\nimport org.springframework.boot.SpringApplication;\nimport org.springframework.boot.autoconfigure.SpringBootApplication;\n\n@SpringBootApplication\npublic class HelloApp {\n\n    public static void main(String[] args) {\n        SpringApplication.run(HelloApp.class,args);\n    }\n}\n\n~~~\n\n@SpringBootApplication注解标识了HelloApp为启动类，也是Spring Boot的核心。\n\n**第四步：** 运行启动类的main方法\n\n![image-20210523173712142](img/image-20210523173712142.png)\n\n看到如上配置，证明启动成功，tomcat端口号默认为8080。\n\n**第五步：**  如果想要修改端口号，可以在resources目录下新建application.properties\n\n~~~properties\nserver.port=8082\n~~~\n\n**第六步：** 重新运行\n\n![image-20210523174011613](img/image-20210523174011613.png)\n\n此时的项目结构为：\n\n![image-20210523174032053](img/image-20210523174032053.png)\n\n**src/main/java :**  编写java代码，注意启动类需要放在项目的根包下。\n\n**src/main/resources:**  放置资源的目录，比如springboot的配置文件，静态文件，mybatis配置，日志配置等。\n\n**src/test/java:**  测试代码\n\n## 2.2 编写一个Http接口\n\n**第一步：**  创建`HelloController`类，内容如下：\n\n~~~java\npackage com.xiaopizhu.springboot.controller;\n\nimport org.springframework.web.bind.annotation.GetMapping;\nimport org.springframework.web.bind.annotation.RequestMapping;\nimport org.springframework.web.bind.annotation.RestController;\n\n@RestController\n@RequestMapping(\"hello\")\npublic class HelloController {\n\n    @GetMapping(\"boot\")\n    public String hello(){\n        return \"hello spring boot\";\n    }\n\n}\n\n~~~\n\n**注意包名，必须在启动类所在的包名下。**\n\n**第二步： ** 重启程序，使用postman或者直接在浏览器输入http://localhost:8082/hello/boot\n\n得到结果：hello spring boot\n\n## 2.3 编写单元测试用例\n\n**第一步： ** 添加spring boot测试依赖\n\n~~~xml\n		&lt;dependency&gt;\n            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\n            &lt;artifactId&gt;spring-boot-starter-test&lt;/artifactId&gt;\n            &lt;scope&gt;test&lt;/scope&gt;\n        &lt;/dependency&gt;\n~~~\n\n**第二步：** 在src/test 下，编写测试用例\n\n~~~java\npackage com.xiaopizhu.springboot.controller;\n\nimport org.junit.jupiter.api.BeforeAll;\nimport org.junit.jupiter.api.BeforeEach;\nimport org.junit.jupiter.api.Test;\nimport org.springframework.boot.test.context.SpringBootTest;\nimport org.springframework.http.MediaType;\nimport org.springframework.test.web.servlet.MockMvc;\nimport org.springframework.test.web.servlet.request.MockMvcRequestBuilders;\nimport org.springframework.test.web.servlet.setup.MockMvcBuilders;\n\nimport static org.hamcrest.Matchers.equalTo;\nimport static org.springframework.test.web.servlet.result.MockMvcResultMatchers.content;\nimport static org.springframework.test.web.servlet.result.MockMvcResultMatchers.status;\n\n@SpringBootTest\npublic class TestHelloController {\n\n    private MockMvc mockMvc;\n\n    @BeforeEach\n    public void beforeEach(){\n        mockMvc = MockMvcBuilders.standaloneSetup(new HelloController()).build();\n    }\n    @Test\n    public void testHello() throws Exception {\n        mockMvc.perform(MockMvcRequestBuilders.get(\"/hello/boot\")\n                .accept(MediaType.APPLICATION_JSON))\n                .andExpect(status().isOk())\n                .andExpect(content().string(equalTo(\"hello spring boot\")));\n    }\n}\n\n~~~\n\n上面的测试用例，是构建一个空的`WebApplicationContext`，并且在before中加载了HelloController，得以在测试用例中mock调用，模拟请求。\n\n## 2.4 打包为jar运行\n\n**第一步：** 添加打包(maven构建springboot)插件\n\n~~~xml\n  &lt;build&gt;\n        &lt;plugins&gt;\n            &lt;plugin&gt;\n                &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\n                &lt;artifactId&gt;spring-boot-maven-plugin&lt;/artifactId&gt;\n            &lt;/plugin&gt;\n        &lt;/plugins&gt;\n    &lt;/build&gt;\n~~~\n\n在idea的右侧 maven中，使用package来打包程序，打包完成后，在target目录下生成helloSpringBoot-1.0-SNAPSHOT.jar\n\n![image-20210523181737720](img/image-20210523181737720.png)\n\n**第二步： ** 打开cmd：找到jar对应的目录\n\n输入命令\n\n~~~shell\njava -jar helloSpringBoot-1.0-SNAPSHOT.jar\n~~~\n\n![image-20210523182426404](img/image-20210523182426404.png)\n\n**第三步：**  测试，使用postman或者直接在浏览器输入http://localhost:8082/hello/boot\n\n得到结果：hello spring boot\n\n## 2.5 查看jar包内容\n\n~~~shell\njar tvf helloSpringBoot-1.0-SNAPSHOT.jar\n~~~\n\n# 3. 小结\n\n1. 通过Maven构建了一个空白Spring Boot项目，再通过引入web模块实现了一个简单的请求处理。\n2. 通过修改配置文件，更改端口号\n3. 编写了测试用例\n4. 打包jar包运行\n\n'</span>, <span class="string">'&lt;h1&gt;&lt;a id=\"1_Spring_Boot_0\"&gt;&lt;/a&gt;1. Spring Boot介绍&lt;/h1&gt;\n&lt;h2&gt;&lt;a id=\"11__2\"&gt;&lt;/a&gt;1.1 简介&lt;/h2&gt;\n&lt;p&gt;在您第1次接触和学习Spring框架的时候，是否因为其繁杂的配置而退却了？&lt;/p&gt;\n&lt;p&gt;在你第n次使用Spring框架的时候，是否觉得一堆反复黏贴的配置有一些厌烦？&lt;/p&gt;\n&lt;p&gt;那么您就不妨来试试使用Spring Boot来让你更易上手，更简单快捷地构建Spring应用！&lt;/p&gt;\n&lt;p&gt;Spring Boot让我们的Spring应用变的更轻量化。&lt;/p&gt;\n&lt;p&gt;我们不必像以前那样繁琐的构建项目、打包应用、部署到Tomcat等应用服务器中来运行我们的业务服务。&lt;/p&gt;\n&lt;p&gt;通过Spring Boot实现的服务，只需要依靠一个Java类，把它打包成jar，并通过&lt;code&gt;java -jar&lt;/code&gt;命令就可以运行起来。&lt;/p&gt;\n&lt;p&gt;这一切相较于传统Spring应用来说，已经变得非常的轻便、简单。&lt;/p&gt;\n&lt;p&gt;&lt;strong&gt;总结一下Spring Boot的主要优点：&lt;/strong&gt;&lt;/p&gt;\n&lt;ol&gt;\n&lt;li&gt;为所有Spring开发者更快的入门&lt;/li&gt;\n&lt;li&gt;开箱即用，提供各种默认配置来简化项目配置&lt;/li&gt;\n&lt;li&gt;内嵌式容器简化Web项目&lt;/li&gt;\n&lt;li&gt;没有冗余代码生成和XML配置的要求&lt;/li&gt;\n&lt;li&gt;统一的依赖管理&lt;/li&gt;\n&lt;li&gt;自动装配，更易使用，更易扩展&lt;/li&gt;\n&lt;/ol&gt;\n&lt;h2&gt;&lt;a id=\"12__27\"&gt;&lt;/a&gt;1.2 使用版本说明&lt;/h2&gt;\n&lt;p&gt;Springboot版本：使用最新的2.5.0版本&lt;/p&gt;\n&lt;p&gt;教程参考了官方文档进行制作，权威。&lt;/p&gt;\n&lt;p&gt;其他依赖版本：&lt;/p&gt;\n&lt;pre&gt;&lt;code&gt;1. Maven  需求：3.5+\n\n2. JDK 需求  8+\n3. Spring Framework 5.3.7以上版本\n4. Tomcat 9.0\n5. Servlet版本 4.0  但是可以部署到Servlet到3.1+的容器中\n&lt;/code&gt;&lt;/pre&gt;\n&lt;h1&gt;&lt;a id=\"2__42\"&gt;&lt;/a&gt;2. 快速入门&lt;/h1&gt;\n&lt;p&gt;快速的创建一个Spring Boot应用，并且实现一个简单的Http请求处理。通过这个例子对Spring Boot有一个初步的了解，并体验其结构简单、开发快速的特性。&lt;/p&gt;\n&lt;p&gt;教程使用的Idea版本：2019.3&lt;/p&gt;\n&lt;h2&gt;&lt;a id=\"21__48\"&gt;&lt;/a&gt;2.1 创建基础项目&lt;/h2&gt;\n&lt;p&gt;&lt;strong&gt;第一步：&lt;/strong&gt; 创建maven项目&lt;/p&gt;\n&lt;p&gt;pom.xml :&lt;/p&gt;\n&lt;pre&gt;&lt;div class=\"hljs\"&gt;&lt;code class=\"lang-xml\"&gt;&lt;span class=\"php\"&gt;&lt;span class=\"hljs-meta\"&gt;&amp;lt;?&lt;/span&gt;xml version=&lt;span class=\"hljs-string\"&gt;\"1.0\"&lt;/span&gt; encoding=&lt;span class=\"hljs-string\"&gt;\"UTF-8\"&lt;/span&gt;&lt;span class=\"hljs-meta\"&gt;?&amp;gt;&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\"hljs-tag\"&gt;&amp;lt;&lt;span class=\"hljs-name\"&gt;project&lt;/span&gt; &lt;span class=\"hljs-attr\"&gt;xmlns&lt;/span&gt;=&lt;span class=\"hljs-string\"&gt;\"http://maven.apache.org/POM/4.0.0\"&lt;/span&gt;\n         &lt;span class=\"hljs-attr\"&gt;xmlns:xsi&lt;/span&gt;=&lt;span class=\"hljs-string\"&gt;\"http://www.w3.org/2001/XMLSchema-instance\"&lt;/span&gt;\n         &lt;span class=\"hljs-attr\"&gt;xsi:schemaLocation&lt;/span&gt;=&lt;span class=\"hljs-string\"&gt;\"http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd\"&lt;/span&gt;&amp;gt;&lt;/span&gt;\n    &lt;span class=\"hljs-tag\"&gt;&amp;lt;&lt;span class=\"hljs-name\"&gt;modelVersion&lt;/span&gt;&amp;gt;&lt;/span&gt;4.0.0&lt;span class=\"hljs-tag\"&gt;&amp;lt;/&lt;span class=\"hljs-name\"&gt;modelVersion&lt;/span&gt;&amp;gt;&lt;/span&gt;\n\n    &lt;span class=\"hljs-tag\"&gt;&amp;lt;&lt;span class=\"hljs-name\"&gt;groupId&lt;/span&gt;&amp;gt;&lt;/span&gt;com.xiaopizhu&lt;span class=\"hljs-tag\"&gt;&amp;lt;/&lt;span class=\"hljs-name\"&gt;groupId&lt;/span&gt;&amp;gt;&lt;/span&gt;\n    &lt;span class=\"hljs-tag\"&gt;&amp;lt;&lt;span class=\"hljs-name\"&gt;artifactId&lt;/span&gt;&amp;gt;&lt;/span&gt;helloSpringBoot&lt;span class=\"hljs-tag\"&gt;&amp;lt;/&lt;span class=\"hljs-name\"&gt;artifactId&lt;/span&gt;&amp;gt;&lt;/span&gt;\n    &lt;span class=\"hljs-tag\"&gt;&amp;lt;&lt;span class=\"hljs-name\"&gt;version&lt;/span&gt;&amp;gt;&lt;/span&gt;1.0-SNAPSHOT&lt;span class=\"hljs-tag\"&gt;&amp;lt;/&lt;span class=\"hljs-name\"&gt;version&lt;/span&gt;&amp;gt;&lt;/span&gt;\n	&lt;span class=\"hljs-comment\"&gt;&amp;lt;!--springboot的父工程其中定义了常用的依赖，并且无依赖冲突--&amp;gt;&lt;/span&gt;\n    &lt;span class=\"hljs-tag\"&gt;&amp;lt;&lt;span class=\"hljs-name\"&gt;parent&lt;/span&gt;&amp;gt;&lt;/span&gt;\n        &lt;span class=\"hljs-tag\"&gt;&amp;lt;&lt;span class=\"hljs-name\"&gt;groupId&lt;/span&gt;&amp;gt;&lt;/span&gt;org.springframework.boot&lt;span class=\"hljs-tag\"&gt;&amp;lt;/&lt;span class=\"hljs-name\"&gt;groupId&lt;/span&gt;&amp;gt;&lt;/span&gt;\n        &lt;span class=\"hljs-tag\"&gt;&amp;lt;&lt;span class=\"hljs-name\"&gt;artifactId&lt;/span&gt;&amp;gt;&lt;/span&gt;spring-boot-starter-parent&lt;span class=\"hljs-tag\"&gt;&amp;lt;/&lt;span class=\"hljs-name\"&gt;artifactId&lt;/span&gt;&amp;gt;&lt;/span&gt;\n        &lt;span class=\"hljs-tag\"&gt;&amp;lt;&lt;span class=\"hljs-name\"&gt;version&lt;/span&gt;&amp;gt;&lt;/span&gt;2.5.0&lt;span class=\"hljs-tag\"&gt;&amp;lt;/&lt;span class=\"hljs-name\"&gt;version&lt;/span&gt;&amp;gt;&lt;/span&gt;\n    &lt;span class=\"hljs-tag\"&gt;&amp;lt;/&lt;span class=\"hljs-name\"&gt;parent&lt;/span&gt;&amp;gt;&lt;/span&gt;\n&lt;span class=\"hljs-tag\"&gt;&amp;lt;/&lt;span class=\"hljs-name\"&gt;project&lt;/span&gt;&amp;gt;&lt;/span&gt;\n&lt;/code&gt;&lt;/div&gt;&lt;/pre&gt;\n&lt;p&gt;注意上方的parent必须加，其中定义了springboot官方支持的n多依赖，基本上常用的已经有了，所以接下来导入依赖的时候，绝大部分都可以不加版本号。&lt;/p&gt;\n&lt;p&gt;此时的工程结构为：&lt;/p&gt;\n&lt;p&gt;&lt;img src=\"https://static.mszlu.com/6fc39758-0db2-431d-9f94-a705aa2c7e59.png\" alt=\"image20210523173241557.png\" /&gt;&lt;/p&gt;\n&lt;p&gt;&lt;strong&gt;第二步：&lt;/strong&gt; 添加web依赖&lt;/p&gt;\n&lt;pre&gt;&lt;div class=\"hljs\"&gt;&lt;code class=\"lang-xml\"&gt;&lt;span class=\"hljs-tag\"&gt;&amp;lt;&lt;span class=\"hljs-name\"&gt;dependencies&lt;/span&gt;&amp;gt;&lt;/span&gt;\n    &lt;span class=\"hljs-tag\"&gt;&amp;lt;&lt;span class=\"hljs-name\"&gt;dependency&lt;/span&gt;&amp;gt;&lt;/span&gt;\n        &lt;span class=\"hljs-tag\"&gt;&amp;lt;&lt;span class=\"hljs-name\"&gt;groupId&lt;/span&gt;&amp;gt;&lt;/span&gt;org.springframework.boot&lt;span class=\"hljs-tag\"&gt;&amp;lt;/&lt;span class=\"hljs-name\"&gt;groupId&lt;/span&gt;&amp;gt;&lt;/span&gt;\n        &lt;span class=\"hljs-tag\"&gt;&amp;lt;&lt;span class=\"hljs-name\"&gt;artifactId&lt;/span&gt;&amp;gt;&lt;/span&gt;spring-boot-starter-web&lt;span class=\"hljs-tag\"&gt;&amp;lt;/&lt;span class=\"hljs-name\"&gt;artifactId&lt;/span&gt;&amp;gt;&lt;/span&gt;\n    &lt;span class=\"hljs-tag\"&gt;&amp;lt;/&lt;span class=\"hljs-name\"&gt;dependency&lt;/span&gt;&amp;gt;&lt;/span&gt;\n&lt;span class=\"hljs-tag\"&gt;&amp;lt;/&lt;span class=\"hljs-name\"&gt;dependencies&lt;/span&gt;&amp;gt;&lt;/span&gt;\n&lt;/code&gt;&lt;/div&gt;&lt;/pre&gt;\n&lt;p&gt;添加上方的web依赖，其中间接依赖了spring-web，spring-webmvc，spring-core等spring和springmvc的包，并且集成了tomcat。&lt;/p&gt;\n&lt;p&gt;&lt;strong&gt;第三步：&lt;/strong&gt; 编写启动类&lt;/p&gt;\n&lt;pre&gt;&lt;div class=\"hljs\"&gt;&lt;code class=\"lang-java\"&gt;&lt;span class=\"hljs-keyword\"&gt;package&lt;/span&gt; com.xiaopizhu.springboot;\n\n&lt;span class=\"hljs-keyword\"&gt;import&lt;/span&gt; org.springframework.boot.SpringApplication;\n&lt;span class=\"hljs-keyword\"&gt;import&lt;/span&gt; org.springframework.boot.autoconfigure.SpringBootApplication;\n\n&lt;span class=\"hljs-meta\"&gt;@SpringBootApplication&lt;/span&gt;\n&lt;span class=\"hljs-keyword\"&gt;public&lt;/span&gt; &lt;span class=\"hljs-class\"&gt;&lt;span class=\"hljs-keyword\"&gt;class&lt;/span&gt; &lt;span class=\"hljs-title\"&gt;HelloApp&lt;/span&gt; &lt;/span&gt;{\n\n    &lt;span class=\"hljs-function\"&gt;&lt;span class=\"hljs-keyword\"&gt;public&lt;/span&gt; &lt;span class=\"hljs-keyword\"&gt;static&lt;/span&gt; &lt;span class=\"hljs-keyword\"&gt;void&lt;/span&gt; &lt;span class=\"hljs-title\"&gt;main&lt;/span&gt;&lt;span class=\"hljs-params\"&gt;(String[] args)&lt;/span&gt; &lt;/span&gt;{\n        SpringApplication.run(HelloApp.class,args);\n    }\n}\n\n&lt;/code&gt;&lt;/div&gt;&lt;/pre&gt;\n&lt;p&gt;@SpringBootApplication注解标识了HelloApp为启动类，也是Spring Boot的核心。&lt;/p&gt;\n&lt;p&gt;&lt;strong&gt;第四步：&lt;/strong&gt; 运行启动类的main方法&lt;/p&gt;\n&lt;p&gt;&lt;img src=\"img/image-20210523173712142.png\" alt=\"image-20210523173712142\" /&gt;&lt;/p&gt;\n&lt;p&gt;看到如上配置，证明启动成功，tomcat端口号默认为8080。&lt;/p&gt;\n&lt;p&gt;&lt;strong&gt;第五步：&lt;/strong&gt;  如果想要修改端口号，可以在resources目录下新建application.properties&lt;/p&gt;\n&lt;pre&gt;&lt;code class=\"lang-properties\"&gt;server.port=8082\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;&lt;strong&gt;第六步：&lt;/strong&gt; 重新运行&lt;/p&gt;\n&lt;p&gt;&lt;img src=\"img/image-20210523174011613.png\" alt=\"image-20210523174011613\" /&gt;&lt;/p&gt;\n&lt;p&gt;此时的项目结构为：&lt;/p&gt;\n&lt;p&gt;&lt;img src=\"img/image-20210523174032053.png\" alt=\"image-20210523174032053\" /&gt;&lt;/p&gt;\n&lt;p&gt;&lt;strong&gt;src/main/java :&lt;/strong&gt;  编写java代码，注意启动类需要放在项目的根包下。&lt;/p&gt;\n&lt;p&gt;&lt;strong&gt;src/main/resources:&lt;/strong&gt;  放置资源的目录，比如springboot的配置文件，静态文件，mybatis配置，日志配置等。&lt;/p&gt;\n&lt;p&gt;&lt;strong&gt;src/test/java:&lt;/strong&gt;  测试代码&lt;/p&gt;\n&lt;h2&gt;&lt;a id=\"22_Http_138\"&gt;&lt;/a&gt;2.2 编写一个Http接口&lt;/h2&gt;\n&lt;p&gt;&lt;strong&gt;第一步：&lt;/strong&gt;  创建&lt;code&gt;HelloController&lt;/code&gt;类，内容如下：&lt;/p&gt;\n&lt;pre&gt;&lt;div class=\"hljs\"&gt;&lt;code class=\"lang-java\"&gt;&lt;span class=\"hljs-keyword\"&gt;package&lt;/span&gt; com.xiaopizhu.springboot.controller;\n\n&lt;span class=\"hljs-keyword\"&gt;import&lt;/span&gt; org.springframework.web.bind.annotation.GetMapping;\n&lt;span class=\"hljs-keyword\"&gt;import&lt;/span&gt; org.springframework.web.bind.annotation.RequestMapping;\n&lt;span class=\"hljs-keyword\"&gt;import&lt;/span&gt; org.springframework.web.bind.annotation.RestController;\n\n&lt;span class=\"hljs-meta\"&gt;@RestController&lt;/span&gt;\n&lt;span class=\"hljs-meta\"&gt;@RequestMapping&lt;/span&gt;(&lt;span class=\"hljs-string\"&gt;\"hello\"&lt;/span&gt;)\n&lt;span class=\"hljs-keyword\"&gt;public&lt;/span&gt; &lt;span class=\"hljs-class\"&gt;&lt;span class=\"hljs-keyword\"&gt;class&lt;/span&gt; &lt;span class=\"hljs-title\"&gt;HelloController&lt;/span&gt; &lt;/span&gt;{\n\n    &lt;span class=\"hljs-meta\"&gt;@GetMapping&lt;/span&gt;(&lt;span class=\"hljs-string\"&gt;\"boot\"&lt;/span&gt;)\n    &lt;span class=\"hljs-function\"&gt;&lt;span class=\"hljs-keyword\"&gt;public&lt;/span&gt; String &lt;span class=\"hljs-title\"&gt;hello&lt;/span&gt;&lt;span class=\"hljs-params\"&gt;()&lt;/span&gt;&lt;/span&gt;{\n        &lt;span class=\"hljs-keyword\"&gt;return&lt;/span&gt; &lt;span class=\"hljs-string\"&gt;\"hello spring boot\"&lt;/span&gt;;\n    }\n\n}\n\n&lt;/code&gt;&lt;/div&gt;&lt;/pre&gt;\n&lt;p&gt;&lt;strong&gt;注意包名，必须在启动类所在的包名下。&lt;/strong&gt;&lt;/p&gt;\n&lt;p&gt;**第二步： ** 重启程序，使用postman或者直接在浏览器输入http://localhost:8082/hello/boot&lt;/p&gt;\n&lt;p&gt;得到结果：hello spring boot&lt;/p&gt;\n&lt;h2&gt;&lt;a id=\"23__168\"&gt;&lt;/a&gt;2.3 编写单元测试用例&lt;/h2&gt;\n&lt;p&gt;**第一步： ** 添加spring boot测试依赖&lt;/p&gt;\n&lt;pre&gt;&lt;div class=\"hljs\"&gt;&lt;code class=\"lang-xml\"&gt;		&lt;span class=\"hljs-tag\"&gt;&amp;lt;&lt;span class=\"hljs-name\"&gt;dependency&lt;/span&gt;&amp;gt;&lt;/span&gt;\n            &lt;span class=\"hljs-tag\"&gt;&amp;lt;&lt;span class=\"hljs-name\"&gt;groupId&lt;/span&gt;&amp;gt;&lt;/span&gt;org.springframework.boot&lt;span class=\"hljs-tag\"&gt;&amp;lt;/&lt;span class=\"hljs-name\"&gt;groupId&lt;/span&gt;&amp;gt;&lt;/span&gt;\n            &lt;span class=\"hljs-tag\"&gt;&amp;lt;&lt;span class=\"hljs-name\"&gt;artifactId&lt;/span&gt;&amp;gt;&lt;/span&gt;spring-boot-starter-test&lt;span class=\"hljs-tag\"&gt;&amp;lt;/&lt;span class=\"hljs-name\"&gt;artifactId&lt;/span&gt;&amp;gt;&lt;/span&gt;\n            &lt;span class=\"hljs-tag\"&gt;&amp;lt;&lt;span class=\"hljs-name\"&gt;scope&lt;/span&gt;&amp;gt;&lt;/span&gt;test&lt;span class=\"hljs-tag\"&gt;&amp;lt;/&lt;span class=\"hljs-name\"&gt;scope&lt;/span&gt;&amp;gt;&lt;/span&gt;\n        &lt;span class=\"hljs-tag\"&gt;&amp;lt;/&lt;span class=\"hljs-name\"&gt;dependency&lt;/span&gt;&amp;gt;&lt;/span&gt;\n&lt;/code&gt;&lt;/div&gt;&lt;/pre&gt;\n&lt;p&gt;&lt;strong&gt;第二步：&lt;/strong&gt; 在src/test 下，编写测试用例&lt;/p&gt;\n&lt;pre&gt;&lt;div class=\"hljs\"&gt;&lt;code class=\"lang-java\"&gt;&lt;span class=\"hljs-keyword\"&gt;package&lt;/span&gt; com.xiaopizhu.springboot.controller;\n\n&lt;span class=\"hljs-keyword\"&gt;import&lt;/span&gt; org.junit.jupiter.api.BeforeAll;\n&lt;span class=\"hljs-keyword\"&gt;import&lt;/span&gt; org.junit.jupiter.api.BeforeEach;\n&lt;span class=\"hljs-keyword\"&gt;import&lt;/span&gt; org.junit.jupiter.api.Test;\n&lt;span class=\"hljs-keyword\"&gt;import&lt;/span&gt; org.springframework.boot.test.context.SpringBootTest;\n&lt;span class=\"hljs-keyword\"&gt;import&lt;/span&gt; org.springframework.http.MediaType;\n&lt;span class=\"hljs-keyword\"&gt;import&lt;/span&gt; org.springframework.test.web.servlet.MockMvc;\n&lt;span class=\"hljs-keyword\"&gt;import&lt;/span&gt; org.springframework.test.web.servlet.request.MockMvcRequestBuilders;\n&lt;span class=\"hljs-keyword\"&gt;import&lt;/span&gt; org.springframework.test.web.servlet.setup.MockMvcBuilders;\n\n&lt;span class=\"hljs-keyword\"&gt;import&lt;/span&gt; &lt;span class=\"hljs-keyword\"&gt;static&lt;/span&gt; org.hamcrest.Matchers.equalTo;\n&lt;span class=\"hljs-keyword\"&gt;import&lt;/span&gt; &lt;span class=\"hljs-keyword\"&gt;static&lt;/span&gt; org.springframework.test.web.servlet.result.MockMvcResultMatchers.content;\n&lt;span class=\"hljs-keyword\"&gt;import&lt;/span&gt; &lt;span class=\"hljs-keyword\"&gt;static&lt;/span&gt; org.springframework.test.web.servlet.result.MockMvcResultMatchers.status;\n\n&lt;span class=\"hljs-meta\"&gt;@SpringBootTest&lt;/span&gt;\n&lt;span class=\"hljs-keyword\"&gt;public&lt;/span&gt; &lt;span class=\"hljs-class\"&gt;&lt;span class=\"hljs-keyword\"&gt;class&lt;/span&gt; &lt;span class=\"hljs-title\"&gt;TestHelloController&lt;/span&gt; &lt;/span&gt;{\n\n    &lt;span class=\"hljs-keyword\"&gt;private&lt;/span&gt; MockMvc mockMvc;\n\n    &lt;span class=\"hljs-meta\"&gt;@BeforeEach&lt;/span&gt;\n    &lt;span class=\"hljs-function\"&gt;&lt;span class=\"hljs-keyword\"&gt;public&lt;/span&gt; &lt;span class=\"hljs-keyword\"&gt;void&lt;/span&gt; &lt;span class=\"hljs-title\"&gt;beforeEach&lt;/span&gt;&lt;span class=\"hljs-params\"&gt;()&lt;/span&gt;&lt;/span&gt;{\n        mockMvc = MockMvcBuilders.standaloneSetup(&lt;span class=\"hljs-keyword\"&gt;new&lt;/span&gt; HelloController()).build();\n    }\n    &lt;span class=\"hljs-meta\"&gt;@Test&lt;/span&gt;\n    &lt;span class=\"hljs-function\"&gt;&lt;span class=\"hljs-keyword\"&gt;public&lt;/span&gt; &lt;span class=\"hljs-keyword\"&gt;void&lt;/span&gt; &lt;span class=\"hljs-title\"&gt;testHello&lt;/span&gt;&lt;span class=\"hljs-params\"&gt;()&lt;/span&gt; &lt;span class=\"hljs-keyword\"&gt;throws&lt;/span&gt; Exception &lt;/span&gt;{\n        mockMvc.perform(MockMvcRequestBuilders.get(&lt;span class=\"hljs-string\"&gt;\"/hello/boot\"&lt;/span&gt;)\n                .accept(MediaType.APPLICATION_JSON))\n                .andExpect(status().isOk())\n                .andExpect(content().string(equalTo(&lt;span class=\"hljs-string\"&gt;\"hello spring boot\"&lt;/span&gt;)));\n    }\n}\n\n&lt;/code&gt;&lt;/div&gt;&lt;/pre&gt;\n&lt;p&gt;上面的测试用例，是构建一个空的&lt;code&gt;WebApplicationContext&lt;/code&gt;，并且在before中加载了HelloController，得以在测试用例中mock调用，模拟请求。&lt;/p&gt;\n&lt;h2&gt;&lt;a id=\"24_jar_220\"&gt;&lt;/a&gt;2.4 打包为jar运行&lt;/h2&gt;\n&lt;p&gt;&lt;strong&gt;第一步：&lt;/strong&gt; 添加打包(maven构建springboot)插件&lt;/p&gt;\n&lt;pre&gt;&lt;div class=\"hljs\"&gt;&lt;code class=\"lang-xml\"&gt;  &lt;span class=\"hljs-tag\"&gt;&amp;lt;&lt;span class=\"hljs-name\"&gt;build&lt;/span&gt;&amp;gt;&lt;/span&gt;\n        &lt;span class=\"hljs-tag\"&gt;&amp;lt;&lt;span class=\"hljs-name\"&gt;plugins&lt;/span&gt;&amp;gt;&lt;/span&gt;\n            &lt;span class=\"hljs-tag\"&gt;&amp;lt;&lt;span class=\"hljs-name\"&gt;plugin&lt;/span&gt;&amp;gt;&lt;/span&gt;\n                &lt;span class=\"hljs-tag\"&gt;&amp;lt;&lt;span class=\"hljs-name\"&gt;groupId&lt;/span&gt;&amp;gt;&lt;/span&gt;org.springframework.boot&lt;span class=\"hljs-tag\"&gt;&amp;lt;/&lt;span class=\"hljs-name\"&gt;groupId&lt;/span&gt;&amp;gt;&lt;/span&gt;\n                &lt;span class=\"hljs-tag\"&gt;&amp;lt;&lt;span class=\"hljs-name\"&gt;artifactId&lt;/span&gt;&amp;gt;&lt;/span&gt;spring-boot-maven-plugin&lt;span class=\"hljs-tag\"&gt;&amp;lt;/&lt;span class=\"hljs-name\"&gt;artifactId&lt;/span&gt;&amp;gt;&lt;/span&gt;\n            &lt;span class=\"hljs-tag\"&gt;&amp;lt;/&lt;span class=\"hljs-name\"&gt;plugin&lt;/span&gt;&amp;gt;&lt;/span&gt;\n        &lt;span class=\"hljs-tag\"&gt;&amp;lt;/&lt;span class=\"hljs-name\"&gt;plugins&lt;/span&gt;&amp;gt;&lt;/span&gt;\n    &lt;span class=\"hljs-tag\"&gt;&amp;lt;/&lt;span class=\"hljs-name\"&gt;build&lt;/span&gt;&amp;gt;&lt;/span&gt;\n&lt;/code&gt;&lt;/div&gt;&lt;/pre&gt;\n&lt;p&gt;在idea的右侧 maven中，使用package来打包程序，打包完成后，在target目录下生成helloSpringBoot-1.0-SNAPSHOT.jar&lt;/p&gt;\n&lt;p&gt;&lt;img src=\"img/image-20210523181737720.png\" alt=\"image-20210523181737720\" /&gt;&lt;/p&gt;\n&lt;p&gt;**第二步： ** 打开cmd：找到jar对应的目录&lt;/p&gt;\n&lt;p&gt;输入命令&lt;/p&gt;\n&lt;pre&gt;&lt;div class=\"hljs\"&gt;&lt;code class=\"lang-shell\"&gt;java -jar helloSpringBoot-1.0-SNAPSHOT.jar\n&lt;/code&gt;&lt;/div&gt;&lt;/pre&gt;\n&lt;p&gt;&lt;img src=\"img/image-20210523182426404.png\" alt=\"image-20210523182426404\" /&gt;&lt;/p&gt;\n&lt;p&gt;&lt;strong&gt;第三步：&lt;/strong&gt;  测试，使用postman或者直接在浏览器输入http://localhost:8082/hello/boot&lt;/p&gt;\n&lt;p&gt;得到结果：hello spring boot&lt;/p&gt;\n&lt;h2&gt;&lt;a id=\"25_jar_253\"&gt;&lt;/a&gt;2.5 查看jar包内容&lt;/h2&gt;\n&lt;pre&gt;&lt;div class=\"hljs\"&gt;&lt;code class=\"lang-shell\"&gt;jar tvf helloSpringBoot-1.0-SNAPSHOT.jar\n&lt;/code&gt;&lt;/div&gt;&lt;/pre&gt;\n&lt;h1&gt;&lt;a id=\"3__259\"&gt;&lt;/a&gt;3. 小结&lt;/h1&gt;\n&lt;ol&gt;\n&lt;li&gt;通过Maven构建了一个空白Spring Boot项目，再通过引入web模块实现了一个简单的请求处理。&lt;/li&gt;\n&lt;li&gt;通过修改配置文件，更改端口号&lt;/li&gt;\n&lt;li&gt;编写了测试用例&lt;/li&gt;\n&lt;li&gt;打包jar包运行&lt;/li&gt;\n&lt;/ol&gt;\n'</span>, <span class="number">1405909844724051969</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `ms_article_body` <span class="keyword">VALUES</span> (<span class="number">1405916999854342146</span>, <span class="string">'# 1. Spring Boot介绍\n\n## 1.1 简介\n\n在您第1次接触和学习Spring框架的时候，是否因为其繁杂的配置而退却了？\n\n在你第n次使用Spring框架的时候，是否觉得一堆反复黏贴的配置有一些厌烦？\n\n那么您就不妨来试试使用Spring Boot来让你更易上手，更简单快捷地构建Spring应用！\n\nSpring Boot让我们的Spring应用变的更轻量化。\n\n我们不必像以前那样繁琐的构建项目、打包应用、部署到Tomcat等应用服务器中来运行我们的业务服务。\n\n通过Spring Boot实现的服务，只需要依靠一个Java类，把它打包成jar，并通过`java -jar`命令就可以运行起来。\n\n这一切相较于传统Spring应用来说，已经变得非常的轻便、简单。\n\n**总结一下Spring Boot的主要优点：**\n\n1. 为所有Spring开发者更快的入门\n2. 开箱即用，提供各种默认配置来简化项目配置\n3. 内嵌式容器简化Web项目\n4. 没有冗余代码生成和XML配置的要求\n5. 统一的依赖管理\n6. 自动装配，更易使用，更易扩展\n\n## 1.2 使用版本说明\n\nSpringboot版本：使用最新的2.5.0版本\n\n教程参考了官方文档进行制作，权威。\n\n其他依赖版本：\n\n	1. Maven  需求：3.5+\n\n   	2. JDK 需求  8+\n   	3. Spring Framework 5.3.7以上版本\n   	4. Tomcat 9.0\n   	5. Servlet版本 4.0  但是可以部署到Servlet到3.1+的容器中\n\n# 2. 快速入门\n\n快速的创建一个Spring Boot应用，并且实现一个简单的Http请求处理。通过这个例子对Spring Boot有一个初步的了解，并体验其结构简单、开发快速的特性。\n\n教程使用的Idea版本：2019.3\n\n## 2.1 创建基础项目\n\n**第一步：** 创建maven项目\n\npom.xml :\n\n~~~xml\n&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;\n&lt;project xmlns=\"http://maven.apache.org/POM/4.0.0\"\n         xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\"\n         xsi:schemaLocation=\"http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd\"&gt;\n    &lt;modelVersion&gt;4.0.0&lt;/modelVersion&gt;\n\n    &lt;groupId&gt;com.xiaopizhu&lt;/groupId&gt;\n    &lt;artifactId&gt;helloSpringBoot&lt;/artifactId&gt;\n    &lt;version&gt;1.0-SNAPSHOT&lt;/version&gt;\n	&lt;!--springboot的父工程其中定义了常用的依赖，并且无依赖冲突--&gt;\n    &lt;parent&gt;\n        &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\n        &lt;artifactId&gt;spring-boot-starter-parent&lt;/artifactId&gt;\n        &lt;version&gt;2.5.0&lt;/version&gt;\n    &lt;/parent&gt;\n&lt;/project&gt;\n~~~\n\n注意上方的parent必须加，其中定义了springboot官方支持的n多依赖，基本上常用的已经有了，所以接下来导入依赖的时候，绝大部分都可以不加版本号。\n\n此时的工程结构为：\n\n![image20210523173241557.png](https://static.mszlu.com/a7302c88-e106-46ad-9713-dc9a6d523957.png)\n\n**第二步：** 添加web依赖\n\n~~~xml\n&lt;dependencies&gt;\n    &lt;dependency&gt;\n        &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\n        &lt;artifactId&gt;spring-boot-starter-web&lt;/artifactId&gt;\n    &lt;/dependency&gt;\n&lt;/dependencies&gt;\n~~~\n\n添加上方的web依赖，其中间接依赖了spring-web，spring-webmvc，spring-core等spring和springmvc的包，并且集成了tomcat。\n\n**第三步：** 编写启动类\n\n~~~java\npackage com.xiaopizhu.springboot;\n\nimport org.springframework.boot.SpringApplication;\nimport org.springframework.boot.autoconfigure.SpringBootApplication;\n\n@SpringBootApplication\npublic class HelloApp {\n\n    public static void main(String[] args) {\n        SpringApplication.run(HelloApp.class,args);\n    }\n}\n\n~~~\n\n@SpringBootApplication注解标识了HelloApp为启动类，也是Spring Boot的核心。\n\n**第四步：** 运行启动类的main方法\n\n![image20210523173712142.png](https://static.mszlu.com/dc17b43e-08df-46b0-bb7a-eb73044de7da.png)\n\n看到如上配置，证明启动成功，tomcat端口号默认为8080。\n\n**第五步：**  如果想要修改端口号，可以在resources目录下新建application.properties\n\n~~~properties\nserver.port=8082\n~~~\n\n**第六步：** 重新运行\n\n![image20210523174011613.png](https://static.mszlu.com/318e4b7e-95d2-4e43-a18f-279ea6ff9495.png)\n\n此时的项目结构为：\n\n![image20210523174032053.png](https://static.mszlu.com/756e4ae0-c4c7-43a5-9b5d-bc7ce974a942.png)\n\n**src/main/java :**  编写java代码，注意启动类需要放在项目的根包下。\n\n**src/main/resources:**  放置资源的目录，比如springboot的配置文件，静态文件，mybatis配置，日志配置等。\n\n**src/test/java:**  测试代码\n\n## 2.2 编写一个Http接口\n\n**第一步：**  创建`HelloController`类，内容如下：\n\n~~~java\npackage com.xiaopizhu.springboot.controller;\n\nimport org.springframework.web.bind.annotation.GetMapping;\nimport org.springframework.web.bind.annotation.RequestMapping;\nimport org.springframework.web.bind.annotation.RestController;\n\n@RestController\n@RequestMapping(\"hello\")\npublic class HelloController {\n\n    @GetMapping(\"boot\")\n    public String hello(){\n        return \"hello spring boot\";\n    }\n\n}\n\n~~~\n\n**注意包名，必须在启动类所在的包名下。**\n\n**第二步： ** 重启程序，使用postman或者直接在浏览器输入http://localhost:8082/hello/boot\n\n得到结果：hello spring boot\n\n## 2.3 编写单元测试用例\n\n**第一步： ** 添加spring boot测试依赖\n\n~~~xml\n		&lt;dependency&gt;\n            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\n            &lt;artifactId&gt;spring-boot-starter-test&lt;/artifactId&gt;\n            &lt;scope&gt;test&lt;/scope&gt;\n        &lt;/dependency&gt;\n~~~\n\n**第二步：** 在src/test 下，编写测试用例\n\n~~~java\npackage com.xiaopizhu.springboot.controller;\n\nimport org.junit.jupiter.api.BeforeAll;\nimport org.junit.jupiter.api.BeforeEach;\nimport org.junit.jupiter.api.Test;\nimport org.springframework.boot.test.context.SpringBootTest;\nimport org.springframework.http.MediaType;\nimport org.springframework.test.web.servlet.MockMvc;\nimport org.springframework.test.web.servlet.request.MockMvcRequestBuilders;\nimport org.springframework.test.web.servlet.setup.MockMvcBuilders;\n\nimport static org.hamcrest.Matchers.equalTo;\nimport static org.springframework.test.web.servlet.result.MockMvcResultMatchers.content;\nimport static org.springframework.test.web.servlet.result.MockMvcResultMatchers.status;\n\n@SpringBootTest\npublic class TestHelloController {\n\n    private MockMvc mockMvc;\n\n    @BeforeEach\n    public void beforeEach(){\n        mockMvc = MockMvcBuilders.standaloneSetup(new HelloController()).build();\n    }\n    @Test\n    public void testHello() throws Exception {\n        mockMvc.perform(MockMvcRequestBuilders.get(\"/hello/boot\")\n                .accept(MediaType.APPLICATION_JSON))\n                .andExpect(status().isOk())\n                .andExpect(content().string(equalTo(\"hello spring boot\")));\n    }\n}\n\n~~~\n\n上面的测试用例，是构建一个空的`WebApplicationContext`，并且在before中加载了HelloController，得以在测试用例中mock调用，模拟请求。\n\n## 2.4 打包为jar运行\n\n**第一步：** 添加打包(maven构建springboot)插件\n\n~~~xml\n  &lt;build&gt;\n        &lt;plugins&gt;\n            &lt;plugin&gt;\n                &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\n                &lt;artifactId&gt;spring-boot-maven-plugin&lt;/artifactId&gt;\n            &lt;/plugin&gt;\n        &lt;/plugins&gt;\n    &lt;/build&gt;\n~~~\n\n在idea的右侧 maven中，使用package来打包程序，打包完成后，在target目录下生成helloSpringBoot-1.0-SNAPSHOT.jar\n\n![image20210523181737720.png](https://static.mszlu.com/45aa0db2-598f-4564-964c-a2d889dfbafe.png)\n\n**第二步： ** 打开cmd：找到jar对应的目录\n\n输入命令\n\n~~~shell\njava -jar helloSpringBoot-1.0-SNAPSHOT.jar\n~~~\n\n![image20210523182426404.png](https://static.mszlu.com/74376f77-b8eb-4c2c-a4cc-d3bfe24901e3.png)\n\n**第三步：**  测试，使用postman或者直接在浏览器输入http://localhost:8082/hello/boot\n\n得到结果：hello spring boot\n\n## 2.5 查看jar包内容\n\n~~~shell\njar tvf helloSpringBoot-1.0-SNAPSHOT.jar\n~~~\n\n# 3. 小结\n\n1. 通过Maven构建了一个空白Spring Boot项目，再通过引入web模块实现了一个简单的请求处理。\n2. 通过修改配置文件，更改端口号\n3. 编写了测试用例\n4. 打包jar包运行\n\n'</span>, <span class="string">'&lt;h1&gt;&lt;a id=\"1_Spring_Boot_0\"&gt;&lt;/a&gt;1. Spring Boot介绍&lt;/h1&gt;\n&lt;h2&gt;&lt;a id=\"11__2\"&gt;&lt;/a&gt;1.1 简介&lt;/h2&gt;\n&lt;p&gt;在您第1次接触和学习Spring框架的时候，是否因为其繁杂的配置而退却了？&lt;/p&gt;\n&lt;p&gt;在你第n次使用Spring框架的时候，是否觉得一堆反复黏贴的配置有一些厌烦？&lt;/p&gt;\n&lt;p&gt;那么您就不妨来试试使用Spring Boot来让你更易上手，更简单快捷地构建Spring应用！&lt;/p&gt;\n&lt;p&gt;Spring Boot让我们的Spring应用变的更轻量化。&lt;/p&gt;\n&lt;p&gt;我们不必像以前那样繁琐的构建项目、打包应用、部署到Tomcat等应用服务器中来运行我们的业务服务。&lt;/p&gt;\n&lt;p&gt;通过Spring Boot实现的服务，只需要依靠一个Java类，把它打包成jar，并通过&lt;code&gt;java -jar&lt;/code&gt;命令就可以运行起来。&lt;/p&gt;\n&lt;p&gt;这一切相较于传统Spring应用来说，已经变得非常的轻便、简单。&lt;/p&gt;\n&lt;p&gt;&lt;strong&gt;总结一下Spring Boot的主要优点：&lt;/strong&gt;&lt;/p&gt;\n&lt;ol&gt;\n&lt;li&gt;为所有Spring开发者更快的入门&lt;/li&gt;\n&lt;li&gt;开箱即用，提供各种默认配置来简化项目配置&lt;/li&gt;\n&lt;li&gt;内嵌式容器简化Web项目&lt;/li&gt;\n&lt;li&gt;没有冗余代码生成和XML配置的要求&lt;/li&gt;\n&lt;li&gt;统一的依赖管理&lt;/li&gt;\n&lt;li&gt;自动装配，更易使用，更易扩展&lt;/li&gt;\n&lt;/ol&gt;\n&lt;h2&gt;&lt;a id=\"12__27\"&gt;&lt;/a&gt;1.2 使用版本说明&lt;/h2&gt;\n&lt;p&gt;Springboot版本：使用最新的2.5.0版本&lt;/p&gt;\n&lt;p&gt;教程参考了官方文档进行制作，权威。&lt;/p&gt;\n&lt;p&gt;其他依赖版本：&lt;/p&gt;\n&lt;pre&gt;&lt;code&gt;1. Maven  需求：3.5+\n\n2. JDK 需求  8+\n3. Spring Framework 5.3.7以上版本\n4. Tomcat 9.0\n5. Servlet版本 4.0  但是可以部署到Servlet到3.1+的容器中\n&lt;/code&gt;&lt;/pre&gt;\n&lt;h1&gt;&lt;a id=\"2__42\"&gt;&lt;/a&gt;2. 快速入门&lt;/h1&gt;\n&lt;p&gt;快速的创建一个Spring Boot应用，并且实现一个简单的Http请求处理。通过这个例子对Spring Boot有一个初步的了解，并体验其结构简单、开发快速的特性。&lt;/p&gt;\n&lt;p&gt;教程使用的Idea版本：2019.3&lt;/p&gt;\n&lt;h2&gt;&lt;a id=\"21__48\"&gt;&lt;/a&gt;2.1 创建基础项目&lt;/h2&gt;\n&lt;p&gt;&lt;strong&gt;第一步：&lt;/strong&gt; 创建maven项目&lt;/p&gt;\n&lt;p&gt;pom.xml :&lt;/p&gt;\n&lt;pre&gt;&lt;div class=\"hljs\"&gt;&lt;code class=\"lang-xml\"&gt;&lt;span class=\"php\"&gt;&lt;span class=\"hljs-meta\"&gt;&amp;lt;?&lt;/span&gt;xml version=&lt;span class=\"hljs-string\"&gt;\"1.0\"&lt;/span&gt; encoding=&lt;span class=\"hljs-string\"&gt;\"UTF-8\"&lt;/span&gt;&lt;span class=\"hljs-meta\"&gt;?&amp;gt;&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\"hljs-tag\"&gt;&amp;lt;&lt;span class=\"hljs-name\"&gt;project&lt;/span&gt; &lt;span class=\"hljs-attr\"&gt;xmlns&lt;/span&gt;=&lt;span class=\"hljs-string\"&gt;\"http://maven.apache.org/POM/4.0.0\"&lt;/span&gt;\n         &lt;span class=\"hljs-attr\"&gt;xmlns:xsi&lt;/span&gt;=&lt;span class=\"hljs-string\"&gt;\"http://www.w3.org/2001/XMLSchema-instance\"&lt;/span&gt;\n         &lt;span class=\"hljs-attr\"&gt;xsi:schemaLocation&lt;/span&gt;=&lt;span class=\"hljs-string\"&gt;\"http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd\"&lt;/span&gt;&amp;gt;&lt;/span&gt;\n    &lt;span class=\"hljs-tag\"&gt;&amp;lt;&lt;span class=\"hljs-name\"&gt;modelVersion&lt;/span&gt;&amp;gt;&lt;/span&gt;4.0.0&lt;span class=\"hljs-tag\"&gt;&amp;lt;/&lt;span class=\"hljs-name\"&gt;modelVersion&lt;/span&gt;&amp;gt;&lt;/span&gt;\n\n    &lt;span class=\"hljs-tag\"&gt;&amp;lt;&lt;span class=\"hljs-name\"&gt;groupId&lt;/span&gt;&amp;gt;&lt;/span&gt;com.xiaopizhu&lt;span class=\"hljs-tag\"&gt;&amp;lt;/&lt;span class=\"hljs-name\"&gt;groupId&lt;/span&gt;&amp;gt;&lt;/span&gt;\n    &lt;span class=\"hljs-tag\"&gt;&amp;lt;&lt;span class=\"hljs-name\"&gt;artifactId&lt;/span&gt;&amp;gt;&lt;/span&gt;helloSpringBoot&lt;span class=\"hljs-tag\"&gt;&amp;lt;/&lt;span class=\"hljs-name\"&gt;artifactId&lt;/span&gt;&amp;gt;&lt;/span&gt;\n    &lt;span class=\"hljs-tag\"&gt;&amp;lt;&lt;span class=\"hljs-name\"&gt;version&lt;/span&gt;&amp;gt;&lt;/span&gt;1.0-SNAPSHOT&lt;span class=\"hljs-tag\"&gt;&amp;lt;/&lt;span class=\"hljs-name\"&gt;version&lt;/span&gt;&amp;gt;&lt;/span&gt;\n	&lt;span class=\"hljs-comment\"&gt;&amp;lt;!--springboot的父工程其中定义了常用的依赖，并且无依赖冲突--&amp;gt;&lt;/span&gt;\n    &lt;span class=\"hljs-tag\"&gt;&amp;lt;&lt;span class=\"hljs-name\"&gt;parent&lt;/span&gt;&amp;gt;&lt;/span&gt;\n        &lt;span class=\"hljs-tag\"&gt;&amp;lt;&lt;span class=\"hljs-name\"&gt;groupId&lt;/span&gt;&amp;gt;&lt;/span&gt;org.springframework.boot&lt;span class=\"hljs-tag\"&gt;&amp;lt;/&lt;span class=\"hljs-name\"&gt;groupId&lt;/span&gt;&amp;gt;&lt;/span&gt;\n        &lt;span class=\"hljs-tag\"&gt;&amp;lt;&lt;span class=\"hljs-name\"&gt;artifactId&lt;/span&gt;&amp;gt;&lt;/span&gt;spring-boot-starter-parent&lt;span class=\"hljs-tag\"&gt;&amp;lt;/&lt;span class=\"hljs-name\"&gt;artifactId&lt;/span&gt;&amp;gt;&lt;/span&gt;\n        &lt;span class=\"hljs-tag\"&gt;&amp;lt;&lt;span class=\"hljs-name\"&gt;version&lt;/span&gt;&amp;gt;&lt;/span&gt;2.5.0&lt;span class=\"hljs-tag\"&gt;&amp;lt;/&lt;span class=\"hljs-name\"&gt;version&lt;/span&gt;&amp;gt;&lt;/span&gt;\n    &lt;span class=\"hljs-tag\"&gt;&amp;lt;/&lt;span class=\"hljs-name\"&gt;parent&lt;/span&gt;&amp;gt;&lt;/span&gt;\n&lt;span class=\"hljs-tag\"&gt;&amp;lt;/&lt;span class=\"hljs-name\"&gt;project&lt;/span&gt;&amp;gt;&lt;/span&gt;\n&lt;/code&gt;&lt;/div&gt;&lt;/pre&gt;\n&lt;p&gt;注意上方的parent必须加，其中定义了springboot官方支持的n多依赖，基本上常用的已经有了，所以接下来导入依赖的时候，绝大部分都可以不加版本号。&lt;/p&gt;\n&lt;p&gt;此时的工程结构为：&lt;/p&gt;\n&lt;p&gt;&lt;img src=\"https://static.mszlu.com/a7302c88-e106-46ad-9713-dc9a6d523957.png\" alt=\"image20210523173241557.png\" /&gt;&lt;/p&gt;\n&lt;p&gt;&lt;strong&gt;第二步：&lt;/strong&gt; 添加web依赖&lt;/p&gt;\n&lt;pre&gt;&lt;div class=\"hljs\"&gt;&lt;code class=\"lang-xml\"&gt;&lt;span class=\"hljs-tag\"&gt;&amp;lt;&lt;span class=\"hljs-name\"&gt;dependencies&lt;/span&gt;&amp;gt;&lt;/span&gt;\n    &lt;span class=\"hljs-tag\"&gt;&amp;lt;&lt;span class=\"hljs-name\"&gt;dependency&lt;/span&gt;&amp;gt;&lt;/span&gt;\n        &lt;span class=\"hljs-tag\"&gt;&amp;lt;&lt;span class=\"hljs-name\"&gt;groupId&lt;/span&gt;&amp;gt;&lt;/span&gt;org.springframework.boot&lt;span class=\"hljs-tag\"&gt;&amp;lt;/&lt;span class=\"hljs-name\"&gt;groupId&lt;/span&gt;&amp;gt;&lt;/span&gt;\n        &lt;span class=\"hljs-tag\"&gt;&amp;lt;&lt;span class=\"hljs-name\"&gt;artifactId&lt;/span&gt;&amp;gt;&lt;/span&gt;spring-boot-starter-web&lt;span class=\"hljs-tag\"&gt;&amp;lt;/&lt;span class=\"hljs-name\"&gt;artifactId&lt;/span&gt;&amp;gt;&lt;/span&gt;\n    &lt;span class=\"hljs-tag\"&gt;&amp;lt;/&lt;span class=\"hljs-name\"&gt;dependency&lt;/span&gt;&amp;gt;&lt;/span&gt;\n&lt;span class=\"hljs-tag\"&gt;&amp;lt;/&lt;span class=\"hljs-name\"&gt;dependencies&lt;/span&gt;&amp;gt;&lt;/span&gt;\n&lt;/code&gt;&lt;/div&gt;&lt;/pre&gt;\n&lt;p&gt;添加上方的web依赖，其中间接依赖了spring-web，spring-webmvc，spring-core等spring和springmvc的包，并且集成了tomcat。&lt;/p&gt;\n&lt;p&gt;&lt;strong&gt;第三步：&lt;/strong&gt; 编写启动类&lt;/p&gt;\n&lt;pre&gt;&lt;div class=\"hljs\"&gt;&lt;code class=\"lang-java\"&gt;&lt;span class=\"hljs-keyword\"&gt;package&lt;/span&gt; com.xiaopizhu.springboot;\n\n&lt;span class=\"hljs-keyword\"&gt;import&lt;/span&gt; org.springframework.boot.SpringApplication;\n&lt;span class=\"hljs-keyword\"&gt;import&lt;/span&gt; org.springframework.boot.autoconfigure.SpringBootApplication;\n\n&lt;span class=\"hljs-meta\"&gt;@SpringBootApplication&lt;/span&gt;\n&lt;span class=\"hljs-keyword\"&gt;public&lt;/span&gt; &lt;span class=\"hljs-class\"&gt;&lt;span class=\"hljs-keyword\"&gt;class&lt;/span&gt; &lt;span class=\"hljs-title\"&gt;HelloApp&lt;/span&gt; &lt;/span&gt;{\n\n    &lt;span class=\"hljs-function\"&gt;&lt;span class=\"hljs-keyword\"&gt;public&lt;/span&gt; &lt;span class=\"hljs-keyword\"&gt;static&lt;/span&gt; &lt;span class=\"hljs-keyword\"&gt;void&lt;/span&gt; &lt;span class=\"hljs-title\"&gt;main&lt;/span&gt;&lt;span class=\"hljs-params\"&gt;(String[] args)&lt;/span&gt; &lt;/span&gt;{\n        SpringApplication.run(HelloApp.class,args);\n    }\n}\n\n&lt;/code&gt;&lt;/div&gt;&lt;/pre&gt;\n&lt;p&gt;@SpringBootApplication注解标识了HelloApp为启动类，也是Spring Boot的核心。&lt;/p&gt;\n&lt;p&gt;&lt;strong&gt;第四步：&lt;/strong&gt; 运行启动类的main方法&lt;/p&gt;\n&lt;p&gt;&lt;img src=\"https://static.mszlu.com/dc17b43e-08df-46b0-bb7a-eb73044de7da.png\" alt=\"image20210523173712142.png\" /&gt;&lt;/p&gt;\n&lt;p&gt;看到如上配置，证明启动成功，tomcat端口号默认为8080。&lt;/p&gt;\n&lt;p&gt;&lt;strong&gt;第五步：&lt;/strong&gt;  如果想要修改端口号，可以在resources目录下新建application.properties&lt;/p&gt;\n&lt;pre&gt;&lt;code class=\"lang-properties\"&gt;server.port=8082\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;&lt;strong&gt;第六步：&lt;/strong&gt; 重新运行&lt;/p&gt;\n&lt;p&gt;&lt;img src=\"https://static.mszlu.com/318e4b7e-95d2-4e43-a18f-279ea6ff9495.png\" alt=\"image20210523174011613.png\" /&gt;&lt;/p&gt;\n&lt;p&gt;此时的项目结构为：&lt;/p&gt;\n&lt;p&gt;&lt;img src=\"https://static.mszlu.com/756e4ae0-c4c7-43a5-9b5d-bc7ce974a942.png\" alt=\"image20210523174032053.png\" /&gt;&lt;/p&gt;\n&lt;p&gt;&lt;strong&gt;src/main/java :&lt;/strong&gt;  编写java代码，注意启动类需要放在项目的根包下。&lt;/p&gt;\n&lt;p&gt;&lt;strong&gt;src/main/resources:&lt;/strong&gt;  放置资源的目录，比如springboot的配置文件，静态文件，mybatis配置，日志配置等。&lt;/p&gt;\n&lt;p&gt;&lt;strong&gt;src/test/java:&lt;/strong&gt;  测试代码&lt;/p&gt;\n&lt;h2&gt;&lt;a id=\"22_Http_138\"&gt;&lt;/a&gt;2.2 编写一个Http接口&lt;/h2&gt;\n&lt;p&gt;&lt;strong&gt;第一步：&lt;/strong&gt;  创建&lt;code&gt;HelloController&lt;/code&gt;类，内容如下：&lt;/p&gt;\n&lt;pre&gt;&lt;div class=\"hljs\"&gt;&lt;code class=\"lang-java\"&gt;&lt;span class=\"hljs-keyword\"&gt;package&lt;/span&gt; com.xiaopizhu.springboot.controller;\n\n&lt;span class=\"hljs-keyword\"&gt;import&lt;/span&gt; org.springframework.web.bind.annotation.GetMapping;\n&lt;span class=\"hljs-keyword\"&gt;import&lt;/span&gt; org.springframework.web.bind.annotation.RequestMapping;\n&lt;span class=\"hljs-keyword\"&gt;import&lt;/span&gt; org.springframework.web.bind.annotation.RestController;\n\n&lt;span class=\"hljs-meta\"&gt;@RestController&lt;/span&gt;\n&lt;span class=\"hljs-meta\"&gt;@RequestMapping&lt;/span&gt;(&lt;span class=\"hljs-string\"&gt;\"hello\"&lt;/span&gt;)\n&lt;span class=\"hljs-keyword\"&gt;public&lt;/span&gt; &lt;span class=\"hljs-class\"&gt;&lt;span class=\"hljs-keyword\"&gt;class&lt;/span&gt; &lt;span class=\"hljs-title\"&gt;HelloController&lt;/span&gt; &lt;/span&gt;{\n\n    &lt;span class=\"hljs-meta\"&gt;@GetMapping&lt;/span&gt;(&lt;span class=\"hljs-string\"&gt;\"boot\"&lt;/span&gt;)\n    &lt;span class=\"hljs-function\"&gt;&lt;span class=\"hljs-keyword\"&gt;public&lt;/span&gt; String &lt;span class=\"hljs-title\"&gt;hello&lt;/span&gt;&lt;span class=\"hljs-params\"&gt;()&lt;/span&gt;&lt;/span&gt;{\n        &lt;span class=\"hljs-keyword\"&gt;return&lt;/span&gt; &lt;span class=\"hljs-string\"&gt;\"hello spring boot\"&lt;/span&gt;;\n    }\n\n}\n\n&lt;/code&gt;&lt;/div&gt;&lt;/pre&gt;\n&lt;p&gt;&lt;strong&gt;注意包名，必须在启动类所在的包名下。&lt;/strong&gt;&lt;/p&gt;\n&lt;p&gt;**第二步： ** 重启程序，使用postman或者直接在浏览器输入http://localhost:8082/hello/boot&lt;/p&gt;\n&lt;p&gt;得到结果：hello spring boot&lt;/p&gt;\n&lt;h2&gt;&lt;a id=\"23__168\"&gt;&lt;/a&gt;2.3 编写单元测试用例&lt;/h2&gt;\n&lt;p&gt;**第一步： ** 添加spring boot测试依赖&lt;/p&gt;\n&lt;pre&gt;&lt;div class=\"hljs\"&gt;&lt;code class=\"lang-xml\"&gt;		&lt;span class=\"hljs-tag\"&gt;&amp;lt;&lt;span class=\"hljs-name\"&gt;dependency&lt;/span&gt;&amp;gt;&lt;/span&gt;\n            &lt;span class=\"hljs-tag\"&gt;&amp;lt;&lt;span class=\"hljs-name\"&gt;groupId&lt;/span&gt;&amp;gt;&lt;/span&gt;org.springframework.boot&lt;span class=\"hljs-tag\"&gt;&amp;lt;/&lt;span class=\"hljs-name\"&gt;groupId&lt;/span&gt;&amp;gt;&lt;/span&gt;\n            &lt;span class=\"hljs-tag\"&gt;&amp;lt;&lt;span class=\"hljs-name\"&gt;artifactId&lt;/span&gt;&amp;gt;&lt;/span&gt;spring-boot-starter-test&lt;span class=\"hljs-tag\"&gt;&amp;lt;/&lt;span class=\"hljs-name\"&gt;artifactId&lt;/span&gt;&amp;gt;&lt;/span&gt;\n            &lt;span class=\"hljs-tag\"&gt;&amp;lt;&lt;span class=\"hljs-name\"&gt;scope&lt;/span&gt;&amp;gt;&lt;/span&gt;test&lt;span class=\"hljs-tag\"&gt;&amp;lt;/&lt;span class=\"hljs-name\"&gt;scope&lt;/span&gt;&amp;gt;&lt;/span&gt;\n        &lt;span class=\"hljs-tag\"&gt;&amp;lt;/&lt;span class=\"hljs-name\"&gt;dependency&lt;/span&gt;&amp;gt;&lt;/span&gt;\n&lt;/code&gt;&lt;/div&gt;&lt;/pre&gt;\n&lt;p&gt;&lt;strong&gt;第二步：&lt;/strong&gt; 在src/test 下，编写测试用例&lt;/p&gt;\n&lt;pre&gt;&lt;div class=\"hljs\"&gt;&lt;code class=\"lang-java\"&gt;&lt;span class=\"hljs-keyword\"&gt;package&lt;/span&gt; com.xiaopizhu.springboot.controller;\n\n&lt;span class=\"hljs-keyword\"&gt;import&lt;/span&gt; org.junit.jupiter.api.BeforeAll;\n&lt;span class=\"hljs-keyword\"&gt;import&lt;/span&gt; org.junit.jupiter.api.BeforeEach;\n&lt;span class=\"hljs-keyword\"&gt;import&lt;/span&gt; org.junit.jupiter.api.Test;\n&lt;span class=\"hljs-keyword\"&gt;import&lt;/span&gt; org.springframework.boot.test.context.SpringBootTest;\n&lt;span class=\"hljs-keyword\"&gt;import&lt;/span&gt; org.springframework.http.MediaType;\n&lt;span class=\"hljs-keyword\"&gt;import&lt;/span&gt; org.springframework.test.web.servlet.MockMvc;\n&lt;span class=\"hljs-keyword\"&gt;import&lt;/span&gt; org.springframework.test.web.servlet.request.MockMvcRequestBuilders;\n&lt;span class=\"hljs-keyword\"&gt;import&lt;/span&gt; org.springframework.test.web.servlet.setup.MockMvcBuilders;\n\n&lt;span class=\"hljs-keyword\"&gt;import&lt;/span&gt; &lt;span class=\"hljs-keyword\"&gt;static&lt;/span&gt; org.hamcrest.Matchers.equalTo;\n&lt;span class=\"hljs-keyword\"&gt;import&lt;/span&gt; &lt;span class=\"hljs-keyword\"&gt;static&lt;/span&gt; org.springframework.test.web.servlet.result.MockMvcResultMatchers.content;\n&lt;span class=\"hljs-keyword\"&gt;import&lt;/span&gt; &lt;span class=\"hljs-keyword\"&gt;static&lt;/span&gt; org.springframework.test.web.servlet.result.MockMvcResultMatchers.status;\n\n&lt;span class=\"hljs-meta\"&gt;@SpringBootTest&lt;/span&gt;\n&lt;span class=\"hljs-keyword\"&gt;public&lt;/span&gt; &lt;span class=\"hljs-class\"&gt;&lt;span class=\"hljs-keyword\"&gt;class&lt;/span&gt; &lt;span class=\"hljs-title\"&gt;TestHelloController&lt;/span&gt; &lt;/span&gt;{\n\n    &lt;span class=\"hljs-keyword\"&gt;private&lt;/span&gt; MockMvc mockMvc;\n\n    &lt;span class=\"hljs-meta\"&gt;@BeforeEach&lt;/span&gt;\n    &lt;span class=\"hljs-function\"&gt;&lt;span class=\"hljs-keyword\"&gt;public&lt;/span&gt; &lt;span class=\"hljs-keyword\"&gt;void&lt;/span&gt; &lt;span class=\"hljs-title\"&gt;beforeEach&lt;/span&gt;&lt;span class=\"hljs-params\"&gt;()&lt;/span&gt;&lt;/span&gt;{\n        mockMvc = MockMvcBuilders.standaloneSetup(&lt;span class=\"hljs-keyword\"&gt;new&lt;/span&gt; HelloController()).build();\n    }\n    &lt;span class=\"hljs-meta\"&gt;@Test&lt;/span&gt;\n    &lt;span class=\"hljs-function\"&gt;&lt;span class=\"hljs-keyword\"&gt;public&lt;/span&gt; &lt;span class=\"hljs-keyword\"&gt;void&lt;/span&gt; &lt;span class=\"hljs-title\"&gt;testHello&lt;/span&gt;&lt;span class=\"hljs-params\"&gt;()&lt;/span&gt; &lt;span class=\"hljs-keyword\"&gt;throws&lt;/span&gt; Exception &lt;/span&gt;{\n        mockMvc.perform(MockMvcRequestBuilders.get(&lt;span class=\"hljs-string\"&gt;\"/hello/boot\"&lt;/span&gt;)\n                .accept(MediaType.APPLICATION_JSON))\n                .andExpect(status().isOk())\n                .andExpect(content().string(equalTo(&lt;span class=\"hljs-string\"&gt;\"hello spring boot\"&lt;/span&gt;)));\n    }\n}\n\n&lt;/code&gt;&lt;/div&gt;&lt;/pre&gt;\n&lt;p&gt;上面的测试用例，是构建一个空的&lt;code&gt;WebApplicationContext&lt;/code&gt;，并且在before中加载了HelloController，得以在测试用例中mock调用，模拟请求。&lt;/p&gt;\n&lt;h2&gt;&lt;a id=\"24_jar_220\"&gt;&lt;/a&gt;2.4 打包为jar运行&lt;/h2&gt;\n&lt;p&gt;&lt;strong&gt;第一步：&lt;/strong&gt; 添加打包(maven构建springboot)插件&lt;/p&gt;\n&lt;pre&gt;&lt;div class=\"hljs\"&gt;&lt;code class=\"lang-xml\"&gt;  &lt;span class=\"hljs-tag\"&gt;&amp;lt;&lt;span class=\"hljs-name\"&gt;build&lt;/span&gt;&amp;gt;&lt;/span&gt;\n        &lt;span class=\"hljs-tag\"&gt;&amp;lt;&lt;span class=\"hljs-name\"&gt;plugins&lt;/span&gt;&amp;gt;&lt;/span&gt;\n            &lt;span class=\"hljs-tag\"&gt;&amp;lt;&lt;span class=\"hljs-name\"&gt;plugin&lt;/span&gt;&amp;gt;&lt;/span&gt;\n                &lt;span class=\"hljs-tag\"&gt;&amp;lt;&lt;span class=\"hljs-name\"&gt;groupId&lt;/span&gt;&amp;gt;&lt;/span&gt;org.springframework.boot&lt;span class=\"hljs-tag\"&gt;&amp;lt;/&lt;span class=\"hljs-name\"&gt;groupId&lt;/span&gt;&amp;gt;&lt;/span&gt;\n                &lt;span class=\"hljs-tag\"&gt;&amp;lt;&lt;span class=\"hljs-name\"&gt;artifactId&lt;/span&gt;&amp;gt;&lt;/span&gt;spring-boot-maven-plugin&lt;span class=\"hljs-tag\"&gt;&amp;lt;/&lt;span class=\"hljs-name\"&gt;artifactId&lt;/span&gt;&amp;gt;&lt;/span&gt;\n            &lt;span class=\"hljs-tag\"&gt;&amp;lt;/&lt;span class=\"hljs-name\"&gt;plugin&lt;/span&gt;&amp;gt;&lt;/span&gt;\n        &lt;span class=\"hljs-tag\"&gt;&amp;lt;/&lt;span class=\"hljs-name\"&gt;plugins&lt;/span&gt;&amp;gt;&lt;/span&gt;\n    &lt;span class=\"hljs-tag\"&gt;&amp;lt;/&lt;span class=\"hljs-name\"&gt;build&lt;/span&gt;&amp;gt;&lt;/span&gt;\n&lt;/code&gt;&lt;/div&gt;&lt;/pre&gt;\n&lt;p&gt;在idea的右侧 maven中，使用package来打包程序，打包完成后，在target目录下生成helloSpringBoot-1.0-SNAPSHOT.jar&lt;/p&gt;\n&lt;p&gt;&lt;img src=\"https://static.mszlu.com/45aa0db2-598f-4564-964c-a2d889dfbafe.png\" alt=\"image20210523181737720.png\" /&gt;&lt;/p&gt;\n&lt;p&gt;**第二步： ** 打开cmd：找到jar对应的目录&lt;/p&gt;\n&lt;p&gt;输入命令&lt;/p&gt;\n&lt;pre&gt;&lt;div class=\"hljs\"&gt;&lt;code class=\"lang-shell\"&gt;java -jar helloSpringBoot-1.0-SNAPSHOT.jar\n&lt;/code&gt;&lt;/div&gt;&lt;/pre&gt;\n&lt;p&gt;&lt;img src=\"https://static.mszlu.com/74376f77-b8eb-4c2c-a4cc-d3bfe24901e3.png\" alt=\"image20210523182426404.png\" /&gt;&lt;/p&gt;\n&lt;p&gt;&lt;strong&gt;第三步：&lt;/strong&gt;  测试，使用postman或者直接在浏览器输入http://localhost:8082/hello/boot&lt;/p&gt;\n&lt;p&gt;得到结果：hello spring boot&lt;/p&gt;\n&lt;h2&gt;&lt;a id=\"25_jar_253\"&gt;&lt;/a&gt;2.5 查看jar包内容&lt;/h2&gt;\n&lt;pre&gt;&lt;div class=\"hljs\"&gt;&lt;code class=\"lang-shell\"&gt;jar tvf helloSpringBoot-1.0-SNAPSHOT.jar\n&lt;/code&gt;&lt;/div&gt;&lt;/pre&gt;\n&lt;h1&gt;&lt;a id=\"3__259\"&gt;&lt;/a&gt;3. 小结&lt;/h1&gt;\n&lt;ol&gt;\n&lt;li&gt;通过Maven构建了一个空白Spring Boot项目，再通过引入web模块实现了一个简单的请求处理。&lt;/li&gt;\n&lt;li&gt;通过修改配置文件，更改端口号&lt;/li&gt;\n&lt;li&gt;编写了测试用例&lt;/li&gt;\n&lt;li&gt;打包jar包运行&lt;/li&gt;\n&lt;/ol&gt;\n'</span>, <span class="number">1405916999732707330</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">-- ----------------------------</span></span><br><span class="line"><span class="comment">-- Table structure for ms_article_tag</span></span><br><span class="line"><span class="comment">-- ----------------------------</span></span><br><span class="line"><span class="keyword">DROP</span> <span class="keyword">TABLE</span> IF <span class="keyword">EXISTS</span> `ms_article_tag`;</span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> `ms_article_tag`  (</span><br><span class="line">  `id` <span class="type">bigint</span>(<span class="number">0</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span> AUTO_INCREMENT,</span><br><span class="line">  `article_id` <span class="type">bigint</span>(<span class="number">0</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span>,</span><br><span class="line">  `tag_id` <span class="type">bigint</span>(<span class="number">0</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span>,</span><br><span class="line">  <span class="keyword">PRIMARY</span> KEY (`id`) <span class="keyword">USING</span> BTREE,</span><br><span class="line">  INDEX `article_id`(`article_id`) <span class="keyword">USING</span> BTREE,</span><br><span class="line">  INDEX `tag_id`(`tag_id`) <span class="keyword">USING</span> BTREE</span><br><span class="line">) ENGINE <span class="operator">=</span> InnoDB AUTO_INCREMENT <span class="operator">=</span> <span class="number">1405916999787233282</span> <span class="type">CHARACTER</span> <span class="keyword">SET</span> <span class="operator">=</span> utf8 <span class="keyword">COLLATE</span> <span class="operator">=</span> utf8_general_ci ROW_FORMAT <span class="operator">=</span> <span class="keyword">Dynamic</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- ----------------------------</span></span><br><span class="line"><span class="comment">-- Records of ms_article_tag</span></span><br><span class="line"><span class="comment">-- ----------------------------</span></span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `ms_article_tag` <span class="keyword">VALUES</span> (<span class="number">1</span>, <span class="number">1</span>, <span class="number">7</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `ms_article_tag` <span class="keyword">VALUES</span> (<span class="number">2</span>, <span class="number">1</span>, <span class="number">5</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `ms_article_tag` <span class="keyword">VALUES</span> (<span class="number">3</span>, <span class="number">1</span>, <span class="number">8</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `ms_article_tag` <span class="keyword">VALUES</span> (<span class="number">4</span>, <span class="number">9</span>, <span class="number">7</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `ms_article_tag` <span class="keyword">VALUES</span> (<span class="number">5</span>, <span class="number">10</span>, <span class="number">7</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `ms_article_tag` <span class="keyword">VALUES</span> (<span class="number">6</span>, <span class="number">10</span>, <span class="number">8</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `ms_article_tag` <span class="keyword">VALUES</span> (<span class="number">7</span>, <span class="number">10</span>, <span class="number">5</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `ms_article_tag` <span class="keyword">VALUES</span> (<span class="number">8</span>, <span class="number">10</span>, <span class="number">6</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `ms_article_tag` <span class="keyword">VALUES</span> (<span class="number">1405564731321802753</span>, <span class="number">1405564731300831233</span>, <span class="number">5</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `ms_article_tag` <span class="keyword">VALUES</span> (<span class="number">1405909844761800706</span>, <span class="number">1405909844724051969</span>, <span class="number">5</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `ms_article_tag` <span class="keyword">VALUES</span> (<span class="number">1405916999787233281</span>, <span class="number">1405916999732707330</span>, <span class="number">5</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">-- ----------------------------</span></span><br><span class="line"><span class="comment">-- Table structure for ms_category</span></span><br><span class="line"><span class="comment">-- ----------------------------</span></span><br><span class="line"><span class="keyword">DROP</span> <span class="keyword">TABLE</span> IF <span class="keyword">EXISTS</span> `ms_category`;</span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> `ms_category`  (</span><br><span class="line">  `id` <span class="type">bigint</span>(<span class="number">0</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span> AUTO_INCREMENT,</span><br><span class="line">  `avatar` <span class="type">varchar</span>(<span class="number">255</span>) <span class="type">CHARACTER</span> <span class="keyword">SET</span> utf8mb4 <span class="keyword">COLLATE</span> utf8mb4_unicode_ci <span class="keyword">NULL</span> <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span>,</span><br><span class="line">  `category_name` <span class="type">varchar</span>(<span class="number">255</span>) <span class="type">CHARACTER</span> <span class="keyword">SET</span> utf8mb4 <span class="keyword">COLLATE</span> utf8mb4_unicode_ci <span class="keyword">NULL</span> <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span>,</span><br><span class="line">  `description` <span class="type">varchar</span>(<span class="number">255</span>) <span class="type">CHARACTER</span> <span class="keyword">SET</span> utf8mb4 <span class="keyword">COLLATE</span> utf8mb4_unicode_ci <span class="keyword">NULL</span> <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span>,</span><br><span class="line">  <span class="keyword">PRIMARY</span> KEY (`id`) <span class="keyword">USING</span> BTREE</span><br><span class="line">) ENGINE <span class="operator">=</span> InnoDB AUTO_INCREMENT <span class="operator">=</span> <span class="number">6</span> <span class="type">CHARACTER</span> <span class="keyword">SET</span> <span class="operator">=</span> utf8 <span class="keyword">COLLATE</span> <span class="operator">=</span> utf8_general_ci ROW_FORMAT <span class="operator">=</span> <span class="keyword">Dynamic</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- ----------------------------</span></span><br><span class="line"><span class="comment">-- Records of ms_category</span></span><br><span class="line"><span class="comment">-- ----------------------------</span></span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `ms_category` <span class="keyword">VALUES</span> (<span class="number">1</span>, <span class="string">'/static/category/front.png'</span>, <span class="string">'前端'</span>, <span class="string">'前端是什么，大前端'</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `ms_category` <span class="keyword">VALUES</span> (<span class="number">2</span>, <span class="string">'/static/category/back.png'</span>, <span class="string">'后端'</span>, <span class="string">'后端最牛叉'</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `ms_category` <span class="keyword">VALUES</span> (<span class="number">3</span>, <span class="string">'/static/category/lift.jpg'</span>, <span class="string">'生活'</span>, <span class="string">'生活趣事'</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `ms_category` <span class="keyword">VALUES</span> (<span class="number">4</span>, <span class="string">'/static/category/database.png'</span>, <span class="string">'数据库'</span>, <span class="string">'没数据库，啥也不管用'</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `ms_category` <span class="keyword">VALUES</span> (<span class="number">5</span>, <span class="string">'/static/category/language.png'</span>, <span class="string">'编程语言'</span>, <span class="string">'好多语言，该学哪个？'</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">-- ----------------------------</span></span><br><span class="line"><span class="comment">-- Table structure for ms_comment</span></span><br><span class="line"><span class="comment">-- ----------------------------</span></span><br><span class="line"><span class="keyword">DROP</span> <span class="keyword">TABLE</span> IF <span class="keyword">EXISTS</span> `ms_comment`;</span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> `ms_comment`  (</span><br><span class="line">  `id` <span class="type">bigint</span>(<span class="number">0</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span> AUTO_INCREMENT,</span><br><span class="line">  `content` <span class="type">varchar</span>(<span class="number">255</span>) <span class="type">CHARACTER</span> <span class="keyword">SET</span> utf8mb4 <span class="keyword">COLLATE</span> utf8mb4_unicode_ci <span class="keyword">NOT</span> <span class="keyword">NULL</span>,</span><br><span class="line">  `create_date` <span class="type">bigint</span>(<span class="number">0</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span>,</span><br><span class="line">  `article_id` <span class="type">int</span>(<span class="number">0</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span>,</span><br><span class="line">  `author_id` <span class="type">bigint</span>(<span class="number">0</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span>,</span><br><span class="line">  `parent_id` <span class="type">bigint</span>(<span class="number">0</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span>,</span><br><span class="line">  `to_uid` <span class="type">bigint</span>(<span class="number">0</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span>,</span><br><span class="line">  `level` <span class="type">varchar</span>(<span class="number">1</span>) <span class="type">CHARACTER</span> <span class="keyword">SET</span> utf8 <span class="keyword">COLLATE</span> utf8_general_ci <span class="keyword">NOT</span> <span class="keyword">NULL</span>,</span><br><span class="line">  <span class="keyword">PRIMARY</span> KEY (`id`) <span class="keyword">USING</span> BTREE,</span><br><span class="line">  INDEX `article_id`(`article_id`) <span class="keyword">USING</span> BTREE</span><br><span class="line">) ENGINE <span class="operator">=</span> InnoDB AUTO_INCREMENT <span class="operator">=</span> <span class="number">1405209691876790275</span> <span class="type">CHARACTER</span> <span class="keyword">SET</span> <span class="operator">=</span> utf8 <span class="keyword">COLLATE</span> <span class="operator">=</span> utf8_general_ci ROW_FORMAT <span class="operator">=</span> <span class="keyword">Dynamic</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- ----------------------------</span></span><br><span class="line"><span class="comment">-- Records of ms_comment</span></span><br><span class="line"><span class="comment">-- ----------------------------</span></span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `ms_comment` <span class="keyword">VALUES</span> (<span class="number">53</span>, <span class="string">'写的好'</span>, <span class="number">123213213213</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="string">'1'</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `ms_comment` <span class="keyword">VALUES</span> (<span class="number">54</span>, <span class="string">'111'</span>, <span class="number">123123123123</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">53</span>, <span class="number">1</span>, <span class="string">'2'</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `ms_comment` <span class="keyword">VALUES</span> (<span class="number">56</span>, <span class="string">'222'</span>, <span class="number">12312</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="string">'1'</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `ms_comment` <span class="keyword">VALUES</span> (<span class="number">1405204547248377858</span>, <span class="string">'123'</span>, <span class="number">1623861846172</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">53</span>, <span class="number">1</span>, <span class="string">'2'</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `ms_comment` <span class="keyword">VALUES</span> (<span class="number">1405205050975899650</span>, <span class="string">'123123'</span>, <span class="number">1623861966270</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="string">'1'</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `ms_comment` <span class="keyword">VALUES</span> (<span class="number">1405205572185280513</span>, <span class="string">'3333'</span>, <span class="number">1623862090534</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="string">'1'</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `ms_comment` <span class="keyword">VALUES</span> (<span class="number">1405206087392612353</span>, <span class="string">'7777'</span>, <span class="number">1623862213367</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="string">'1'</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `ms_comment` <span class="keyword">VALUES</span> (<span class="number">1405206147568291842</span>, <span class="string">'7777'</span>, <span class="number">1623862227714</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="string">'1'</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `ms_comment` <span class="keyword">VALUES</span> (<span class="number">1405206347246522370</span>, <span class="string">'666'</span>, <span class="number">1623862275315</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="string">'1'</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `ms_comment` <span class="keyword">VALUES</span> (<span class="number">1405208637198131202</span>, <span class="string">'99999999999999999999'</span>, <span class="number">1623862821278</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="string">'1'</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `ms_comment` <span class="keyword">VALUES</span> (<span class="number">1405209691876790274</span>, <span class="string">'66666666666666666'</span>, <span class="number">1623863072732</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1405208637198131202</span>, <span class="number">1</span>, <span class="string">'2'</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">-- ----------------------------</span></span><br><span class="line"><span class="comment">-- Table structure for ms_permission</span></span><br><span class="line"><span class="comment">-- ----------------------------</span></span><br><span class="line"><span class="keyword">DROP</span> <span class="keyword">TABLE</span> IF <span class="keyword">EXISTS</span> `ms_permission`;</span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> `ms_permission`  (</span><br><span class="line">  `id` <span class="type">bigint</span>(<span class="number">0</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span> AUTO_INCREMENT,</span><br><span class="line">  `name` <span class="type">varchar</span>(<span class="number">255</span>) <span class="type">CHARACTER</span> <span class="keyword">SET</span> utf8mb4 <span class="keyword">COLLATE</span> utf8mb4_unicode_ci <span class="keyword">NOT</span> <span class="keyword">NULL</span>,</span><br><span class="line">  `path` <span class="type">varchar</span>(<span class="number">255</span>) <span class="type">CHARACTER</span> <span class="keyword">SET</span> utf8mb4 <span class="keyword">COLLATE</span> utf8mb4_unicode_ci <span class="keyword">NOT</span> <span class="keyword">NULL</span>,</span><br><span class="line">  `description` <span class="type">varchar</span>(<span class="number">255</span>) <span class="type">CHARACTER</span> <span class="keyword">SET</span> utf8mb4 <span class="keyword">COLLATE</span> utf8mb4_unicode_ci <span class="keyword">NOT</span> <span class="keyword">NULL</span>,</span><br><span class="line">  <span class="keyword">PRIMARY</span> KEY (`id`) <span class="keyword">USING</span> BTREE</span><br><span class="line">) ENGINE <span class="operator">=</span> InnoDB <span class="type">CHARACTER</span> <span class="keyword">SET</span> <span class="operator">=</span> utf8mb4 <span class="keyword">COLLATE</span> <span class="operator">=</span> utf8mb4_unicode_ci ROW_FORMAT <span class="operator">=</span> <span class="keyword">Dynamic</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- ----------------------------</span></span><br><span class="line"><span class="comment">-- Records of ms_permission</span></span><br><span class="line"><span class="comment">-- ----------------------------</span></span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `ms_permission` <span class="keyword">VALUES</span> (<span class="number">1</span>, <span class="string">'查询权限列表'</span>, <span class="string">'/admin/permission/permissionList'</span>, <span class="string">'查询权限列表'</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `ms_permission` <span class="keyword">VALUES</span> (<span class="number">2</span>, <span class="string">'11'</span>, <span class="string">'11'</span>, <span class="string">'111'</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `ms_permission` <span class="keyword">VALUES</span> (<span class="number">7</span>, <span class="string">'1213'</span>, <span class="string">'123'</span>, <span class="string">'123'</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `ms_permission` <span class="keyword">VALUES</span> (<span class="number">8</span>, <span class="string">'删除权限'</span>, <span class="string">'/admin/permission/add'</span>, <span class="string">'删除权限'</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">-- ----------------------------</span></span><br><span class="line"><span class="comment">-- Table structure for ms_sys_log</span></span><br><span class="line"><span class="comment">-- ----------------------------</span></span><br><span class="line"><span class="keyword">DROP</span> <span class="keyword">TABLE</span> IF <span class="keyword">EXISTS</span> `ms_sys_log`;</span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> `ms_sys_log`  (</span><br><span class="line">  `id` <span class="type">bigint</span>(<span class="number">0</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span> AUTO_INCREMENT,</span><br><span class="line">  `create_date` <span class="type">bigint</span>(<span class="number">0</span>) <span class="keyword">NULL</span> <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span>,</span><br><span class="line">  `ip` <span class="type">varchar</span>(<span class="number">15</span>) <span class="type">CHARACTER</span> <span class="keyword">SET</span> utf8 <span class="keyword">COLLATE</span> utf8_bin <span class="keyword">NULL</span> <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span>,</span><br><span class="line">  `<span class="keyword">method</span>` <span class="type">varchar</span>(<span class="number">100</span>) <span class="type">CHARACTER</span> <span class="keyword">SET</span> utf8 <span class="keyword">COLLATE</span> utf8_bin <span class="keyword">NULL</span> <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span>,</span><br><span class="line">  `<span class="keyword">module</span>` <span class="type">varchar</span>(<span class="number">10</span>) <span class="type">CHARACTER</span> <span class="keyword">SET</span> utf8 <span class="keyword">COLLATE</span> utf8_bin <span class="keyword">NULL</span> <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span>,</span><br><span class="line">  `nickname` <span class="type">varchar</span>(<span class="number">10</span>) <span class="type">CHARACTER</span> <span class="keyword">SET</span> utf8mb4 <span class="keyword">COLLATE</span> utf8mb4_unicode_ci <span class="keyword">NULL</span> <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span>,</span><br><span class="line">  `operation` <span class="type">varchar</span>(<span class="number">25</span>) <span class="type">CHARACTER</span> <span class="keyword">SET</span> utf8 <span class="keyword">COLLATE</span> utf8_bin <span class="keyword">NULL</span> <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span>,</span><br><span class="line">  `params` <span class="type">varchar</span>(<span class="number">255</span>) <span class="type">CHARACTER</span> <span class="keyword">SET</span> utf8 <span class="keyword">COLLATE</span> utf8_bin <span class="keyword">NULL</span> <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span>,</span><br><span class="line">  `<span class="type">time</span>` <span class="type">bigint</span>(<span class="number">0</span>) <span class="keyword">NULL</span> <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span>,</span><br><span class="line">  `userid` <span class="type">bigint</span>(<span class="number">0</span>) <span class="keyword">NULL</span> <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span>,</span><br><span class="line">  <span class="keyword">PRIMARY</span> KEY (`id`) <span class="keyword">USING</span> BTREE</span><br><span class="line">) ENGINE <span class="operator">=</span> InnoDB <span class="type">CHARACTER</span> <span class="keyword">SET</span> <span class="operator">=</span> utf8 <span class="keyword">COLLATE</span> <span class="operator">=</span> utf8_unicode_ci ROW_FORMAT <span class="operator">=</span> <span class="keyword">Dynamic</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- ----------------------------</span></span><br><span class="line"><span class="comment">-- Records of ms_sys_log</span></span><br><span class="line"><span class="comment">-- ----------------------------</span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- ----------------------------</span></span><br><span class="line"><span class="comment">-- Table structure for ms_sys_user</span></span><br><span class="line"><span class="comment">-- ----------------------------</span></span><br><span class="line"><span class="keyword">DROP</span> <span class="keyword">TABLE</span> IF <span class="keyword">EXISTS</span> `ms_sys_user`;</span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> `ms_sys_user`  (</span><br><span class="line">  `id` <span class="type">bigint</span>(<span class="number">0</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span> AUTO_INCREMENT,</span><br><span class="line">  `account` <span class="type">varchar</span>(<span class="number">64</span>) <span class="type">CHARACTER</span> <span class="keyword">SET</span> utf8 <span class="keyword">COLLATE</span> utf8_general_ci <span class="keyword">NULL</span> <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">'账号'</span>,</span><br><span class="line">  `admin` bit(<span class="number">1</span>) <span class="keyword">NULL</span> <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">'是否管理员'</span>,</span><br><span class="line">  `avatar` <span class="type">varchar</span>(<span class="number">255</span>) <span class="type">CHARACTER</span> <span class="keyword">SET</span> utf8 <span class="keyword">COLLATE</span> utf8_general_ci <span class="keyword">NULL</span> <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">'头像'</span>,</span><br><span class="line">  `create_date` <span class="type">bigint</span>(<span class="number">0</span>) <span class="keyword">NULL</span> <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">'注册时间'</span>,</span><br><span class="line">  `deleted` bit(<span class="number">1</span>) <span class="keyword">NULL</span> <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">'是否删除'</span>,</span><br><span class="line">  `email` <span class="type">varchar</span>(<span class="number">128</span>) <span class="type">CHARACTER</span> <span class="keyword">SET</span> utf8 <span class="keyword">COLLATE</span> utf8_general_ci <span class="keyword">NULL</span> <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">'邮箱'</span>,</span><br><span class="line">  `last_login` <span class="type">bigint</span>(<span class="number">0</span>) <span class="keyword">NULL</span> <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">'最后登录时间'</span>,</span><br><span class="line">  `mobile_phone_number` <span class="type">varchar</span>(<span class="number">20</span>) <span class="type">CHARACTER</span> <span class="keyword">SET</span> utf8 <span class="keyword">COLLATE</span> utf8_general_ci <span class="keyword">NULL</span> <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">'手机号'</span>,</span><br><span class="line">  `nickname` <span class="type">varchar</span>(<span class="number">255</span>) <span class="type">CHARACTER</span> <span class="keyword">SET</span> utf8 <span class="keyword">COLLATE</span> utf8_general_ci <span class="keyword">NULL</span> <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">'昵称'</span>,</span><br><span class="line">  `password` <span class="type">varchar</span>(<span class="number">64</span>) <span class="type">CHARACTER</span> <span class="keyword">SET</span> utf8 <span class="keyword">COLLATE</span> utf8_general_ci <span class="keyword">NULL</span> <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">'密码'</span>,</span><br><span class="line">  `salt` <span class="type">varchar</span>(<span class="number">255</span>) <span class="type">CHARACTER</span> <span class="keyword">SET</span> utf8 <span class="keyword">COLLATE</span> utf8_general_ci <span class="keyword">NULL</span> <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">'加密盐'</span>,</span><br><span class="line">  `status` <span class="type">varchar</span>(<span class="number">255</span>) <span class="type">CHARACTER</span> <span class="keyword">SET</span> utf8 <span class="keyword">COLLATE</span> utf8_general_ci <span class="keyword">NULL</span> <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">'状态'</span>,</span><br><span class="line">  <span class="keyword">PRIMARY</span> KEY (`id`) <span class="keyword">USING</span> BTREE</span><br><span class="line">) ENGINE <span class="operator">=</span> InnoDB AUTO_INCREMENT <span class="operator">=</span> <span class="number">1404448588146192387</span> <span class="type">CHARACTER</span> <span class="keyword">SET</span> <span class="operator">=</span> utf8 <span class="keyword">COLLATE</span> <span class="operator">=</span> utf8_general_ci ROW_FORMAT <span class="operator">=</span> <span class="keyword">Dynamic</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- ----------------------------</span></span><br><span class="line"><span class="comment">-- Records of ms_sys_user</span></span><br><span class="line"><span class="comment">-- ----------------------------</span></span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `ms_sys_user` <span class="keyword">VALUES</span> (<span class="number">1</span>, <span class="string">'admin'</span>, b<span class="string">'1'</span>, <span class="string">'http://localhost:8080/static/img/logo.b3a48c0.png'</span>, <span class="number">20210622223122</span>, b<span class="string">'0'</span>, <span class="string">'11'</span>, <span class="number">20210630223130</span>, <span class="string">'12'</span>, <span class="string">'李四'</span>, <span class="string">'15f08f86435b060236fa9ccea751e9e5'</span>, <span class="string">'12'</span>, <span class="string">'1'</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `ms_sys_user` <span class="keyword">VALUES</span> (<span class="number">1404446129264832513</span>, <span class="string">'lisi'</span>, b<span class="string">'1'</span>, <span class="string">'/static/img/logo.b3a48c0.png'</span>, <span class="number">1623681025218</span>, b<span class="string">'0'</span>, <span class="string">''</span>, <span class="number">1623681025218</span>, <span class="keyword">NULL</span>, <span class="string">'李四'</span>, <span class="string">'1d01d52c40f4ff57ad3f93a06daf21d5'</span>, <span class="string">''</span>, <span class="string">''</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `ms_sys_user` <span class="keyword">VALUES</span> (<span class="number">1404448463944462338</span>, <span class="string">'12213'</span>, b<span class="string">'1'</span>, <span class="string">'/static/img/logo.b3a48c0.png'</span>, <span class="number">1623681581855</span>, b<span class="string">'0'</span>, <span class="string">''</span>, <span class="number">1623681581855</span>, <span class="keyword">NULL</span>, <span class="string">'123'</span>, <span class="string">'8628d1f407f72e10ac947a032fe5ad29'</span>, <span class="string">''</span>, <span class="string">''</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `ms_sys_user` <span class="keyword">VALUES</span> (<span class="number">1404448588146192386</span>, <span class="string">'123'</span>, b<span class="string">'1'</span>, <span class="string">'/static/img/logo.b3a48c0.png'</span>, <span class="number">1623681611474</span>, b<span class="string">'0'</span>, <span class="string">''</span>, <span class="number">1623681611474</span>, <span class="keyword">NULL</span>, <span class="string">'123'</span>, <span class="string">'5e112646dbf3570f8e23d0cf1027ede1'</span>, <span class="string">''</span>, <span class="string">''</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">-- ----------------------------</span></span><br><span class="line"><span class="comment">-- Table structure for ms_tag</span></span><br><span class="line"><span class="comment">-- ----------------------------</span></span><br><span class="line"><span class="keyword">DROP</span> <span class="keyword">TABLE</span> IF <span class="keyword">EXISTS</span> `ms_tag`;</span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> `ms_tag`  (</span><br><span class="line">  `id` <span class="type">bigint</span>(<span class="number">0</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span> AUTO_INCREMENT,</span><br><span class="line">  `avatar` <span class="type">varchar</span>(<span class="number">255</span>) <span class="type">CHARACTER</span> <span class="keyword">SET</span> utf8mb4 <span class="keyword">COLLATE</span> utf8mb4_unicode_ci <span class="keyword">NULL</span> <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span>,</span><br><span class="line">  `tag_name` <span class="type">varchar</span>(<span class="number">255</span>) <span class="type">CHARACTER</span> <span class="keyword">SET</span> utf8mb4 <span class="keyword">COLLATE</span> utf8mb4_unicode_ci <span class="keyword">NULL</span> <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span>,</span><br><span class="line">  <span class="keyword">PRIMARY</span> KEY (`id`) <span class="keyword">USING</span> BTREE</span><br><span class="line">) ENGINE <span class="operator">=</span> InnoDB AUTO_INCREMENT <span class="operator">=</span> <span class="number">11</span> <span class="type">CHARACTER</span> <span class="keyword">SET</span> <span class="operator">=</span> utf8 <span class="keyword">COLLATE</span> <span class="operator">=</span> utf8_general_ci ROW_FORMAT <span class="operator">=</span> <span class="keyword">Dynamic</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- ----------------------------</span></span><br><span class="line"><span class="comment">-- Records of ms_tag</span></span><br><span class="line"><span class="comment">-- ----------------------------</span></span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `ms_tag` <span class="keyword">VALUES</span> (<span class="number">5</span>, <span class="string">'/static/tag/java.png'</span>, <span class="string">'springboot'</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `ms_tag` <span class="keyword">VALUES</span> (<span class="number">6</span>, <span class="string">'/static/tag/java.png'</span>, <span class="string">'spring'</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `ms_tag` <span class="keyword">VALUES</span> (<span class="number">7</span>, <span class="string">'/static/tag/java.png'</span>, <span class="string">'springmvc'</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `ms_tag` <span class="keyword">VALUES</span> (<span class="number">8</span>, <span class="string">'/static/tag/css.png'</span>, <span class="string">'11'</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">SET</span> FOREIGN_KEY_CHECKS <span class="operator">=</span> <span class="number">1</span>;</span><br></pre></td></tr></tbody></table></figure>

<ul>
<li>创建出来的数据库表如下：</li>
</ul>
<p><img src="C:\Users\95671\AppData\Roaming\Typora\typora-user-images\image-20220119213456370.png" alt="image-20220119213456370"></p>
<h2 id="3-2-工具类和处理类"><a href="#3-2-工具类和处理类" class="headerlink" title="3.2 工具类和处理类"></a>3.2 工具类和处理类</h2><h3 id="3-2-1-统一异常处理"><a href="#3-2-1-统一异常处理" class="headerlink" title="3.2.1 统一异常处理"></a>3.2.1 统一异常处理</h3><figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@ControllerAdvice</span> <span class="comment">//对加了@controller注解的方法进行拦截处理，本质上是一种AOP</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">AllExceptionHandler</span> </span>{</span><br><span class="line">    <span class="meta">@ExceptionHandler(Exception.class)</span><span class="comment">//进行异常处理，处理Exception.class的异常</span></span><br><span class="line">    <span class="meta">@ResponseBody</span> <span class="comment">//返回json数据，不加的话返回的是页面</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Result <span class="title">doException</span><span class="params">(Exception e)</span></span>{</span><br><span class="line">        e.printStackTrace();</span><br><span class="line">        <span class="keyword">return</span> Result.fail(-<span class="number">999</span>,<span class="string">"系统异常"</span>);</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

<h3 id="3-2-2-统一错误处理"><a href="#3-2-2-统一错误处理" class="headerlink" title="3.2.2 统一错误处理"></a>3.2.2 统一错误处理</h3><figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">enum</span>  <span class="title">ErrorCode</span> </span>{</span><br><span class="line"></span><br><span class="line">    PARAMS_ERROR(<span class="number">10001</span>,<span class="string">"参数有误"</span>),</span><br><span class="line">    ACCOUNT_PWD_NOT_EXIST(<span class="number">10002</span>,<span class="string">"用户名或密码不存在"</span>),</span><br><span class="line">    NO_PERMISSION(<span class="number">70001</span>,<span class="string">"无访问权限"</span>),</span><br><span class="line">    SESSION_TIME_OUT(<span class="number">90001</span>,<span class="string">"会话超时"</span>),</span><br><span class="line">    NO_LOGIN(<span class="number">90002</span>,<span class="string">"未登录"</span>),</span><br><span class="line">    TOKEN_ERROR(<span class="number">10003</span>,<span class="string">"TOKEN不合法"</span>),</span><br><span class="line">    ACCOUNT_EXIST(<span class="number">10004</span>,<span class="string">"账号已存在"</span>);</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> code;</span><br><span class="line">    <span class="keyword">private</span> String msg;</span><br><span class="line"></span><br><span class="line">    ErrorCode(<span class="keyword">int</span> code, String msg){</span><br><span class="line">        <span class="keyword">this</span>.code = code;</span><br><span class="line">        <span class="keyword">this</span>.msg = msg;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getCode</span><span class="params">()</span> </span>{</span><br><span class="line">        <span class="keyword">return</span> code;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setCode</span><span class="params">(<span class="keyword">int</span> code)</span> </span>{</span><br><span class="line">        <span class="keyword">this</span>.code = code;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getMsg</span><span class="params">()</span> </span>{</span><br><span class="line">        <span class="keyword">return</span> msg;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setMsg</span><span class="params">(String msg)</span> </span>{</span><br><span class="line">        <span class="keyword">this</span>.msg = msg;</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

<h3 id="3-2-3-jwt加密工具类"><a href="#3-2-3-jwt加密工具类" class="headerlink" title="3.2.3 jwt加密工具类"></a>3.2.3 jwt加密工具类</h3><figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">JWTUtils</span> </span>{</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> String jwtToken = <span class="string">"123456Mszlu!@#$$"</span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> String <span class="title">createToken</span><span class="params">(Long userId)</span></span>{</span><br><span class="line">        Map&lt;String,Object&gt; claims = <span class="keyword">new</span> HashMap&lt;&gt;();</span><br><span class="line">        claims.put(<span class="string">"userId"</span>,userId);</span><br><span class="line">        JwtBuilder jwtBuilder = Jwts.builder()</span><br><span class="line">                .signWith(SignatureAlgorithm.HS256, jwtToken) <span class="comment">// 签发算法，秘钥为jwtToken</span></span><br><span class="line">                .setClaims(claims) <span class="comment">// body数据，要唯一，自行设置</span></span><br><span class="line">                .setIssuedAt(<span class="keyword">new</span> Date()) <span class="comment">// 设置签发时间</span></span><br><span class="line">                .setExpiration(<span class="keyword">new</span> Date(System.currentTimeMillis() + <span class="number">24</span> * <span class="number">60</span> * <span class="number">60</span> * <span class="number">1000</span>));<span class="comment">// 一天的有效时间</span></span><br><span class="line">        String token = jwtBuilder.compact();</span><br><span class="line">        <span class="keyword">return</span> token;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Map&lt;String, Object&gt; <span class="title">checkToken</span><span class="params">(String token)</span></span>{</span><br><span class="line">        <span class="keyword">try</span> {</span><br><span class="line">            Jwt parse = Jwts.parser().setSigningKey(jwtToken).parse(token);</span><br><span class="line">            <span class="keyword">return</span> (Map&lt;String, Object&gt;) parse.getBody();</span><br><span class="line">        }<span class="keyword">catch</span> (Exception e){</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        }</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line"></span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

<h2 id="3-3-文章列表功能"><a href="#3-3-文章列表功能" class="headerlink" title="3.3 文章列表功能"></a>3.3 文章列表功能</h2><h3 id="3-3-1-接口说明"><a href="#3-3-1-接口说明" class="headerlink" title="3.3.1 接口说明"></a>3.3.1 接口说明</h3><ul>
<li><p>接口url：/articles</p>
</li>
<li><p>请求方式：POST</p>
</li>
<li><p>请求参数：</p>
</li>
</ul>
<table>
<thead>
<tr>
<th align="center">参数名称</th>
<th align="center">参数类型</th>
<th align="center">说明</th>
</tr>
</thead>
<tbody><tr>
<td align="center">page</td>
<td align="center">int</td>
<td align="center">当前页数</td>
</tr>
<tr>
<td align="center">pageSize</td>
<td align="center">int</td>
<td align="center">每页显示的数量</td>
</tr>
</tbody></table>
<ul>
<li>返回数据：</li>
</ul>
<figure class="highlight js"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br></pre></td><td class="code"><pre><span class="line">{</span><br><span class="line">    <span class="string">"success"</span>: <span class="literal">true</span>,</span><br><span class="line">    <span class="string">"code"</span>: <span class="number">200</span>,</span><br><span class="line">    <span class="string">"msg"</span>: <span class="string">"success"</span>,</span><br><span class="line">    <span class="string">"data"</span>: [</span><br><span class="line">        {</span><br><span class="line">            <span class="string">"id"</span>: <span class="number">1</span>,</span><br><span class="line">            <span class="string">"title"</span>: <span class="string">"springboot介绍以及入门案例"</span>,</span><br><span class="line">            <span class="string">"summary"</span>: <span class="string">"通过Spring Boot实现的服务，只需要依靠一个Java类，把它打包成jar，并通过`java -jar`命令就可以运行起来。\r\n\r\n这一切相较于传统Spring应用来说，已经变得非常的轻便、简单。"</span>,</span><br><span class="line">            <span class="string">"commentCounts"</span>: <span class="number">2</span>,</span><br><span class="line">            <span class="string">"viewCounts"</span>: <span class="number">54</span>,</span><br><span class="line">            <span class="string">"weight"</span>: <span class="number">1</span>,</span><br><span class="line">            <span class="string">"createDate"</span>: <span class="string">"2609-06-26 15:58"</span>,</span><br><span class="line">            <span class="string">"author"</span>: <span class="string">"12"</span>,</span><br><span class="line">            <span class="string">"body"</span>: <span class="literal">null</span>,</span><br><span class="line">            <span class="string">"tags"</span>: [</span><br><span class="line">                {</span><br><span class="line">                    <span class="string">"id"</span>: <span class="number">5</span>,</span><br><span class="line">                    <span class="string">"avatar"</span>: <span class="literal">null</span>,</span><br><span class="line">                    <span class="string">"tagName"</span>: <span class="string">"444"</span></span><br><span class="line">                },</span><br><span class="line">                {</span><br><span class="line">                    <span class="string">"id"</span>: <span class="number">7</span>,</span><br><span class="line">                    <span class="string">"avatar"</span>: <span class="literal">null</span>,</span><br><span class="line">                    <span class="string">"tagName"</span>: <span class="string">"22"</span></span><br><span class="line">                },</span><br><span class="line">                {</span><br><span class="line">                    <span class="string">"id"</span>: <span class="number">8</span>,</span><br><span class="line">                    <span class="string">"avatar"</span>: <span class="literal">null</span>,</span><br><span class="line">                    <span class="string">"tagName"</span>: <span class="string">"11"</span></span><br><span class="line">                }</span><br><span class="line">            ],</span><br><span class="line">            <span class="string">"categorys"</span>: <span class="literal">null</span></span><br><span class="line">        },</span><br><span class="line">        {</span><br><span class="line">            <span class="string">"id"</span>: <span class="number">9</span>,</span><br><span class="line">            <span class="string">"title"</span>: <span class="string">"Vue.js 是什么"</span>,</span><br><span class="line">            <span class="string">"summary"</span>: <span class="string">"Vue (读音 /vjuː/，类似于 view) 是一套用于构建用户界面的渐进式框架。"</span>,</span><br><span class="line">            <span class="string">"commentCounts"</span>: <span class="number">0</span>,</span><br><span class="line">            <span class="string">"viewCounts"</span>: <span class="number">3</span>,</span><br><span class="line">            <span class="string">"weight"</span>: <span class="number">0</span>,</span><br><span class="line">            <span class="string">"createDate"</span>: <span class="string">"2609-06-27 11:25"</span>,</span><br><span class="line">            <span class="string">"author"</span>: <span class="string">"12"</span>,</span><br><span class="line">            <span class="string">"body"</span>: <span class="literal">null</span>,</span><br><span class="line">            <span class="string">"tags"</span>: [</span><br><span class="line">                {</span><br><span class="line">                    <span class="string">"id"</span>: <span class="number">7</span>,</span><br><span class="line">                    <span class="string">"avatar"</span>: <span class="literal">null</span>,</span><br><span class="line">                    <span class="string">"tagName"</span>: <span class="string">"22"</span></span><br><span class="line">                }</span><br><span class="line">            ],</span><br><span class="line">            <span class="string">"categorys"</span>: <span class="literal">null</span></span><br><span class="line">        },</span><br><span class="line">        {</span><br><span class="line">            <span class="string">"id"</span>: <span class="number">10</span>,</span><br><span class="line">            <span class="string">"title"</span>: <span class="string">"Element相关"</span>,</span><br><span class="line">            <span class="string">"summary"</span>: <span class="string">"本节将介绍如何在项目中使用 Element。"</span>,</span><br><span class="line">            <span class="string">"commentCounts"</span>: <span class="number">0</span>,</span><br><span class="line">            <span class="string">"viewCounts"</span>: <span class="number">3</span>,</span><br><span class="line">            <span class="string">"weight"</span>: <span class="number">0</span>,</span><br><span class="line">            <span class="string">"createDate"</span>: <span class="string">"2609-06-27 11:25"</span>,</span><br><span class="line">            <span class="string">"author"</span>: <span class="string">"12"</span>,</span><br><span class="line">            <span class="string">"body"</span>: <span class="literal">null</span>,</span><br><span class="line">            <span class="string">"tags"</span>: [</span><br><span class="line">                {</span><br><span class="line">                    <span class="string">"id"</span>: <span class="number">5</span>,</span><br><span class="line">                    <span class="string">"avatar"</span>: <span class="literal">null</span>,</span><br><span class="line">                    <span class="string">"tagName"</span>: <span class="string">"444"</span></span><br><span class="line">                },</span><br><span class="line">                {</span><br><span class="line">                    <span class="string">"id"</span>: <span class="number">6</span>,</span><br><span class="line">                    <span class="string">"avatar"</span>: <span class="literal">null</span>,</span><br><span class="line">                    <span class="string">"tagName"</span>: <span class="string">"33"</span></span><br><span class="line">                },</span><br><span class="line">                {</span><br><span class="line">                    <span class="string">"id"</span>: <span class="number">7</span>,</span><br><span class="line">                    <span class="string">"avatar"</span>: <span class="literal">null</span>,</span><br><span class="line">                    <span class="string">"tagName"</span>: <span class="string">"22"</span></span><br><span class="line">                },</span><br><span class="line">                {</span><br><span class="line">                    <span class="string">"id"</span>: <span class="number">8</span>,</span><br><span class="line">                    <span class="string">"avatar"</span>: <span class="literal">null</span>,</span><br><span class="line">                    <span class="string">"tagName"</span>: <span class="string">"11"</span></span><br><span class="line">                }</span><br><span class="line">            ],</span><br><span class="line">            <span class="string">"categorys"</span>: <span class="literal">null</span></span><br><span class="line">        }</span><br><span class="line">    ]</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

<h3 id="3-3-2-编码"><a href="#3-3-2-编码" class="headerlink" title="3.3.2 编码"></a>3.3.2 编码</h3><h4 id="①-Pojo实体类"><a href="#①-Pojo实体类" class="headerlink" title="① Pojo实体类"></a>① Pojo实体类</h4><figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//文章实体类</span></span><br><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Article</span> </span>{</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">int</span> Article_TOP = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">int</span> Article_Common = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">private</span> Long id;</span><br><span class="line">    <span class="keyword">private</span> String title;</span><br><span class="line">    <span class="keyword">private</span> String summary;</span><br><span class="line">    <span class="keyword">private</span> Integer commentCounts;</span><br><span class="line">    <span class="keyword">private</span> Integer viewCounts;</span><br><span class="line">    <span class="comment">//作者id</span></span><br><span class="line">    <span class="keyword">private</span> Long authorId;</span><br><span class="line">    <span class="comment">//内容id</span></span><br><span class="line">    <span class="keyword">private</span> Long bodyId;</span><br><span class="line">    <span class="comment">//类别id</span></span><br><span class="line">    <span class="keyword">private</span> Long categoryId;</span><br><span class="line">    <span class="comment">//置顶</span></span><br><span class="line">    <span class="keyword">private</span> Integer weight = Article_Common;</span><br><span class="line">    <span class="comment">//创建时间</span></span><br><span class="line">    <span class="keyword">private</span> Long createDate;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

<figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//标签实体类</span></span><br><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Tag</span> </span>{</span><br><span class="line">    <span class="keyword">private</span> Long id;</span><br><span class="line">    <span class="keyword">private</span> String avatar;</span><br><span class="line">    <span class="keyword">private</span> String tagName;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

<figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//用户实体类</span></span><br><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SysUser</span> </span>{</span><br><span class="line">    <span class="keyword">private</span> Long id;</span><br><span class="line">    <span class="keyword">private</span> String account;</span><br><span class="line">    <span class="keyword">private</span> Integer admin;</span><br><span class="line">    <span class="keyword">private</span> String avatar;</span><br><span class="line">    <span class="keyword">private</span> Long createDate;</span><br><span class="line">    <span class="keyword">private</span> Integer deleted;</span><br><span class="line">    <span class="keyword">private</span> String email;</span><br><span class="line">    <span class="keyword">private</span> Long lastLogin;</span><br><span class="line">    <span class="keyword">private</span> String mobilePhoneNumber;</span><br><span class="line">    <span class="keyword">private</span> String nickname;</span><br><span class="line">    <span class="keyword">private</span> String password;</span><br><span class="line">    <span class="keyword">private</span> String salt;</span><br><span class="line">    <span class="keyword">private</span> String status;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

<h4 id="②-Result结果类"><a href="#②-Result结果类" class="headerlink" title="② Result结果类"></a>② Result结果类</h4><ul>
<li>为了使返回给前端的数据格式统一，需编写Result类规定返回数据类型</li>
</ul>
<figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="meta">@AllArgsConstructor</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Result</span> </span>{</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">boolean</span> success;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> code;</span><br><span class="line">    <span class="keyword">private</span> String msg;</span><br><span class="line">    <span class="keyword">private</span> Object data;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Result <span class="title">success</span><span class="params">(Object data)</span></span>{<span class="comment">//获取数据成功的情况</span></span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> Result(<span class="keyword">true</span>,<span class="number">200</span>,<span class="string">"success"</span>,data);</span><br><span class="line">    }</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Result <span class="title">fail</span><span class="params">(<span class="keyword">int</span> code,String msg)</span></span>{<span class="comment">//获取数据失败的情况</span></span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> Result(<span class="keyword">false</span>,code,msg,<span class="keyword">null</span>);</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

<h4 id="③-PageParam分页参数类"><a href="#③-PageParam分页参数类" class="headerlink" title="③ PageParam分页参数类"></a>③ PageParam分页参数类</h4><figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//定义初始页面（默认第一页）以及页面大小</span></span><br><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">PageParam</span> </span>{</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> page=<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> pageSize=<span class="number">10</span>;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

<h4 id="④-ArticleController控制类"><a href="#④-ArticleController控制类" class="headerlink" title="④ ArticleController控制类"></a>④ ArticleController控制类</h4><figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//首页文章列表</span></span><br><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="meta">@RequestMapping("/articles")</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ArticleController</span> </span>{</span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> ArticleService articleService;</span><br><span class="line">    <span class="meta">@PostMapping</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Result <span class="title">listArticle</span><span class="params">(<span class="meta">@RequestBody</span> PageParam pageParam)</span></span>{<span class="comment">//用pageParam接收前端的参数</span></span><br><span class="line">        <span class="keyword">return</span> Result.success(articleService.listService(pageParam));</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

<h4 id="⑤-Service服务类"><a href="#⑤-Service服务类" class="headerlink" title="⑤ Service服务类"></a>⑤ Service服务类</h4><p>由于显示文章时其下方需同时显示作者以及标签，故一同创建</p>
<figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">ArticleService</span> </span>{</span><br><span class="line">    <span class="comment">//传入分页数据，返回对应的文章集合</span></span><br><span class="line">    <span class="function">List&lt;ArticleVo&gt; <span class="title">listService</span><span class="params">(PageParam pageParam)</span></span>;</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">SysUserService</span> </span>{</span><br><span class="line">    <span class="comment">//根据作者ID返回对应用户</span></span><br><span class="line">    <span class="function">SysUser <span class="title">findUserById</span><span class="params">(Long authorId)</span></span>;</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">TagService</span> </span>{</span><br><span class="line">    <span class="comment">//根据文章ID返回对应标签</span></span><br><span class="line">    <span class="function">List&lt;TagVo&gt; <span class="title">findTagsByArticleId</span><span class="params">(Long ArticleId)</span></span>;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

<h4 id="⑥-Mapper类"><a href="#⑥-Mapper类" class="headerlink" title="⑥ Mapper类"></a>⑥ Mapper类</h4><figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//使用MP快速实现</span></span><br><span class="line"><span class="meta">@Mapper</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">ArticleMapper</span> <span class="keyword">extends</span> <span class="title">BaseMapper</span>&lt;<span class="title">Article</span>&gt; </span>{</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="meta">@Mapper</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">SysUserMapper</span> <span class="keyword">extends</span> <span class="title">BaseMapper</span>&lt;<span class="title">SysUser</span>&gt; </span>{</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="meta">@Mapper</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">TagMapper</span> <span class="keyword">extends</span> <span class="title">BaseMapper</span>&lt;<span class="title">Tag</span>&gt; </span>{</span><br><span class="line">    <span class="function">List&lt;Tag&gt; <span class="title">findTagsByArticleId</span><span class="params">(Long articleId)</span></span>;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

<h4 id="⑦-VO类"><a href="#⑦-VO类" class="headerlink" title="⑦ VO类"></a>⑦ VO类</h4><p>由于数据库表字段一般较多，而显示到前端时又不是所有字段都要，所以可以创建一个VO类，里面只保留前端需要的属性</p>
<figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ArticleVo</span> </span>{<span class="comment">//文章的Vo类</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">//Article的id为Long，ArticleVo的id为String</span></span><br><span class="line">    <span class="comment">//因为id用的是分布式id，比较长，如果是Long类型返回前端可能会出现精度损失的问题，所以最好用String类型</span></span><br><span class="line">    <span class="keyword">private</span> String id;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> String title;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> String summary;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> commentCounts;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> viewCounts;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> weight;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 创建时间</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> String createDate;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> String author;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> ArticleBodyVo body;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> List&lt;TagVo&gt; tags;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> List&lt;CategoryVo&gt; categorys;</span><br><span class="line"></span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

<figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TagVo</span> </span>{<span class="comment">//标签的Vo类</span></span><br><span class="line">    <span class="keyword">private</span> String id;</span><br><span class="line">    <span class="keyword">private</span> String tagName;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

<h4 id="⑧-ServiceImpl服务实现类"><a href="#⑧-ServiceImpl服务实现类" class="headerlink" title="⑧ ServiceImpl服务实现类"></a>⑧ ServiceImpl服务实现类</h4><figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//ArticleService的实现类</span></span><br><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ArticleServiceImpl</span> <span class="keyword">implements</span> <span class="title">ArticleService</span> </span>{</span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> ArticleMapper articleMapper;</span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> TagService tagService;</span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> SysUserService sysUserService;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> List&lt;ArticleVo&gt; <span class="title">listService</span><span class="params">(PageParam pageParam)</span> </span>{</span><br><span class="line">        Page&lt;Article&gt; page=<span class="keyword">new</span> Page&lt;&gt;(pageParam.getPage(),pageParam.getPageSize());</span><br><span class="line">        LambdaQueryWrapper&lt;Article&gt; queryWrapper=<span class="keyword">new</span> LambdaQueryWrapper&lt;&gt;();</span><br><span class="line">        <span class="comment">//第一项是根据是否置顶排序，第二项是根据创建时间排序</span></span><br><span class="line">        queryWrapper.orderByDesc(Article::getWeight,Article::getCreateDate);</span><br><span class="line">        <span class="comment">//通过MP自带的selectPage方法返回一个分页对象</span></span><br><span class="line">        Page&lt;Article&gt; articlePage = articleMapper.selectPage(page, queryWrapper);</span><br><span class="line">        <span class="comment">//获取该分页对象中的数据，也即该页的记录集合</span></span><br><span class="line">        List&lt;Article&gt; records = articlePage.getRecords();</span><br><span class="line">        <span class="comment">//通过copyList函数将List&lt;Article&gt;转化为List&lt;ArticleVo&gt;对象输出</span></span><br><span class="line">        List&lt;ArticleVo&gt;  articleVoList= copyList(records,<span class="keyword">true</span>,<span class="keyword">true</span>);</span><br><span class="line">        <span class="keyword">return</span> articleVoList;</span><br><span class="line">    }</span><br><span class="line">    </span><br><span class="line">    <span class="comment">//传入List&lt;Article&gt;，以及是否有标签，是否有作者</span></span><br><span class="line">    <span class="function"><span class="keyword">private</span> List&lt;ArticleVo&gt; <span class="title">copyList</span><span class="params">(List&lt;Article&gt; records,<span class="keyword">boolean</span> isTag,<span class="keyword">boolean</span> isAuthor)</span> </span>{</span><br><span class="line">        List&lt;ArticleVo&gt; articleVoList=<span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line">        <span class="comment">//遍历List&lt;Article&gt;中的每一个记录，通过copy()函数将其转化为ArticleVo对象并添加到articleVoList中</span></span><br><span class="line">        <span class="keyword">for</span> (Article record : records) {</span><br><span class="line">            articleVoList.add(copy(record,isTag,isAuthor));</span><br><span class="line">        }</span><br><span class="line">        <span class="keyword">return</span> articleVoList;</span><br><span class="line">    }</span><br><span class="line">    </span><br><span class="line">    <span class="comment">//copy()函数用于将Article对象转化为ArticleVo对象</span></span><br><span class="line">    <span class="function"><span class="keyword">private</span> ArticleVo <span class="title">copy</span><span class="params">(Article article,<span class="keyword">boolean</span> isTag,<span class="keyword">boolean</span> isAuthor)</span></span>{</span><br><span class="line">        ArticleVo articleVo=<span class="keyword">new</span> ArticleVo();</span><br><span class="line">        <span class="comment">//通过spring自带的工具类实现属性复制（只有同名且同类型的属性可以复制）</span></span><br><span class="line">        BeanUtils.copyProperties(article,articleVo);</span><br><span class="line">        <span class="comment">//由于两个类的创建时间属性类型不同，故需要手动复制</span></span><br><span class="line">        <span class="comment">//Article的id为Long，ArticleVo的id为String</span></span><br><span class="line">        articleVo.setId(String.valueOf(article.getId()));</span><br><span class="line">        <span class="comment">//此处的new DateTime()是joda-time依赖提供的方法</span></span><br><span class="line">        articleVo.setCreateDate(<span class="keyword">new</span> DateTime(article.getCreateDate()).toString(<span class="string">"yyyy-MM-dd HH:mm"</span>));</span><br><span class="line">        <span class="comment">//如果该文章有标题，则通过tagService提供的findTagsByArticleId()方法找到其标签</span></span><br><span class="line">        <span class="keyword">if</span>(isTag){</span><br><span class="line">            Long articleId = article.getId();</span><br><span class="line">            articleVo.setTags(tagService.findTagsByArticleId(articleId));</span><br><span class="line">        }</span><br><span class="line">        <span class="comment">//如果该文章有作者，则通过sysUserService提供的findUserById()方法找到其作者，并得到其Nickname属性</span></span><br><span class="line">        <span class="keyword">if</span>(isAuthor){</span><br><span class="line">            Long authorId = article.getAuthorId();</span><br><span class="line">            articleVo.setAuthor(sysUserService.findUserById(authorId).getNickname());</span><br><span class="line">        }</span><br><span class="line">        <span class="keyword">return</span> articleVo;</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

<figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//TagService的实现类</span></span><br><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TagServiceImpl</span> <span class="keyword">implements</span> <span class="title">TagService</span> </span>{</span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> TagMapper tagMapper;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="comment">//通过文章ID返回对应的标签</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> List&lt;TagVo&gt; <span class="title">findTagsByArticleId</span><span class="params">(Long articleId)</span> </span>{</span><br><span class="line">        <span class="comment">//调用TagMapper中的findTagsByArticleId方法（该方法需要连表查询，在MP中没有实现，故我们需要手动实现）</span></span><br><span class="line">        List&lt;Tag&gt; tags=tagMapper.findTagsByArticleId(articleId);</span><br><span class="line">        <span class="comment">//通过copyList将List&lt;Tag&gt;转化为List&lt;TagVo&gt;</span></span><br><span class="line">        <span class="keyword">return</span> copyList(tags);</span><br><span class="line">    }</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">private</span> List&lt;TagVo&gt; <span class="title">copyList</span><span class="params">(List&lt;Tag&gt; tags)</span> </span>{</span><br><span class="line">        List&lt;TagVo&gt; tagVoList=<span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line">        <span class="keyword">for</span> (Tag tag : tags) {</span><br><span class="line">            tagVoList.add(copy(tag));</span><br><span class="line">        }</span><br><span class="line">        <span class="keyword">return</span> tagVoList;</span><br><span class="line">    }</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">private</span> TagVo <span class="title">copy</span><span class="params">(Tag tag)</span></span>{</span><br><span class="line">        TagVo tagVo=<span class="keyword">new</span> TagVo();</span><br><span class="line">        BeanUtils.copyProperties(tag,tagVo);</span><br><span class="line">        tagVo.setId(String.valueOf(tag.getId()));</span><br><span class="line">        <span class="keyword">return</span> tagVo;</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

<figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//SysUserService实现类</span></span><br><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SysUserServiceImpl</span> <span class="keyword">implements</span> <span class="title">SysUserService</span> </span>{</span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> SysUserMapper sysUserMapper;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> SysUser <span class="title">findUserById</span><span class="params">(Long authorId)</span> </span>{</span><br><span class="line">        SysUser sysUser = sysUserMapper.selectById(authorId);</span><br><span class="line">        <span class="keyword">if</span>(sysUser==<span class="keyword">null</span>){</span><br><span class="line">            sysUser=<span class="keyword">new</span> SysUser();</span><br><span class="line">            sysUser.setNickname(<span class="string">"xlx"</span>);</span><br><span class="line">        }</span><br><span class="line">        <span class="keyword">return</span> sysUser;</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

<h4 id="⑧-Mapper-xml实现数据库查询"><a href="#⑧-Mapper-xml实现数据库查询" class="headerlink" title="⑧ Mapper.xml实现数据库查询"></a>⑧ Mapper.xml实现数据库查询</h4><p>注意对应的xml文件要放在resources下的同名目录，且文件名要相同，如下图：</p>
<p><img src="C:\Users\95671\AppData\Roaming\Typora\typora-user-images\image-20220119222216542.png" alt="image-20220119222216542"></p>
<figure class="highlight xml"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="UTF-8" ?&gt;</span></span><br><span class="line"><span class="comment">&lt;!--MyBatis配置文件--&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">mapper</span> <span class="meta-keyword">PUBLIC</span> <span class="meta-string">"-//mybatis.org//DTD Config 3.0//EN"</span> <span class="meta-string">"http://mybatis.org/dtd/mybatis-3-mapper.dtd"</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">mapper</span> <span class="attr">namespace</span>=<span class="string">"com.ch.mapper.TagMapper"</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--List&lt;Tag&gt; findTagsByArticleId(Long articleId);</span></span><br><span class="line"><span class="comment">    id代表方法名，parameterType表示输入变量的类型，resultType表示返回值的类型--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"findTagsByArticleId"</span> <span class="attr">parameterType</span>=<span class="string">"long"</span> <span class="attr">resultType</span>=<span class="string">"com.ch.pojo.Tag"</span>&gt;</span></span><br><span class="line">        select  id,avatar,tag_name as tagName from ms_tag</span><br><span class="line">        where id in (select tag_id from ms_article_tag where article_id=#{articleId})</span><br><span class="line">    <span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">mapper</span>&gt;</span></span><br></pre></td></tr></tbody></table></figure>

<h3 id="3-3-3-测试结果"><a href="#3-3-3-测试结果" class="headerlink" title="3.3.3 测试结果"></a>3.3.3 测试结果</h3><p><img src="C:\Users\95671\AppData\Roaming\Typora\typora-user-images\image-20220119222609153.png" alt="image-20220119222609153"></p>
<ul>
<li>能显示文章信息，标签和作者也能正常显示</li>
</ul>
<h2 id="3-4-最热标签功能"><a href="#3-4-最热标签功能" class="headerlink" title="3.4 最热标签功能"></a>3.4 最热标签功能</h2><h3 id="3-4-1-接口说明"><a href="#3-4-1-接口说明" class="headerlink" title="3.4.1 接口说明"></a>3.4.1 接口说明</h3><ul>
<li><p>接口url：/tags/hot</p>
</li>
<li><p>请求方式：GET</p>
</li>
<li><p>请求参数：无</p>
</li>
<li><p>我们期望点击标签关于文章的所有列表都显示出来</p>
</li>
<li><p>返回数据：</p>
</li>
</ul>
<figure class="highlight js"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">{</span><br><span class="line">    <span class="string">"success"</span>: <span class="literal">true</span>,</span><br><span class="line">    <span class="string">"code"</span>: <span class="number">200</span>,</span><br><span class="line">    <span class="string">"msg"</span>: <span class="string">"success"</span>,</span><br><span class="line">    <span class="string">"data"</span>: [</span><br><span class="line">        {</span><br><span class="line">            <span class="string">"id"</span>:<span class="number">1</span>,</span><br><span class="line">            <span class="string">"tagName"</span>:<span class="string">"4444"</span></span><br><span class="line">        }</span><br><span class="line">    ]</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

<h3 id="3-4-2-编码"><a href="#3-4-2-编码" class="headerlink" title="3.4.2 编码"></a>3.4.2 编码</h3><h4 id="①TagsController控制类"><a href="#①TagsController控制类" class="headerlink" title="①TagsController控制类"></a>①TagsController控制类</h4><figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="meta">@RequestMapping("tags")</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TagsController</span> </span>{</span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> TagService tagService;</span><br><span class="line">    <span class="meta">@GetMapping("hot")</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Result <span class="title">hot</span><span class="params">()</span></span>{</span><br><span class="line">        <span class="keyword">int</span> limit=<span class="number">6</span>;<span class="comment">//限制最热标签最多只能有六个</span></span><br><span class="line">        <span class="keyword">return</span> tagService.hots(limit);<span class="comment">//调用TagService的hots方法</span></span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

<h4 id="②-TagService服务类"><a href="#②-TagService服务类" class="headerlink" title="② TagService服务类"></a>② TagService服务类</h4><figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">TagService</span> </span>{</span><br><span class="line">    <span class="comment">//添加此功能</span></span><br><span class="line">    <span class="comment">//输入限制标签数，返回最热的limit个标签</span></span><br><span class="line">    <span class="function">Result <span class="title">hots</span><span class="params">(<span class="keyword">int</span> limit)</span></span>;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

<h4 id="③-TagServiceImpl实现类"><a href="#③-TagServiceImpl实现类" class="headerlink" title="③ TagServiceImpl实现类"></a>③ TagServiceImpl实现类</h4><figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TagServiceImpl</span> <span class="keyword">implements</span> <span class="title">TagService</span> </span>{</span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> TagMapper tagMapper;</span><br><span class="line">    <span class="comment">//添加此方法</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Result <span class="title">hots</span><span class="params">(<span class="keyword">int</span> limit)</span> </span>{</span><br><span class="line">        <span class="comment">//调用TagMapper的findHotsTagIds方法，返回前limit个标签的id集合</span></span><br><span class="line">        List&lt;Long&gt; tagIds=tagMapper.findHotsTagIds(limit);</span><br><span class="line">        <span class="comment">//判断：若集合为空，则返回空集合，因为下面的findTagsByTagIds()方法传进去的tagIds不能为空</span></span><br><span class="line">        <span class="keyword">if</span>(CollectionUtils.isEmpty(tagIds)){</span><br><span class="line">            <span class="keyword">return</span> Result.success(Collections.emptyList());</span><br><span class="line">        }</span><br><span class="line">        <span class="comment">//调用TagMapper的findTagsByTagIds方法，返回前limit个标签的集合</span></span><br><span class="line">        List&lt;Tag&gt; tagList=tagMapper.findTagsByTagIds(tagIds);</span><br><span class="line">        <span class="keyword">return</span> Result.success(tagList);</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

<h4 id="④-TagMapper类"><a href="#④-TagMapper类" class="headerlink" title="④ TagMapper类"></a>④ TagMapper类</h4><figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Mapper</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">TagMapper</span> <span class="keyword">extends</span> <span class="title">BaseMapper</span>&lt;<span class="title">Tag</span>&gt; </span>{</span><br><span class="line">    <span class="comment">//添加下面两个方法</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">//找出对应标签id下文章数量前limit多的标签，返回其id集合</span></span><br><span class="line">    <span class="function">List&lt;Long&gt; <span class="title">findHotsTagIds</span><span class="params">(<span class="keyword">int</span> limit)</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//通过标签id集合，返回对应的标签集合</span></span><br><span class="line">    <span class="comment">//当有多个参数时不能直接传入List，要用注解将参数传进去</span></span><br><span class="line">    <span class="function">List&lt;Tag&gt; <span class="title">findTagsByTagIds</span><span class="params">(<span class="meta">@Param("tagIds")</span> List&lt;Long&gt; tagIds)</span></span>;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

<h4 id="⑤-Mapper-xml实现数据库查询"><a href="#⑤-Mapper-xml实现数据库查询" class="headerlink" title="⑤ Mapper.xml实现数据库查询"></a>⑤ Mapper.xml实现数据库查询</h4><figure class="highlight xml"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">mapper</span> <span class="attr">namespace</span>=<span class="string">"com.ch.mapper.TagMapper"</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--List&lt;Long&gt; findHotsTagIds(int limit);--&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--sql语句的意思是在ms_article_tag表中查找tag_id，根据tag_id将其聚合在一起，再根据count（*）的数量以递减的顺序排序最后限制输出limit条数据--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"findHotsTagIds"</span> <span class="attr">parameterType</span>=<span class="string">"int"</span> <span class="attr">resultType</span>=<span class="string">"java.lang.Long"</span>&gt;</span></span><br><span class="line">        select tag_id from ms_article_tag GROUP BY tag_id ORDER BY count(*) DESC LIMIT #{limit}</span><br><span class="line">    <span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--List&lt;Tag&gt; findTagsByTagIds(List&lt;Long&gt; tagIds);</span></span><br><span class="line"><span class="comment">        select id,tag_name as tagName from ms_tag where id in (x,x,x,x...);</span></span><br><span class="line"><span class="comment">        相当于传进来一个id集合，然后for循环每个id，拼接成sql语句找到对应的tag对象，多少个id就拼接多少条语句--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"findTagsByTagIds"</span> <span class="attr">parameterType</span>=<span class="string">"List"</span> <span class="attr">resultType</span>=<span class="string">"com.ch.pojo.Tag"</span>&gt;</span></span><br><span class="line">        select id,tag_name as tagName from ms_tag where id in</span><br><span class="line">        <span class="tag">&lt;<span class="name">foreach</span> <span class="attr">collection</span>=<span class="string">"tagIds"</span> <span class="attr">item</span>=<span class="string">"tagId"</span> <span class="attr">separator</span>=<span class="string">","</span> <span class="attr">open</span>=<span class="string">"("</span> <span class="attr">close</span>=<span class="string">")"</span>&gt;</span></span><br><span class="line">            #{tagId}</span><br><span class="line">        <span class="tag">&lt;/<span class="name">foreach</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">mapper</span>&gt;</span></span><br></pre></td></tr></tbody></table></figure>

<h3 id="3-4-3-测试结果"><a href="#3-4-3-测试结果" class="headerlink" title="3.4.3 测试结果"></a>3.4.3 测试结果</h3><p><img src="C:\Users\95671\AppData\Roaming\Typora\typora-user-images\image-20220119224939131.png" alt="image-20220119224939131"></p>
<ul>
<li>最热标签显示正常，点击进去也能显示对应文章</li>
</ul>
<p><img src="C:\Users\95671\AppData\Roaming\Typora\typora-user-images\image-20220119225017392.png" alt="image-20220119225017392"></p>
<h2 id="3-5-最热文章功能"><a href="#3-5-最热文章功能" class="headerlink" title="3.5 最热文章功能"></a>3.5 最热文章功能</h2><h3 id="3-5-1-接口说明"><a href="#3-5-1-接口说明" class="headerlink" title="3.5.1 接口说明"></a>3.5.1 接口说明</h3><ul>
<li><p>接口url：/articles/hot</p>
</li>
<li><p>请求方式：POST</p>
</li>
<li><p>请求参数：无</p>
</li>
<li><p>返回数据：</p>
</li>
</ul>
<figure class="highlight js"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">{</span><br><span class="line">    <span class="string">"success"</span>: <span class="literal">true</span>,</span><br><span class="line">    <span class="string">"code"</span>: <span class="number">200</span>,</span><br><span class="line">    <span class="string">"msg"</span>: <span class="string">"success"</span>,</span><br><span class="line">    <span class="string">"data"</span>: [</span><br><span class="line">        {</span><br><span class="line">            <span class="string">"id"</span>: <span class="number">1</span>,</span><br><span class="line">            <span class="string">"title"</span>: <span class="string">"springboot介绍以及入门案例"</span>,</span><br><span class="line">        },</span><br><span class="line">        {</span><br><span class="line">            <span class="string">"id"</span>: <span class="number">9</span>,</span><br><span class="line">            <span class="string">"title"</span>: <span class="string">"Vue.js 是什么"</span>,</span><br><span class="line">        },</span><br><span class="line">        {</span><br><span class="line">            <span class="string">"id"</span>: <span class="number">10</span>,</span><br><span class="line">            <span class="string">"title"</span>: <span class="string">"Element相关"</span>,</span><br><span class="line">            }</span><br><span class="line"></span><br><span class="line">   ]</span><br><span class="line"></span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

<h3 id="3-5-2-编码"><a href="#3-5-2-编码" class="headerlink" title="3.5.2 编码"></a>3.5.2 编码</h3><h4 id="①-ArticleController控制类"><a href="#①-ArticleController控制类" class="headerlink" title="① ArticleController控制类"></a>① ArticleController控制类</h4><figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="meta">@RequestMapping("/articles")</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ArticleController</span> </span>{</span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> ArticleService articleService;</span><br><span class="line">    <span class="comment">//添加以下方法</span></span><br><span class="line">    </span><br><span class="line">    <span class="meta">@PostMapping("/hot")</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Result <span class="title">hotArticle</span><span class="params">()</span></span>{</span><br><span class="line">        <span class="keyword">int</span> limit=<span class="number">5</span>;<span class="comment">//限制最热文章的数量为5</span></span><br><span class="line">        List&lt;ArticleVo&gt; articleVoList=articleService.getHotArticle(limit);</span><br><span class="line">        <span class="keyword">return</span> Result.success(articleVoList);</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

<h4 id="②-ArticleService服务类"><a href="#②-ArticleService服务类" class="headerlink" title="② ArticleService服务类"></a>② ArticleService服务类</h4><figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">ArticleService</span> </span>{</span><br><span class="line">    <span class="comment">//添加该接口，用于获取最热的limit篇文章</span></span><br><span class="line">    <span class="function">List&lt;ArticleVo&gt; <span class="title">getHotArticle</span><span class="params">(<span class="keyword">int</span> limit)</span></span>;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

<h4 id="③-ArticleServiceImpl实现类"><a href="#③-ArticleServiceImpl实现类" class="headerlink" title="③ ArticleServiceImpl实现类"></a>③ ArticleServiceImpl实现类</h4><figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ArticleServiceImpl</span> <span class="keyword">implements</span> <span class="title">ArticleService</span> </span>{</span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> ArticleMapper articleMapper;</span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> TagService tagService;</span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> SysUserService sysUserService;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//添加以下方法</span></span><br><span class="line">    </span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> List&lt;ArticleVo&gt; <span class="title">getHotArticle</span><span class="params">(<span class="keyword">int</span> limit)</span> </span>{</span><br><span class="line">        LambdaQueryWrapper&lt;Article&gt; queryWrapper=<span class="keyword">new</span> LambdaQueryWrapper();</span><br><span class="line">        queryWrapper.orderByDesc(Article::getViewCounts);<span class="comment">//按照文章的浏览量降序排列</span></span><br><span class="line">        queryWrapper.select(Article::getId,Article::getTitle);<span class="comment">//只获取文章的id和标题</span></span><br><span class="line">        <span class="comment">//注意limit "中有一个空格，因为本质上是把queryWrapper所调用的方法拼接成sql语句，所以要加空格</span></span><br><span class="line">        queryWrapper.last(<span class="string">"limit "</span>+limit);<span class="comment">//限制只返回前limit篇文章</span></span><br><span class="line">        List&lt;Article&gt; articleList=articleMapper.selectList(queryWrapper);</span><br><span class="line">        List&lt;ArticleVo&gt; articleVoList= copyList(articleList,<span class="keyword">false</span>,<span class="keyword">false</span>);</span><br><span class="line">        <span class="keyword">return</span> articleVoList;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

<h3 id="3-5-3-测试结果"><a href="#3-5-3-测试结果" class="headerlink" title="3.5.3 测试结果"></a>3.5.3 测试结果</h3><p><img src="C:\Users\95671\AppData\Roaming\Typora\typora-user-images\image-20220120123134487.png" alt="image-20220120123134487"></p>
<ul>
<li>测试成功，正确地显示了浏览量前5的文章</li>
</ul>
<h2 id="3-6-最新文章功能"><a href="#3-6-最新文章功能" class="headerlink" title="3.6 最新文章功能"></a>3.6 最新文章功能</h2><h3 id="3-6-1-接口说明"><a href="#3-6-1-接口说明" class="headerlink" title="3.6.1 接口说明"></a>3.6.1 接口说明</h3><ul>
<li>接口url：/articles/new</li>
<li>请求方式：POST</li>
<li>请求参数：无</li>
<li>返回数据：</li>
</ul>
<figure class="highlight js"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">返回数据：</span><br><span class="line"></span><br><span class="line">{</span><br><span class="line">    <span class="string">"success"</span>: <span class="literal">true</span>,</span><br><span class="line">    <span class="string">"code"</span>: <span class="number">200</span>,</span><br><span class="line">    <span class="string">"msg"</span>: <span class="string">"success"</span>,</span><br><span class="line">    <span class="string">"data"</span>: [</span><br><span class="line">        {</span><br><span class="line">            <span class="string">"id"</span>: <span class="number">1</span>,</span><br><span class="line">            <span class="string">"title"</span>: <span class="string">"springboot介绍以及入门案例"</span>,</span><br><span class="line">        },</span><br><span class="line">        {</span><br><span class="line">            <span class="string">"id"</span>: <span class="number">9</span>,</span><br><span class="line">            <span class="string">"title"</span>: <span class="string">"Vue.js 是什么"</span>,</span><br><span class="line">        },</span><br><span class="line">        {</span><br><span class="line">            <span class="string">"id"</span>: <span class="number">10</span>,</span><br><span class="line">            <span class="string">"title"</span>: <span class="string">"Element相关"</span>,</span><br><span class="line">            </span><br><span class="line">        }</span><br><span class="line">    ]</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

<h3 id="3-6-2-编码"><a href="#3-6-2-编码" class="headerlink" title="3.6.2 编码"></a>3.6.2 编码</h3><h4 id="①-ArticleController控制类-1"><a href="#①-ArticleController控制类-1" class="headerlink" title="① ArticleController控制类"></a>① ArticleController控制类</h4><figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="meta">@RequestMapping("/articles")</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ArticleController</span> </span>{</span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> ArticleService articleService;</span><br><span class="line">    <span class="comment">//添加以下方法</span></span><br><span class="line">    </span><br><span class="line">    <span class="meta">@PostMapping("/new")</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Result <span class="title">newArticle</span><span class="params">()</span></span>{</span><br><span class="line">        <span class="keyword">int</span> limit=<span class="number">5</span>;</span><br><span class="line">        List&lt;ArticleVo&gt; articleVoList=articleService.getNewArticle(limit);</span><br><span class="line">        <span class="keyword">return</span> Result.success(articleVoList);</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

<h4 id="②-ArticleService服务类-1"><a href="#②-ArticleService服务类-1" class="headerlink" title="② ArticleService服务类"></a>② ArticleService服务类</h4><figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">ArticleService</span> </span>{</span><br><span class="line">    <span class="comment">//添加该接口，用于获取最热的limit篇文章</span></span><br><span class="line">    <span class="function">List&lt;ArticleVo&gt; <span class="title">getNewArticle</span><span class="params">(<span class="keyword">int</span> limit)</span></span>;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

<h4 id="③-ArticleServiceImpl实现类-1"><a href="#③-ArticleServiceImpl实现类-1" class="headerlink" title="③ ArticleServiceImpl实现类"></a>③ ArticleServiceImpl实现类</h4><figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ArticleServiceImpl</span> <span class="keyword">implements</span> <span class="title">ArticleService</span> </span>{</span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> ArticleMapper articleMapper;</span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> TagService tagService;</span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> SysUserService sysUserService;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//添加以下方法</span></span><br><span class="line">    </span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> List&lt;ArticleVo&gt; <span class="title">getNewArticle</span><span class="params">(<span class="keyword">int</span> limit)</span> </span>{</span><br><span class="line">        LambdaQueryWrapper&lt;Article&gt; queryWrapper=<span class="keyword">new</span> LambdaQueryWrapper();</span><br><span class="line">        queryWrapper.orderByDesc(Article::getCreateDate);<span class="comment">//按创建时间降序排列</span></span><br><span class="line">        queryWrapper.select(Article::getId,Article::getTitle);<span class="comment">//只获取文章的id和标题</span></span><br><span class="line">        queryWrapper.last(<span class="string">"limit "</span>+limit);<span class="comment">//限制只返回前limit篇文章</span></span><br><span class="line">        List&lt;Article&gt; articleList=articleMapper.selectList(queryWrapper);</span><br><span class="line">        List&lt;ArticleVo&gt; articleVoList= copyList(articleList,<span class="keyword">false</span>,<span class="keyword">false</span>);</span><br><span class="line">        <span class="keyword">return</span> articleVoList;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

<h3 id="3-6-3-测试结果"><a href="#3-6-3-测试结果" class="headerlink" title="3.6.3 测试结果"></a>3.6.3 测试结果</h3><p><img src="C:\Users\95671\AppData\Roaming\Typora\typora-user-images\image-20220120123732843.png" alt="image-20220120123732843"></p>
<ul>
<li>测试成功，正确地显示了最新的五篇文章</li>
</ul>
<h2 id="3-7-文章归档功能"><a href="#3-7-文章归档功能" class="headerlink" title="3.7 文章归档功能"></a>3.7 文章归档功能</h2><h3 id="3-7-1-接口说明"><a href="#3-7-1-接口说明" class="headerlink" title="3.7.1 接口说明"></a>3.7.1 接口说明</h3><ul>
<li>接口url：/articles/listArchives</li>
<li>请求方式：POST</li>
<li>请求参数：无</li>
<li>功能：根据创建时间某年某月将每一篇文章归类</li>
<li>返回数据</li>
</ul>
<figure class="highlight js"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">{</span><br><span class="line">    <span class="string">"success"</span>: <span class="literal">true</span>,</span><br><span class="line">    <span class="string">"code"</span>: <span class="number">200</span>,</span><br><span class="line">    <span class="string">"msg"</span>: <span class="string">"success"</span>,</span><br><span class="line">    <span class="string">"data"</span>: [</span><br><span class="line">        {</span><br><span class="line">            <span class="string">"year"</span>: <span class="string">"2021"</span>,</span><br><span class="line">            <span class="string">"month"</span>: <span class="string">"6"</span>,</span><br><span class="line">            <span class="string">"count"</span>: <span class="number">2</span></span><br><span class="line">        }</span><br><span class="line">            </span><br><span class="line">    ]</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

<h3 id="3-7-2-编码"><a href="#3-7-2-编码" class="headerlink" title="3.7.2 编码"></a>3.7.2 编码</h3><h4 id="①-dos类"><a href="#①-dos类" class="headerlink" title="① dos类"></a>① dos类</h4><figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Archives</span> </span>{<span class="comment">//dos层中的类是浏览器要用到，但是又不用持久化存储在数据库中的类</span></span><br><span class="line">    <span class="keyword">private</span> Integer year;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> Integer month;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> Long count;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

<h4 id="②-ArticleController控制类"><a href="#②-ArticleController控制类" class="headerlink" title="② ArticleController控制类"></a>② ArticleController控制类</h4><figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="meta">@RequestMapping("/articles")</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ArticleController</span> </span>{</span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> ArticleService articleService;</span><br><span class="line">    <span class="comment">//添加以下方法</span></span><br><span class="line">    </span><br><span class="line">     <span class="meta">@PostMapping("/listArchives")</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Result <span class="title">listArchives</span><span class="params">()</span></span>{</span><br><span class="line">        List&lt;Archives&gt; archivesList=articleService.listArchives();</span><br><span class="line">        <span class="keyword">return</span> Result.success(archivesList);</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

<h4 id="③-ArticleService服务类"><a href="#③-ArticleService服务类" class="headerlink" title="③ ArticleService服务类"></a>③ ArticleService服务类</h4><figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">ArticleService</span> </span>{</span><br><span class="line">    <span class="comment">//添加该接口，用于将文章按照创建年月进行归档</span></span><br><span class="line">    <span class="function">List&lt;Archives&gt; <span class="title">listArchives</span><span class="params">()</span></span>;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

<h4 id="④-ArticleServiceImpl实现类"><a href="#④-ArticleServiceImpl实现类" class="headerlink" title="④ ArticleServiceImpl实现类"></a>④ ArticleServiceImpl实现类</h4><figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ArticleServiceImpl</span> <span class="keyword">implements</span> <span class="title">ArticleService</span> </span>{</span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> ArticleMapper articleMapper;</span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> TagService tagService;</span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> SysUserService sysUserService;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//添加以下方法</span></span><br><span class="line">    </span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> List&lt;Archives&gt; <span class="title">listArchives</span><span class="params">()</span> </span>{</span><br><span class="line">        <span class="comment">//调用ArticleMapper的listArchives方法</span></span><br><span class="line">        List&lt;Archives&gt; archivesList = articleMapper.listArchives();</span><br><span class="line">        <span class="keyword">return</span> archivesList;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

<h4 id="⑤-ArticleMapper类"><a href="#⑤-ArticleMapper类" class="headerlink" title="⑤ ArticleMapper类"></a>⑤ ArticleMapper类</h4><figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Mapper</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">ArticleMapper</span> <span class="keyword">extends</span> <span class="title">BaseMapper</span>&lt;<span class="title">Article</span>&gt; </span>{</span><br><span class="line">    <span class="comment">//添加以下接口</span></span><br><span class="line">    <span class="comment">//用于获取归档后的列表</span></span><br><span class="line">    <span class="function">List&lt;Archives&gt; <span class="title">listArchives</span><span class="params">()</span></span>;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

<h4 id="⑥-ArticleMapper-xml"><a href="#⑥-ArticleMapper-xml" class="headerlink" title="⑥ ArticleMapper.xml"></a>⑥ ArticleMapper.xml</h4><figure class="highlight xml"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--sql语句是将文章表中的创建时间属性分解为年和月，再通过年和月属性进行分类，然后用count统计数量，最后返回年月以及相应的数量--&gt;</span></span><br><span class="line"><span class="comment">&lt;!--year()和month()是mysql提供的方法，year()函数返回一个指定日期的年份值，month()函数返回一个指定日期的月份值--&gt;</span></span><br><span class="line"><span class="comment">&lt;!--FROM_UNIXTIME(create_date/1000)是因为create_date为bigint 13位，直接year()不行，需要先转date型后再year()。--&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">mapper</span> <span class="attr">namespace</span>=<span class="string">"com.ch.mapper.ArticleMapper"</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"listArchives"</span> <span class="attr">resultType</span>=<span class="string">"com.ch.dos.Archives"</span>&gt;</span></span><br><span class="line">        select year(FROM_UNIXTIME(create_date/1000)) as year,month(FROM_UNIXTIME(create_date/1000)) as month, count(*) as count from ms_article group by year,month</span><br><span class="line">    <span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">mapper</span>&gt;</span></span><br></pre></td></tr></tbody></table></figure>

<h3 id="3-7-3-测试结果"><a href="#3-7-3-测试结果" class="headerlink" title="3.7.3 测试结果"></a>3.7.3 测试结果</h3><p><img src="C:\Users\95671\AppData\Roaming\Typora\typora-user-images\image-20220120144654975.png" alt="image-20220120144654975"></p>
<ul>
<li>测试结果成功</li>
</ul>
<h2 id="3-8-登陆功能"><a href="#3-8-登陆功能" class="headerlink" title="3.8 登陆功能"></a>3.8 登陆功能</h2><h3 id="3-8-1-接口说明"><a href="#3-8-1-接口说明" class="headerlink" title="3.8.1 接口说明"></a>3.8.1 接口说明</h3><ul>
<li><p>接口url：/login</p>
</li>
<li><p>请求方式：POST</p>
</li>
<li><p>请求参数：</p>
</li>
</ul>
<table>
<thead>
<tr>
<th>参数名称</th>
<th>参数类型</th>
<th>说明</th>
</tr>
</thead>
<tbody><tr>
<td>account</td>
<td>string</td>
<td>账号</td>
</tr>
<tr>
<td>password</td>
<td>string</td>
<td>密码</td>
</tr>
</tbody></table>
<ul>
<li>返回数据：</li>
</ul>
<figure class="highlight js"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">{</span><br><span class="line">    <span class="string">"success"</span>: <span class="literal">true</span>,</span><br><span class="line">    <span class="string">"code"</span>: <span class="number">200</span>,</span><br><span class="line">    <span class="string">"msg"</span>: <span class="string">"success"</span>,</span><br><span class="line">    <span class="string">"data"</span>: <span class="string">"token"</span></span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

<h3 id="3-8-2-加密处理"><a href="#3-8-2-加密处理" class="headerlink" title="3.8.2 加密处理"></a>3.8.2 加密处理</h3><h4 id="①需要的技术"><a href="#①需要的技术" class="headerlink" title="①需要的技术"></a>①需要的技术</h4><ul>
<li><p>登录使用jwt技术</p>
</li>
<li><p>密码使用md5加密技术</p>
</li>
<li><p>token使用redis缓存技术</p>
</li>
</ul>
<h4 id="②相关依赖"><a href="#②相关依赖" class="headerlink" title="②相关依赖"></a>②相关依赖</h4><figure class="highlight xml"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--jwt加密--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>io.jsonwebtoken<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>jjwt<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>0.9.1<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!--redis--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-data-redis<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!--md5加密--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>commons-codec<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>commons-codec<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.14<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!--用于将java实体类转化为对应的json字符串对象--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.alibaba<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>fastjson<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.2.62<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></tbody></table></figure>

<h3 id="3-8-3-编码"><a href="#3-8-3-编码" class="headerlink" title="3.8.3 编码"></a>3.8.3 编码</h3><h4 id="①-LoginParam参数类"><a href="#①-LoginParam参数类" class="headerlink" title="① LoginParam参数类"></a>① LoginParam参数类</h4><figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">LoginParam</span> </span>{</span><br><span class="line">    <span class="keyword">private</span> String account;</span><br><span class="line">    <span class="keyword">private</span> String password;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

<h4 id="②-LoginController控制类"><a href="#②-LoginController控制类" class="headerlink" title="② LoginController控制类"></a>② LoginController控制类</h4><figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="meta">@RequestMapping("/login")</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">LoginController</span> </span>{</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="comment">//SysUserService最好只负责用户表相关的增删改查，所以新建一个LoginService</span></span><br><span class="line">    <span class="keyword">private</span> LoginService loginService;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@PostMapping</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Result <span class="title">login</span><span class="params">(<span class="meta">@RequestBody</span> LoginParam loginParam)</span></span>{</span><br><span class="line">        <span class="keyword">return</span> loginService.login(loginParam);</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

<h4 id="③-LoginService服务类"><a href="#③-LoginService服务类" class="headerlink" title="③ LoginService服务类"></a>③ LoginService服务类</h4><figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//SysUserService最好只负责用户表相关的增删改查，所以新建一个LoginService</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">LoginService</span> </span>{</span><br><span class="line">    <span class="function">Result <span class="title">login</span><span class="params">(LoginParam loginParam)</span></span>;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

<h4 id="④-LoginServiceImpl实现类"><a href="#④-LoginServiceImpl实现类" class="headerlink" title="④ LoginServiceImpl实现类"></a>④ LoginServiceImpl实现类</h4><figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">LoginServiceImpl</span> <span class="keyword">implements</span> <span class="title">LoginService</span> </span>{</span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> SysUserService sysUserService;</span><br><span class="line">    <span class="comment">//redis缓存相关的类</span></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> RedisTemplate&lt;String,String&gt; redisTemplate;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//加密盐用于加密</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> String slat = <span class="string">"mszlu!@#"</span>;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Result <span class="title">login</span><span class="params">(LoginParam loginParam)</span> </span>{</span><br><span class="line">        <span class="comment">/**</span></span><br><span class="line"><span class="comment">         * 1. 检查参数是否合法</span></span><br><span class="line"><span class="comment">         * 2. 根据用户名和密码去user表中查询 是否存在</span></span><br><span class="line"><span class="comment">         * 3. 如果不存在 登录失败</span></span><br><span class="line"><span class="comment">         * 4. 如果存在 ，使用jwt 生成token 返回给前端</span></span><br><span class="line"><span class="comment">         * 5. token放入redis当中，redis  token：user信息 设置过期时间</span></span><br><span class="line"><span class="comment">         *  (登录认证的时候 先认证token字符串是否合法，去redis认证是否存在)</span></span><br><span class="line"><span class="comment">         */</span></span><br><span class="line">        String account=loginParam.getAccount();</span><br><span class="line">        String password=loginParam.getPassword();</span><br><span class="line">        <span class="keyword">if</span>(StringUtils.isEmpty(account)||StringUtils.isEmpty(password)){</span><br><span class="line">            <span class="keyword">return</span> Result.fail(ErrorCode.PARAMS_ERROR.getCode(), ErrorCode.PARAMS_ERROR.getMsg());</span><br><span class="line">        }</span><br><span class="line">        <span class="comment">//用密码盐对密码进行加密</span></span><br><span class="line">        password= DigestUtils.md5Hex(password+slat);</span><br><span class="line">        <span class="comment">//调用SysUserService的根据账号和密码寻找用户的方法</span></span><br><span class="line">        SysUser sysUser=sysUserService.findUser(account,password);</span><br><span class="line">        <span class="keyword">if</span>(sysUser==<span class="keyword">null</span>){</span><br><span class="line">            <span class="keyword">return</span> Result.fail(ErrorCode.ACCOUNT_PWD_NOT_EXIST.getCode(), ErrorCode.ACCOUNT_PWD_NOT_EXIST.getMsg());</span><br><span class="line">        }</span><br><span class="line">        <span class="comment">//调用JWTUtils工具类生成token</span></span><br><span class="line">        String token= JWTUtils.createToken(sysUser.getId());</span><br><span class="line">        <span class="comment">//将token和用户信息存储到redis中，时间为1，单位为天</span></span><br><span class="line">        redisTemplate.opsForValue().set(<span class="string">"TOKEN_"</span>+token, JSON.toJSONString(sysUser),<span class="number">1</span>, TimeUnit.DAYS);</span><br><span class="line">        <span class="keyword">return</span> Result.success(token);</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

<h4 id="⑤-SysUserService服务类"><a href="#⑤-SysUserService服务类" class="headerlink" title="⑤ SysUserService服务类"></a>⑤ SysUserService服务类</h4><figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">SysUserService</span> </span>{</span><br><span class="line">    <span class="comment">//添加以下方法</span></span><br><span class="line">    <span class="comment">//根据账号和密码寻找用户并返回</span></span><br><span class="line">    <span class="function">SysUser <span class="title">findUser</span><span class="params">(String account, String password)</span></span>;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

<h4 id="⑥-SysUserServiceImpl实现类"><a href="#⑥-SysUserServiceImpl实现类" class="headerlink" title="⑥ SysUserServiceImpl实现类"></a>⑥ SysUserServiceImpl实现类</h4><figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SysUserServiceImpl</span> <span class="keyword">implements</span> <span class="title">SysUserService</span> </span>{</span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> SysUserMapper sysUserMapper;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> SysUser <span class="title">findUser</span><span class="params">(String account, String password)</span> </span>{</span><br><span class="line">        LambdaQueryWrapper&lt;SysUser&gt; queryWrapper=<span class="keyword">new</span> LambdaQueryWrapper();</span><br><span class="line">        queryWrapper.eq(SysUser::getAccount,account);</span><br><span class="line">        queryWrapper.eq(SysUser::getPassword,password);</span><br><span class="line">        queryWrapper.select(SysUser::getAccount,SysUser::getId,SysUser::getAvatar,SysUser::getNickname);</span><br><span class="line">        queryWrapper.last(<span class="string">"limit 1"</span>);<span class="comment">//找到一个匹配的用户后就停止查询了，否则会将整个数据库查询完才返回</span></span><br><span class="line">        <span class="keyword">return</span> sysUserMapper.selectOne(queryWrapper);</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

<h3 id="3-8-4-测试结果"><a href="#3-8-4-测试结果" class="headerlink" title="3.8.4 测试结果"></a>3.8.4 测试结果</h3><p><img src="C:\Users\95671\AppData\Roaming\Typora\typora-user-images\image-20220120213444777.png" alt="image-20220120213444777"></p>
<h2 id="3-9-获取用户信息功能"><a href="#3-9-获取用户信息功能" class="headerlink" title="3.9 获取用户信息功能"></a>3.9 获取用户信息功能</h2><h3 id="3-9-1-接口说明"><a href="#3-9-1-接口说明" class="headerlink" title="3.9.1 接口说明"></a>3.9.1 接口说明</h3><ul>
<li><p>得从http的head里面拿到这个参数，这样传参相对来说安全一些，返回是数据是我们用户相关的数据，id，账号、昵称和头像</p>
</li>
<li><p>接口url：/users/currentUser</p>
</li>
<li><p>请求方式：GET</p>
</li>
<li><p>请求参数：</p>
</li>
</ul>
<table>
<thead>
<tr>
<th>参数名称</th>
<th>参数类型</th>
<th>说明</th>
</tr>
</thead>
<tbody><tr>
<td>Authorization</td>
<td>string</td>
<td>头部信息(TOKEN)</td>
</tr>
</tbody></table>
<ul>
<li>返回数据：</li>
</ul>
<figure class="highlight js"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">{</span><br><span class="line">    <span class="string">"success"</span>: <span class="literal">true</span>,</span><br><span class="line">    <span class="string">"code"</span>: <span class="number">200</span>,</span><br><span class="line">    <span class="string">"msg"</span>: <span class="string">"success"</span>,</span><br><span class="line">    <span class="string">"data"</span>: {</span><br><span class="line">        <span class="string">"id"</span>:<span class="number">1</span>,</span><br><span class="line">        <span class="string">"account"</span>:<span class="string">"1"</span>,</span><br><span class="line">        <span class="string">"nickaname"</span>:<span class="string">"1"</span>,</span><br><span class="line">        <span class="string">"avatar"</span>:<span class="string">"ss"</span></span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

<h3 id="3-9-2-编码"><a href="#3-9-2-编码" class="headerlink" title="3.9.2 编码"></a>3.9.2 编码</h3><h4 id="①-LoginUserVo参数类"><a href="#①-LoginUserVo参数类" class="headerlink" title="① LoginUserVo参数类"></a>① LoginUserVo参数类</h4><p>对于登陆的用户，只需获取以下信息：</p>
<figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">LoginUserVo</span> </span>{</span><br><span class="line">    <span class="keyword">private</span> String id;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> String account;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> String nickname;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> String avatar;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

<h4 id="②-UserController控制类"><a href="#②-UserController控制类" class="headerlink" title="② UserController控制类"></a>② UserController控制类</h4><figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="meta">@RequestMapping("/users")</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">UserController</span> </span>{</span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> SysUserService sysUserService;</span><br><span class="line">    <span class="meta">@GetMapping("/currentUser")</span></span><br><span class="line">    <span class="comment">//返回当前用户信息</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Result <span class="title">currentUser</span><span class="params">(<span class="meta">@RequestHeader("Authorization")</span> String token)</span></span>{</span><br><span class="line">        <span class="keyword">return</span> sysUserService.findUserByToken(token);</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

<h4 id="③-SysUserService服务类"><a href="#③-SysUserService服务类" class="headerlink" title="③ SysUserService服务类"></a>③ SysUserService服务类</h4><figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">SysUserService</span> </span>{</span><br><span class="line">    <span class="comment">//添加以下方法，通过token找到对应用户</span></span><br><span class="line">    <span class="function">Result <span class="title">findUserByToken</span><span class="params">(String token)</span></span>;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

<h4 id="④-SysUserServiceImpl实现类"><a href="#④-SysUserServiceImpl实现类" class="headerlink" title="④ SysUserServiceImpl实现类"></a>④ SysUserServiceImpl实现类</h4><figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SysUserServiceImpl</span> <span class="keyword">implements</span> <span class="title">SysUserService</span> </span>{</span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> SysUserMapper sysUserMapper;</span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> LoginService loginService;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Result <span class="title">findUserByToken</span><span class="params">(String token)</span> </span>{</span><br><span class="line">        <span class="comment">/**</span></span><br><span class="line"><span class="comment">         * 1、token合法性校验</span></span><br><span class="line"><span class="comment">         * 是否为空 ，解析是否成功，redis是否存在</span></span><br><span class="line"><span class="comment">         * 2、如果校验失败，返回错误</span></span><br><span class="line"><span class="comment">         *3、如果成功，返回对应结果 LoginUserVo</span></span><br><span class="line"><span class="comment">         */</span></span><br><span class="line">        SysUser sysUser = loginService.checkToken(token);<span class="comment">//调用loginService的checkToken来检查token合法性</span></span><br><span class="line">        <span class="keyword">if</span>(sysUser==<span class="keyword">null</span>){</span><br><span class="line">            <span class="keyword">return</span> Result.fail(ErrorCode.TOKEN_ERROR.getCode(), ErrorCode.TOKEN_ERROR.getMsg());</span><br><span class="line">        }</span><br><span class="line">        LoginUserVo loginUserVo=<span class="keyword">new</span> LoginUserVo();</span><br><span class="line">        BeanUtils.copyProperties(sysUser,loginUserVo);</span><br><span class="line">        loginUserVo.setId(String.valueOf(sysUser.getId()));</span><br><span class="line">        <span class="keyword">return</span> Result.success(loginUserVo);</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

<h4 id="⑤-LoginService服务类"><a href="#⑤-LoginService服务类" class="headerlink" title="⑤ LoginService服务类"></a>⑤ LoginService服务类</h4><figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">LoginService</span> </span>{</span><br><span class="line">    <span class="comment">//添加以下方法，来检查token合法性，若合法，则将其对应的redis缓存转化成sysUser实体类返回</span></span><br><span class="line">    <span class="function">SysUser <span class="title">checkToken</span><span class="params">(String token)</span></span>;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

<h4 id="⑥-LoginServiceImpl实现类"><a href="#⑥-LoginServiceImpl实现类" class="headerlink" title="⑥ LoginServiceImpl实现类"></a>⑥ LoginServiceImpl实现类</h4><figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">LoginServiceImpl</span> <span class="keyword">implements</span> <span class="title">LoginService</span> </span>{</span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> SysUserService sysUserService;</span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> RedisTemplate&lt;String,String&gt; redisTemplate;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> SysUser <span class="title">checkToken</span><span class="params">(String token)</span> </span>{</span><br><span class="line">        <span class="comment">//如果token为空</span></span><br><span class="line">        <span class="keyword">if</span>(StringUtils.isEmpty(token)){</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">        }</span><br><span class="line">        Map&lt;String, Object&gt; stringObjectMap = JWTUtils.checkToken(token);</span><br><span class="line">        <span class="comment">//如果解析失败</span></span><br><span class="line">        <span class="keyword">if</span>(stringObjectMap ==<span class="keyword">null</span>){</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">        }</span><br><span class="line">        <span class="comment">//如果redis中没有对应缓存</span></span><br><span class="line">        String userJson =  redisTemplate.opsForValue().get(<span class="string">"TOKEN_"</span>+token);</span><br><span class="line">        <span class="keyword">if</span> (StringUtils.isEmpty(userJson)) {</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">        }</span><br><span class="line">        <span class="comment">//将redis中缓存的json对象转化为对应的SysUser对象</span></span><br><span class="line">        SysUser sysUser = JSON.parseObject(userJson, SysUser.class);</span><br><span class="line">        <span class="keyword">return</span> sysUser;</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

<h3 id="3-9-3-测试结果"><a href="#3-9-3-测试结果" class="headerlink" title="3.9.3 测试结果"></a>3.9.3 测试结果</h3><p><img src="C:\Users\95671\AppData\Roaming\Typora\typora-user-images\image-20220121114533487.png" alt="image-20220121114533487"></p>
<p>成功获取用户信息</p>
<h2 id="3-10-退出登录功能"><a href="#3-10-退出登录功能" class="headerlink" title="3.10 退出登录功能"></a>3.10 退出登录功能</h2><h3 id="3-10-1-接口说明"><a href="#3-10-1-接口说明" class="headerlink" title="3.10.1 接口说明"></a>3.10.1 接口说明</h3><ul>
<li><p>登陆时，对token进行认证，同时在redis中进行注册，token字符串没法更改掉，只能由前端进行清除，后端能做的就是把redis进行清除</p>
</li>
<li><p>接口url：/logout</p>
</li>
<li><p>请求方式：GET</p>
</li>
<li><p>请求参数：</p>
</li>
</ul>
<table>
<thead>
<tr>
<th>参数名称</th>
<th>参数类型</th>
<th>说明</th>
</tr>
</thead>
<tbody><tr>
<td>Authorization</td>
<td>string</td>
<td>头部信息(TOKEN)</td>
</tr>
</tbody></table>
<ul>
<li>返回数据：</li>
</ul>
<figure class="highlight js"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">{</span><br><span class="line">    <span class="string">"success"</span>: <span class="literal">true</span>,</span><br><span class="line">    <span class="string">"code"</span>: <span class="number">200</span>,</span><br><span class="line">    <span class="string">"msg"</span>: <span class="string">"success"</span>,</span><br><span class="line">    <span class="string">"data"</span>: <span class="literal">null</span></span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

<h3 id="3-10-2-编码"><a href="#3-10-2-编码" class="headerlink" title="3.10.2 编码"></a>3.10.2 编码</h3><h4 id="①-LogoutController控制类"><a href="#①-LogoutController控制类" class="headerlink" title="① LogoutController控制类"></a>① LogoutController控制类</h4><figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="meta">@RequestMapping("/logout")</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">LogoutController</span> </span>{</span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> LoginService loginService;</span><br><span class="line">    <span class="meta">@GetMapping</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Result <span class="title">logout</span><span class="params">(<span class="meta">@RequestHeader("Authorization")</span> String token)</span></span>{</span><br><span class="line">        <span class="keyword">return</span> loginService.logout(token);</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

<h4 id="②-LoginService服务类"><a href="#②-LoginService服务类" class="headerlink" title="② LoginService服务类"></a>② LoginService服务类</h4><figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">LoginService</span> </span>{</span><br><span class="line">    <span class="comment">//添加以下方法，用于退出登陆</span></span><br><span class="line">    <span class="function">Result <span class="title">logout</span><span class="params">(String token)</span></span>;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

<h4 id="③-LoginServiceImpl实现类"><a href="#③-LoginServiceImpl实现类" class="headerlink" title="③ LoginServiceImpl实现类"></a>③ LoginServiceImpl实现类</h4><figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">LoginServiceImpl</span> <span class="keyword">implements</span> <span class="title">LoginService</span> </span>{</span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> SysUserService sysUserService;</span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> RedisTemplate&lt;String,String&gt; redisTemplate;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//传入token，并调用RedisTemplate的delete方法将redis中的token对应的缓存删除</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Result <span class="title">logout</span><span class="params">(String token)</span> </span>{</span><br><span class="line">        redisTemplate.delete(<span class="string">"TOKEN_"</span>+token);</span><br><span class="line">        <span class="keyword">return</span> Result.success(<span class="keyword">null</span>);</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

<h2 id="3-11-注册功能"><a href="#3-11-注册功能" class="headerlink" title="3.11 注册功能"></a>3.11 注册功能</h2><h3 id="3-11-1-接口说明"><a href="#3-11-1-接口说明" class="headerlink" title="3.11.1 接口说明"></a>3.11.1 接口说明</h3><ul>
<li><p>接口url：/register</p>
</li>
<li><p>请求方式：POST</p>
</li>
<li><p>请求参数：</p>
</li>
</ul>
<table>
<thead>
<tr>
<th>参数名称</th>
<th>参数类型</th>
<th>说明</th>
</tr>
</thead>
<tbody><tr>
<td>account</td>
<td>string</td>
<td>账号</td>
</tr>
<tr>
<td>password</td>
<td>string</td>
<td>密码</td>
</tr>
<tr>
<td>nickname</td>
<td>string</td>
<td>昵称</td>
</tr>
</tbody></table>
<ul>
<li>返回数据：</li>
</ul>
<figure class="highlight js"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">{</span><br><span class="line">    <span class="string">"success"</span>: <span class="literal">true</span>,</span><br><span class="line">    <span class="string">"code"</span>: <span class="number">200</span>,</span><br><span class="line">    <span class="string">"msg"</span>: <span class="string">"success"</span>,</span><br><span class="line">    <span class="string">"data"</span>: <span class="string">"token"</span></span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

<h3 id="3-11-2-编码"><a href="#3-11-2-编码" class="headerlink" title="3.11.2 编码"></a>3.11.2 编码</h3><h4 id="①-RegisterParam参数类"><a href="#①-RegisterParam参数类" class="headerlink" title="① RegisterParam参数类"></a>① RegisterParam参数类</h4><figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">RegisterParam</span> </span>{</span><br><span class="line">    <span class="keyword">private</span> String account;</span><br><span class="line">    <span class="keyword">private</span> String password;</span><br><span class="line">    <span class="keyword">private</span> String nickname;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

<h4 id="②-RegisterController控制类"><a href="#②-RegisterController控制类" class="headerlink" title="② RegisterController控制类"></a>② RegisterController控制类</h4><figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="meta">@RequestMapping("/register")</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">RegisterController</span> </span>{</span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> RegisterService registerService;</span><br><span class="line">    <span class="meta">@PostMapping</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Result <span class="title">register</span><span class="params">(<span class="meta">@RequestBody</span> RegisterParam registerParam)</span></span>{</span><br><span class="line">        <span class="keyword">return</span> registerService.register(registerParam);</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

<h4 id="③-RegisterService服务类"><a href="#③-RegisterService服务类" class="headerlink" title="③ RegisterService服务类"></a>③ RegisterService服务类</h4><figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">RegisterService</span> </span>{</span><br><span class="line">    <span class="function">Result <span class="title">register</span><span class="params">(RegisterParam registerParam)</span></span>;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

<h4 id="④-RegisterServiceImpl实现类"><a href="#④-RegisterServiceImpl实现类" class="headerlink" title="④ RegisterServiceImpl实现类"></a>④ RegisterServiceImpl实现类</h4><figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="meta">@Transactional</span><span class="comment">//添加事务注解，一般添加在接口处比较合理，但是添加在实现类上也行</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">RegisterServiceImpl</span> <span class="keyword">implements</span> <span class="title">RegisterService</span></span>{</span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> SysUserService sysUserService;</span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> RedisTemplate&lt;String,String&gt; redisTemplate;</span><br><span class="line">    <span class="comment">//加密盐用于加密</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> String slat = <span class="string">"mszlu!@#"</span>;</span><br><span class="line">    </span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Result <span class="title">register</span><span class="params">(RegisterParam registerParam)</span> </span>{</span><br><span class="line">        <span class="comment">/**</span></span><br><span class="line"><span class="comment">         * 1. 判断参数 是否合法</span></span><br><span class="line"><span class="comment">         * 2. 判断账户是否存在，存在 返回账户已经被注册</span></span><br><span class="line"><span class="comment">         * 3. 不存在，注册用户</span></span><br><span class="line"><span class="comment">         * 4. 生成token</span></span><br><span class="line"><span class="comment">         * 5. 存入redis 并返回</span></span><br><span class="line"><span class="comment">         * 6. 注意加上事务，一旦中间的任何过程出现问题，注册的用户需要回滚</span></span><br><span class="line"><span class="comment">         */</span></span><br><span class="line">        String account = registerParam.getAccount();</span><br><span class="line">        String password = registerParam.getPassword();</span><br><span class="line">        String nickname = registerParam.getNickname();</span><br><span class="line">        <span class="comment">//若账户、密码或用户名某一项为空</span></span><br><span class="line">        <span class="keyword">if</span>(StringUtils.isEmpty(account)||StringUtils.isEmpty(password)||StringUtils.isEmpty(nickname)){</span><br><span class="line">            <span class="keyword">return</span> Result.fail(ErrorCode.PARAMS_ERROR.getCode(), ErrorCode.PARAMS_ERROR.getMsg());</span><br><span class="line">        }</span><br><span class="line">        SysUser sysUser=sysUserService.findUserByAccount(account);</span><br><span class="line">        <span class="comment">//若不存在此账户</span></span><br><span class="line">        <span class="keyword">if</span>(sysUser!=<span class="keyword">null</span>){</span><br><span class="line">            <span class="keyword">return</span> Result.fail(ErrorCode.ACCOUNT_EXIST.getCode(), ErrorCode.ACCOUNT_EXIST.getMsg());</span><br><span class="line">        }</span><br><span class="line">        <span class="comment">//设置基本参数</span></span><br><span class="line">        sysUser = <span class="keyword">new</span> SysUser();</span><br><span class="line">        sysUser.setNickname(nickname);</span><br><span class="line">        sysUser.setAccount(account);</span><br><span class="line">        sysUser.setPassword(DigestUtils.md5Hex(password+slat));</span><br><span class="line">        sysUser.setCreateDate(System.currentTimeMillis());</span><br><span class="line">        sysUser.setLastLogin(System.currentTimeMillis());</span><br><span class="line">        sysUser.setAvatar(<span class="string">"/static/img/logo.b3a48c0.png"</span>);</span><br><span class="line">        sysUser.setAdmin(<span class="number">1</span>); <span class="comment">//1 为true</span></span><br><span class="line">        sysUser.setDeleted(<span class="number">0</span>); <span class="comment">// 0 为false</span></span><br><span class="line">        sysUser.setSalt(<span class="string">""</span>);</span><br><span class="line">        sysUser.setStatus(<span class="string">""</span>);</span><br><span class="line">        sysUser.setEmail(<span class="string">""</span>);</span><br><span class="line">        sysUserService.save(sysUser);</span><br><span class="line">        <span class="comment">//创造对应token并存入redis中</span></span><br><span class="line">        String token= JWTUtils.createToken(sysUser.getId());</span><br><span class="line">        redisTemplate.opsForValue().set(<span class="string">"TOKEN_"</span>+token, JSON.toJSONString(sysUser),<span class="number">1</span>, TimeUnit.DAYS);</span><br><span class="line">        <span class="keyword">return</span> Result.success(token);</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

<h4 id="⑤-SysUserService服务类-1"><a href="#⑤-SysUserService服务类-1" class="headerlink" title="⑤ SysUserService服务类"></a>⑤ SysUserService服务类</h4><figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">SysUserService</span> </span>{</span><br><span class="line">    <span class="function">SysUser <span class="title">findUserByAccount</span><span class="params">(String account)</span></span>;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">save</span><span class="params">(SysUser sysUser)</span></span>;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

<h4 id="⑥-SysUserServiceImpl实现类-1"><a href="#⑥-SysUserServiceImpl实现类-1" class="headerlink" title="⑥ SysUserServiceImpl实现类"></a>⑥ SysUserServiceImpl实现类</h4><figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SysUserServiceImpl</span> <span class="keyword">implements</span> <span class="title">SysUserService</span> </span>{</span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> SysUserMapper sysUserMapper;</span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> LoginService loginService;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">//根据账户找到对应用户</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> SysUser <span class="title">findUserByAccount</span><span class="params">(String account)</span> </span>{</span><br><span class="line">        LambdaQueryWrapper&lt;SysUser&gt; queryWrapper=<span class="keyword">new</span> LambdaQueryWrapper();</span><br><span class="line">        queryWrapper.eq(SysUser::getAccount,account);</span><br><span class="line">        queryWrapper.last(<span class="string">"limit 1"</span>);</span><br><span class="line">        sysUserMapper.selectOne(queryWrapper);</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="comment">//保存用户</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">save</span><span class="params">(SysUser sysUser)</span> </span>{</span><br><span class="line">        sysUserMapper.insert(sysUser);</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

<h3 id="3-11-3-测试结果"><a href="#3-11-3-测试结果" class="headerlink" title="3.11.3 测试结果"></a>3.11.3 测试结果</h3><p><img src="C:\Users\95671\AppData\Roaming\Typora\typora-user-images\image-20220123133820901.png" alt="image-20220123133820901"></p>
<h2 id="3-12-登陆拦截器"><a href="#3-12-登陆拦截器" class="headerlink" title="3.12 登陆拦截器"></a>3.12 登陆拦截器</h2><h3 id="3-12-1-功能说明"><a href="#3-12-1-功能说明" class="headerlink" title="3.12.1 功能说明"></a>3.12.1 功能说明</h3><p>每次访问需要登录的资源的时候，都需要在代码中进行判断，一旦登录的逻辑有所改变，代码都得进行变动，非常不合适。</p>
<p>故需要使用登陆拦截器统一进行登录拦截，遇到需要登录才能访问的接口时，如果未登录，拦截器直接返回，并跳转登录页面。</p>
<h3 id="3-12-2-拦截器实现"><a href="#3-12-2-拦截器实现" class="headerlink" title="3.12.2 拦截器实现"></a>3.12.2 拦截器实现</h3><h4 id="①-LoginInterceptor"><a href="#①-LoginInterceptor" class="headerlink" title="① LoginInterceptor"></a>① LoginInterceptor</h4><figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">LoginInterceptor</span> <span class="keyword">implements</span> <span class="title">HandlerInterceptor</span></span>{</span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> LoginService loginService;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">preHandle</span><span class="params">(HttpServletRequest request, HttpServletResponse response, Object handler)</span> <span class="keyword">throws</span> Exception </span>{</span><br><span class="line">        <span class="comment">//在执行controller方法之前进行执行</span></span><br><span class="line">        <span class="comment">/**</span></span><br><span class="line"><span class="comment">         * 1. 需要判断 请求的接口路径是否为 HandlerMethod (controller方法)</span></span><br><span class="line"><span class="comment">         * 2. 判断 token 是否为空，如果为空，则说明未登录</span></span><br><span class="line"><span class="comment">         * 3. 如果 token 不为空，则进行登录验证：loginService.checkToken(token)</span></span><br><span class="line"><span class="comment">         * 4. 如果认证成功，放行</span></span><br><span class="line"><span class="comment">         */</span></span><br><span class="line">        <span class="comment">//如果请求的路劲不是controller中包含的路径，直接放行，因为handler有可能是访问静态资源的</span></span><br><span class="line">        <span class="keyword">if</span>(!(handler <span class="keyword">instanceof</span> HandlerMethod)){</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">        }</span><br><span class="line">        <span class="comment">//从请求头中获取token</span></span><br><span class="line">        String token = request.getHeader(<span class="string">"Authorization"</span>);</span><br><span class="line">        <span class="keyword">if</span>(StringUtils.isEmpty(token)){<span class="comment">//若token为空，不放行</span></span><br><span class="line">            Result result = Result.fail(ErrorCode.NO_LOGIN.getCode(), ErrorCode.NO_LOGIN.getMsg());</span><br><span class="line">            <span class="comment">//设置浏览器识别返回的是json</span></span><br><span class="line">            response.setContentType(<span class="string">"application/json;charset=utf-8"</span>);</span><br><span class="line">            <span class="comment">//SON.toJSONString则是将对象转化为Json字符串</span></span><br><span class="line">            response.getWriter().print(JSON.toJSONString(result));</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">        }</span><br><span class="line">        SysUser sysUser = loginService.checkToken(token);</span><br><span class="line">        <span class="keyword">if</span> (sysUser == <span class="keyword">null</span>){<span class="comment">//如果由token得到的用户为空，不放行</span></span><br><span class="line">            Result result = Result.fail(ErrorCode.NO_LOGIN.getCode(), ErrorCode.NO_LOGIN.getMsg());</span><br><span class="line">            response.setContentType(<span class="string">"application/json;charset=utf-8"</span>);</span><br><span class="line">            response.getWriter().print(JSON.toJSONString(result));</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">        }</span><br><span class="line">        UserThreadLocal.put(sysUser);</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

<h4 id="②-配置拦截器"><a href="#②-配置拦截器" class="headerlink" title="② 配置拦截器"></a>② 配置拦截器</h4><ul>
<li>去配置类中将该拦截器配置进去</li>
</ul>
<figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">WebConfig</span> <span class="keyword">implements</span> <span class="title">WebMvcConfigurer</span> </span>{</span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> LoginInterceptor loginInterceptor;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">addInterceptors</span><span class="params">(InterceptorRegistry registry)</span> </span>{</span><br><span class="line">        <span class="comment">//假设拦截test接口，后续实际遇到拦截的接口时，再配置真正的拦截接口</span></span><br><span class="line">        registry.addInterceptor(loginInterceptor)</span><br><span class="line">                .addPathPatterns(<span class="string">"/test"</span>);</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

<h3 id="3-12-3-测试结果"><a href="#3-12-3-测试结果" class="headerlink" title="3.12.3 测试结果"></a>3.12.3 测试结果</h3><figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="meta">@RequestMapping("test")</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TestController</span> </span>{</span><br><span class="line">    <span class="meta">@RequestMapping</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Result <span class="title">test</span><span class="params">()</span></span>{</span><br><span class="line">        <span class="keyword">return</span> Result.success(<span class="keyword">null</span>);</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<ul>
<li>在postman中发送请求</li>
</ul>
<p><img src="C:\Users\95671\AppData\Roaming\Typora\typora-user-images\image-20220123135315341.png" alt="image-20220123135315341"></p>
<h2 id="3-13-Threadlocal保存用户信息"><a href="#3-13-Threadlocal保存用户信息" class="headerlink" title="3.13 Threadlocal保存用户信息"></a>3.13 Threadlocal保存用户信息</h2><ul>
<li>使用Threadlocal可以将某个用户的信息放在一个线程中</li>
<li>有多个用户则创建多个线程，每个线程仅存储一个用户信息，这样可以保证线程安全</li>
<li>当然线程内除了用户信息，也可以存放其他信息</li>
<li>用户信息明明已经和token一起存储在redis中了，为什么还要用Threadlocal？<ul>
<li>因为不方便！要获取用户信息就要用LoginService.checkToken(token)，若有的controller需要用户信息，就要先获取token，再注入LoginService，再调用checkToken(token)方法</li>
</ul>
</li>
</ul>
<h3 id="3-13-1-实现流程"><a href="#3-13-1-实现流程" class="headerlink" title="3.13.1 实现流程"></a>3.13.1 实现流程</h3><ul>
<li>在登录业务代码中，当用户登录成功时，生成一个登录凭证存储到redis中</li>
<li>将凭证中的字符串保存在cookie中返回给客户端</li>
<li>使用一个拦截器拦截请求，从cookie中获取凭证字符串与redis中的凭证进行匹配，获取用户信息</li>
<li>将用户信息存储到ThreadLocal中，在本次请求中持有用户信息，即可在后续操作中使用到用户信息</li>
<li>当用户操作完成后，清除Threadlocal中的信息，否则会有内存泄漏风险</li>
<li>内存泄露原理如下<ul>
<li>实线代表强引用,虚线代表弱引用</li>
<li>每一个Thread维护一个ThreadLocalMap, key为使用弱引用的ThreadLocal实例，value为线程变量的副本。</li>
<li>强引用，使用最普遍的引用，一个对象具有强引用，不会被垃圾回收器回收。当内存空间不足，Java虚拟机宁愿抛出OutOfMemoryError错误，使程序异常终止，也不回收这种对象。</li>
<li>如果想取消强引用和某个对象之间的关联，可以显式地将引用赋值为null，这样可以使JVM在合适的时间就会回收该对象。</li>
<li>弱引用，JVM进行垃圾回收时，无论内存是否充足，都会回收被弱引用关联的对象。在java中，用java.lang.ref.WeakReference类来表示。</li>
</ul>
</li>
</ul>
<p><img src="C:\Users\95671\AppData\Roaming\Typora\typora-user-images\image-20220123141352666.png" alt="image-20220123141352666"></p>
<h3 id="3-14-1-编码"><a href="#3-14-1-编码" class="headerlink" title="3.14.1 编码"></a>3.14.1 编码</h3><h4 id="①-UserThreadLocal"><a href="#①-UserThreadLocal" class="headerlink" title="① UserThreadLocal"></a>① UserThreadLocal</h4><figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">UserThreadLocal</span> </span>{</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="title">UserThreadLocal</span><span class="params">()</span></span>{}</span><br><span class="line">    <span class="comment">//线程变量隔离</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> ThreadLocal&lt;SysUser&gt; LOCAL = <span class="keyword">new</span> ThreadLocal&lt;&gt;();</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">put</span><span class="params">(SysUser sysUser)</span></span>{</span><br><span class="line">        LOCAL.set(sysUser);</span><br><span class="line">    }</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> SysUser <span class="title">get</span><span class="params">()</span></span>{</span><br><span class="line">        <span class="keyword">return</span> LOCAL.get();</span><br><span class="line">    }</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">remove</span><span class="params">()</span></span>{</span><br><span class="line">        LOCAL.remove();</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

<h4 id="②-清理ThreadLocal信息"><a href="#②-清理ThreadLocal信息" class="headerlink" title="② 清理ThreadLocal信息"></a>② 清理ThreadLocal信息</h4><figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">LoginInterceptor</span> <span class="keyword">implements</span> <span class="title">HandlerInterceptor</span></span>{</span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> LoginService loginService;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//afterCompletion：在所有操作完成后</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">afterCompletion</span><span class="params">(HttpServletRequest request, HttpServletResponse response, Object handler, Exception ex)</span> <span class="keyword">throws</span> Exception </span>{</span><br><span class="line">        <span class="comment">//如果不删除 ThreadLocal中用完的信息 会有内存泄漏的风险</span></span><br><span class="line">        UserThreadLocal.remove();</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

<h2 id="3-14-文章详情功能"><a href="#3-14-文章详情功能" class="headerlink" title="3.14 文章详情功能"></a>3.14 文章详情功能</h2><h3 id="3-14-1-接口说明"><a href="#3-14-1-接口说明" class="headerlink" title="3.14.1 接口说明"></a>3.14.1 接口说明</h3><ul>
<li><p>接口url：/articles/view/{id}</p>
</li>
<li><p>请求方式：POST</p>
</li>
<li><p>请求参数：</p>
</li>
</ul>
<table>
<thead>
<tr>
<th>参数名称</th>
<th>参数类型</th>
<th>说明</th>
</tr>
</thead>
<tbody><tr>
<td>id</td>
<td>long</td>
<td>文章id（路径参数）</td>
</tr>
</tbody></table>
<ul>
<li>返回数据：</li>
</ul>
<figure class="highlight js"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">{</span><br><span class="line">    <span class="string">"success"</span>: <span class="literal">true</span>,</span><br><span class="line">    <span class="string">"code"</span>: <span class="number">200</span>,</span><br><span class="line">    <span class="string">"msg"</span>: <span class="string">"success"</span>,</span><br><span class="line">    <span class="string">"data"</span>: {</span><br><span class="line">        <span class="attr">id</span>: <span class="string">"1405916999732707330"</span>, </span><br><span class="line">        <span class="attr">title</span>: <span class="string">"SpringBoot入门案例"</span>,</span><br><span class="line">        <span class="attr">summary</span>: <span class="string">"springboot入门案例"</span>,</span><br><span class="line">        <span class="attr">commentCounts</span>: <span class="number">0</span></span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

<h3 id="3-14-2-编码"><a href="#3-14-2-编码" class="headerlink" title="3.14.2 编码"></a>3.14.2 编码</h3><h4 id="①-ArticleBody和Catelogy实体类"><a href="#①-ArticleBody和Catelogy实体类" class="headerlink" title="① ArticleBody和Catelogy实体类"></a>① ArticleBody和Catelogy实体类</h4><figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ArticleBody</span> </span>{</span><br><span class="line">    <span class="keyword">private</span> Long id;</span><br><span class="line">    <span class="keyword">private</span> String content;</span><br><span class="line">    <span class="keyword">private</span> String contentHtml;</span><br><span class="line">    <span class="keyword">private</span> Long articleId;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

<figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Category</span> </span>{</span><br><span class="line">    <span class="keyword">private</span> Long id;</span><br><span class="line">    <span class="keyword">private</span> String avatar;</span><br><span class="line">    <span class="keyword">private</span> String categoryName;</span><br><span class="line">    <span class="keyword">private</span> String description;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>



<h4 id="②-ArticleBodyVo、CatelogyVo和ArticleVo类"><a href="#②-ArticleBodyVo、CatelogyVo和ArticleVo类" class="headerlink" title="② ArticleBodyVo、CatelogyVo和ArticleVo类"></a>② ArticleBodyVo、CatelogyVo和ArticleVo类</h4><figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ArticleBodyVo</span> </span>{</span><br><span class="line">    <span class="keyword">private</span> String content;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

<figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">CategoryVo</span> </span>{</span><br><span class="line">    <span class="keyword">private</span> String id;</span><br><span class="line">    <span class="keyword">private</span> String avatar;</span><br><span class="line">    <span class="keyword">private</span> String categoryName;</span><br><span class="line">    <span class="keyword">private</span> String description;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

<figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ArticleVo</span> </span>{</span><br><span class="line">    <span class="comment">//添加以下两项</span></span><br><span class="line">    <span class="keyword">private</span> ArticleBodyVo body;</span><br><span class="line">    <span class="keyword">private</span> CategoryVo categoryVo;</span><br><span class="line"></span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

<h4 id="③-ArticleController控制类"><a href="#③-ArticleController控制类" class="headerlink" title="③ ArticleController控制类"></a>③ ArticleController控制类</h4><figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="meta">@RequestMapping("/articles")</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ArticleController</span> </span>{</span><br><span class="line">    </span><br><span class="line">    <span class="meta">@PostMapping("/view/{id}")</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Result <span class="title">findArticleById</span><span class="params">(<span class="meta">@PathVariable("id")</span> Long articleId)</span></span>{</span><br><span class="line">        <span class="comment">//通过文章id找到对应文章</span></span><br><span class="line">        <span class="keyword">return</span> articleService.findArticleById(articleId);</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

<h4 id="④-ArticleService服务类"><a href="#④-ArticleService服务类" class="headerlink" title="④ ArticleService服务类"></a>④ ArticleService服务类</h4><figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">ArticleService</span> </span>{</span><br><span class="line">    <span class="comment">//添加以下方法，通过文章id找到对应文章</span></span><br><span class="line">    <span class="function">Result <span class="title">findArticleById</span><span class="params">(Long articleId)</span></span>;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

<h4 id="⑤-ArticleServiceImpl实现类"><a href="#⑤-ArticleServiceImpl实现类" class="headerlink" title="⑤ ArticleServiceImpl实现类"></a>⑤ ArticleServiceImpl实现类</h4><figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ArticleServiceImpl</span> <span class="keyword">implements</span> <span class="title">ArticleService</span> </span>{</span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> ArticleMapper articleMapper;</span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> TagService tagService;</span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> SysUserService sysUserService;</span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> ArticleBodyMapper articleBodyMapper;</span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> CategoryMapper categoryMapper;</span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> CategoryService categoryService;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Result <span class="title">findArticleById</span><span class="params">(Long articleId)</span> </span>{</span><br><span class="line">        Article article = articleMapper.selectById(articleId);</span><br><span class="line">        ArticleVo articleVo = copy(article, <span class="keyword">true</span>, <span class="keyword">true</span>,<span class="keyword">true</span>,<span class="keyword">true</span>);</span><br><span class="line">        <span class="keyword">return</span> Result.success(articleVo);</span><br><span class="line">    }</span><br><span class="line">    ----------------------------------------------------------------------------------------</span><br><span class="line">    <span class="comment">//因为有的页面需要ArticleBody和Category数据，有的不需要，故进行重载</span></span><br><span class="line">    <span class="function"><span class="keyword">private</span> List&lt;ArticleVo&gt; <span class="title">copyList</span><span class="params">(List&lt;Article&gt; records,<span class="keyword">boolean</span> isTag,<span class="keyword">boolean</span> isAuthor)</span> </span>{</span><br><span class="line">        List&lt;ArticleVo&gt; articleVoList=<span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line">        <span class="keyword">for</span> (Article record : records) {</span><br><span class="line">            articleVoList.add(copy(record,isTag,isAuthor,<span class="keyword">false</span>,<span class="keyword">false</span>));</span><br><span class="line">        }</span><br><span class="line">        <span class="keyword">return</span> articleVoList;</span><br><span class="line">    }</span><br><span class="line">    <span class="function"><span class="keyword">private</span> List&lt;ArticleVo&gt; <span class="title">copyList</span><span class="params">(List&lt;Article&gt; records,<span class="keyword">boolean</span> isTag,<span class="keyword">boolean</span> isAuthor,<span class="keyword">boolean</span> isArticleBody,<span class="keyword">boolean</span> isCategory)</span> </span>{</span><br><span class="line">        List&lt;ArticleVo&gt; articleVoList=<span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line">        <span class="keyword">for</span> (Article record : records) {</span><br><span class="line">            articleVoList.add(copy(record,isTag,isAuthor,isArticleBody,isCategory));</span><br><span class="line">        }</span><br><span class="line">        <span class="keyword">return</span> articleVoList;</span><br><span class="line">    }</span><br><span class="line">    -----------------------------------------------------------------------------------------</span><br><span class="line">    </span><br><span class="line">    <span class="comment">//新增isArticleBody和isCategory</span></span><br><span class="line">    <span class="function"><span class="keyword">private</span> ArticleVo <span class="title">copy</span><span class="params">(Article article,<span class="keyword">boolean</span> isTag,<span class="keyword">boolean</span> isAuthor,<span class="keyword">boolean</span> isArticleBody,<span class="keyword">boolean</span> isCategory)</span></span>{</span><br><span class="line">        ArticleVo articleVo=<span class="keyword">new</span> ArticleVo();</span><br><span class="line">        BeanUtils.copyProperties(article,articleVo);</span><br><span class="line">        articleVo.setId(String.valueOf(article.getId()));</span><br><span class="line">        articleVo.setCreateDate(<span class="keyword">new</span> DateTime(article.getCreateDate()).toString(<span class="string">"yyyy-MM-dd HH:mm"</span>));</span><br><span class="line">        <span class="keyword">if</span>(isTag){</span><br><span class="line">            Long articleId = article.getId();</span><br><span class="line">            articleVo.setTags(tagService.findTagsByArticleId(articleId));</span><br><span class="line">        }</span><br><span class="line">        <span class="keyword">if</span>(isAuthor){</span><br><span class="line">            Long authorId = article.getAuthorId();</span><br><span class="line">            articleVo.setAuthor(sysUserService.findUserById(authorId).getNickname());</span><br><span class="line">        }</span><br><span class="line">        <span class="keyword">if</span>(isArticleBody){</span><br><span class="line">            Long bodyId = article.getBodyId();</span><br><span class="line">            <span class="comment">//调用ArticleService的findArticleBodyById方法</span></span><br><span class="line">            articleVo.setBody(findArticleBodyById(bodyId));</span><br><span class="line">        }</span><br><span class="line">        <span class="keyword">if</span>(isCategory){</span><br><span class="line">            Long categoryId = article.getCategoryId();</span><br><span class="line">            <span class="comment">//调用CategoryService的findCategoryById方法</span></span><br><span class="line">            articleVo.setCategoryVo(categoryService.findCategoryById(categoryId));</span><br><span class="line">        }</span><br><span class="line">        <span class="keyword">return</span> articleVo;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="comment">//通过文章的bodyId找到其对应的ArticleBody</span></span><br><span class="line">    <span class="function"><span class="keyword">private</span> ArticleBodyVo <span class="title">findArticleBodyById</span><span class="params">(Long bodyId)</span> </span>{</span><br><span class="line">        ArticleBody articleBody=articleBodyMapper.selectById(bodyId);</span><br><span class="line">        ArticleBodyVo articleBodyVo=<span class="keyword">new</span> ArticleBodyVo();</span><br><span class="line">        articleBodyVo.setContent(articleBody.getContent());</span><br><span class="line">        <span class="keyword">return</span> articleBodyVo;</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

<h4 id="⑥-CategoryService服务类"><a href="#⑥-CategoryService服务类" class="headerlink" title="⑥ CategoryService服务类"></a>⑥ CategoryService服务类</h4><figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">CategoryService</span> </span>{</span><br><span class="line">    <span class="comment">//通过文章的categoryId找到对应的category</span></span><br><span class="line">    <span class="function">CategoryVo <span class="title">findCategoryById</span><span class="params">(Long categoryId)</span></span>;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

<h4 id="⑦-CategoryServiceImpl实现类"><a href="#⑦-CategoryServiceImpl实现类" class="headerlink" title="⑦ CategoryServiceImpl实现类"></a>⑦ CategoryServiceImpl实现类</h4><figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">CategoryServiceImpl</span> <span class="keyword">implements</span> <span class="title">CategoryService</span> </span>{</span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> CategoryMapper categoryMapper;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> CategoryVo <span class="title">findCategoryById</span><span class="params">(Long categoryId)</span> </span>{</span><br><span class="line">        Category category = categoryMapper.selectById(categoryId);</span><br><span class="line">        CategoryVo categoryVo = <span class="keyword">new</span> CategoryVo();</span><br><span class="line">        BeanUtils.copyProperties(category,categoryVo);</span><br><span class="line">        categoryVo.setId(String.valueOf(category.getId()));</span><br><span class="line">        <span class="keyword">return</span> categoryVo;</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

<h3 id="3-14-3-测试结果"><a href="#3-14-3-测试结果" class="headerlink" title="3.14.3 测试结果"></a>3.14.3 测试结果</h3><p><img src="C:\Users\95671\AppData\Roaming\Typora\typora-user-images\image-20220123165746946.png" alt="image-20220123165746946"></p>
<p>测试成功！</p>
<h2 id="3-15-更新阅读次数"><a href="#3-15-更新阅读次数" class="headerlink" title="3.15 更新阅读次数"></a>3.15 更新阅读次数</h2><h3 id="3-15-1-功能说明"><a href="#3-15-1-功能说明" class="headerlink" title="3.15.1 功能说明"></a>3.15.1 功能说明</h3><ul>
<li>点击查看文章之后，本应该直接返回数据了，这时候做了一个更新阅读次数操作，更新时加写锁，阻塞其他的读操作，性能就会比较低（没办法解决，增加阅读数必然要加锁）</li>
<li>更新增加了此次接口的耗时（考虑减少耗时），重点是：<strong>如果一旦更新出问题，查看操作必然受影响</strong></li>
<li>故使用线程池线程池，把更新操作扔到线程池中去执行，这样就不会影响主线程了</li>
</ul>
<h3 id="3-15-2-编码"><a href="#3-15-2-编码" class="headerlink" title="3.15.2 编码"></a>3.15.2 编码</h3><h4 id="①-线程池配置类"><a href="#①-线程池配置类" class="headerlink" title="① 线程池配置类"></a>① 线程池配置类</h4><figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="meta">@EnableAsync</span> <span class="comment">//开启多线程</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ThreadPoolConfig</span> </span>{</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Bean("taskExecutor")</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Executor <span class="title">asyncServiceExecutor</span><span class="params">()</span> </span>{</span><br><span class="line">        ThreadPoolTaskExecutor executor = <span class="keyword">new</span> ThreadPoolTaskExecutor();</span><br><span class="line">        <span class="comment">// 设置核心线程数</span></span><br><span class="line">        executor.setCorePoolSize(<span class="number">5</span>);</span><br><span class="line">        <span class="comment">// 设置最大线程数</span></span><br><span class="line">        executor.setMaxPoolSize(<span class="number">20</span>);</span><br><span class="line">        <span class="comment">//配置队列大小</span></span><br><span class="line">        executor.setQueueCapacity(Integer.MAX_VALUE);</span><br><span class="line">        <span class="comment">// 设置线程活跃时间（秒）</span></span><br><span class="line">        executor.setKeepAliveSeconds(<span class="number">60</span>);</span><br><span class="line">        <span class="comment">// 设置默认线程名称</span></span><br><span class="line">        executor.setThreadNamePrefix(<span class="string">"码神之路博客项目"</span>);</span><br><span class="line">        <span class="comment">// 等待所有任务结束后再关闭线程池</span></span><br><span class="line">        executor.setWaitForTasksToCompleteOnShutdown(<span class="keyword">true</span>);</span><br><span class="line">        <span class="comment">//执行初始化</span></span><br><span class="line">        executor.initialize();</span><br><span class="line">        <span class="keyword">return</span> executor;</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

<h4 id="②-线程服务类"><a href="#②-线程服务类" class="headerlink" title="② 线程服务类"></a>② 线程服务类</h4><figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ThreadService</span> </span>{</span><br><span class="line">    <span class="comment">//期望此操作在线程池执行不会影响原有主线程</span></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> ArticleMapper articleMapper;</span><br><span class="line">    <span class="meta">@Async("taskExecutor")</span><span class="comment">//命名要和配置类中线程池的命名相同</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">updateArticleViewCount</span><span class="params">(Article article)</span></span>{</span><br><span class="line">        Integer viewCounts=article.getViewCounts();<span class="comment">//获取阅读数</span></span><br><span class="line">        Article articleUpdate=<span class="keyword">new</span> Article();</span><br><span class="line">        articleUpdate.setViewCounts(viewCounts+<span class="number">1</span>);<span class="comment">//更新阅读数</span></span><br><span class="line">        LambdaUpdateWrapper&lt;Article&gt; updateWrapper=<span class="keyword">new</span> LambdaUpdateWrapper&lt;&gt;();</span><br><span class="line">        updateWrapper.eq(Article::getId,article.getId());<span class="comment">//匹配对应文章</span></span><br><span class="line">        updateWrapper.eq(Article::getViewCounts,viewCounts);<span class="comment">//更新阅读数之前要检查有无其他线程更新过阅读数（乐观锁）</span></span><br><span class="line">        articleMapper.update(articleUpdate,updateWrapper);</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

<h4 id="③-ArticleServiceImpl实现类-2"><a href="#③-ArticleServiceImpl实现类-2" class="headerlink" title="③ ArticleServiceImpl实现类"></a>③ ArticleServiceImpl实现类</h4><figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ArticleServiceImpl</span> <span class="keyword">implements</span> <span class="title">ArticleService</span> </span>{</span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> ThreadService threadService;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//再查看文章详情功能中加入ThreadService更新阅读数的方法</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Result <span class="title">findArticleById</span><span class="params">(Long articleId)</span> </span>{</span><br><span class="line">        Article article = articleMapper.selectById(articleId);</span><br><span class="line">        ArticleVo articleVo = copy(article, <span class="keyword">true</span>, <span class="keyword">true</span>,<span class="keyword">true</span>,<span class="keyword">true</span>);</span><br><span class="line">        threadService.updateArticleViewCount(article);</span><br><span class="line">        <span class="keyword">return</span> Result.success(articleVo);</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

<h3 id="3-15-3-测试结果"><a href="#3-15-3-测试结果" class="headerlink" title="3.15.3 测试结果"></a>3.15.3 测试结果</h3><p>能成功增加阅读数，但是不能实时更新，要手动刷新</p>
<h2 id="3-16-评论列表功能"><a href="#3-16-评论列表功能" class="headerlink" title="3.16 评论列表功能"></a>3.16 评论列表功能</h2><h3 id="3-16-1-接口说明"><a href="#3-16-1-接口说明" class="headerlink" title="3.16.1 接口说明"></a>3.16.1 接口说明</h3><ul>
<li><p>接口url：/comments/article/{id}</p>
</li>
<li><p>请求方式：GET</p>
</li>
<li><p>请求参数：</p>
</li>
</ul>
<table>
<thead>
<tr>
<th>参数名称</th>
<th>参数类型</th>
<th>说明</th>
</tr>
</thead>
<tbody><tr>
<td>id</td>
<td>long</td>
<td>文章id（路径参数）</td>
</tr>
</tbody></table>
<ul>
<li>返回数据：</li>
</ul>
<figure class="highlight js"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line">{</span><br><span class="line">    <span class="string">"success"</span>: <span class="literal">true</span>,</span><br><span class="line">    <span class="string">"code"</span>: <span class="number">200</span>,</span><br><span class="line">    <span class="string">"msg"</span>: <span class="string">"success"</span>,</span><br><span class="line">    <span class="string">"data"</span>: [</span><br><span class="line">        {</span><br><span class="line">            <span class="string">"id"</span>: <span class="number">53</span>,</span><br><span class="line">            <span class="string">"author"</span>: {</span><br><span class="line">                <span class="string">"nickname"</span>: <span class="string">"李四"</span>,</span><br><span class="line">                <span class="string">"avatar"</span>: <span class="string">"http://localhost:8080/static/img/logo.b3a48c0.png"</span>,</span><br><span class="line">                <span class="string">"id"</span>: <span class="number">1</span></span><br><span class="line">            },</span><br><span class="line">            <span class="string">"content"</span>: <span class="string">"写的好"</span>,</span><br><span class="line">            <span class="string">"childrens"</span>: [</span><br><span class="line">                {</span><br><span class="line">                    <span class="string">"id"</span>: <span class="number">54</span>,</span><br><span class="line">                    <span class="string">"author"</span>: {</span><br><span class="line">                        <span class="string">"nickname"</span>: <span class="string">"李四"</span>,</span><br><span class="line">                        <span class="string">"avatar"</span>: <span class="string">"http://localhost:8080/static/img/logo.b3a48c0.png"</span>,</span><br><span class="line">                        <span class="string">"id"</span>: <span class="number">1</span></span><br><span class="line">                    },</span><br><span class="line">                    <span class="string">"content"</span>: <span class="string">"111"</span>,</span><br><span class="line">                    <span class="string">"childrens"</span>: [],</span><br><span class="line">                    <span class="string">"createDate"</span>: <span class="string">"1973-11-26 08:52"</span>,</span><br><span class="line">                    <span class="string">"level"</span>: <span class="number">2</span>,</span><br><span class="line">                    <span class="string">"toUser"</span>: {</span><br><span class="line">                        <span class="string">"nickname"</span>: <span class="string">"李四"</span>,</span><br><span class="line">                        <span class="string">"avatar"</span>: <span class="string">"http://localhost:8080/static/img/logo.b3a48c0.png"</span>,</span><br><span class="line">                        <span class="string">"id"</span>: <span class="number">1</span></span><br><span class="line">                    }</span><br><span class="line">                }</span><br><span class="line">            ],</span><br><span class="line">            <span class="string">"createDate"</span>: <span class="string">"1973-11-27 09:53"</span>,</span><br><span class="line">            <span class="string">"level"</span>: <span class="number">1</span>,</span><br><span class="line">            <span class="string">"toUser"</span>: <span class="literal">null</span></span><br><span class="line">        }</span><br><span class="line">    ]</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

<h3 id="3-16-2-编码"><a href="#3-16-2-编码" class="headerlink" title="3.16.2 编码"></a>3.16.2 编码</h3><h4 id="①-Comment实体类"><a href="#①-Comment实体类" class="headerlink" title="① Comment实体类"></a>① Comment实体类</h4><figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Comment</span> </span>{</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">private</span> Long id;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> String content;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> Long createDate;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> Long articleId;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> Long authorId;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> Long parentId;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> Long toUid;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> Integer level;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

<h4 id="②-CommentVo和UserVo类"><a href="#②-CommentVo和UserVo类" class="headerlink" title="② CommentVo和UserVo类"></a>② CommentVo和UserVo类</h4><figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">CommentVo</span> </span>{</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">private</span> String id;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> UserVo author;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> List&lt;CommentVo&gt; children;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> String content;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> String createDate;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> UserVo toUser;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> Integer level;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

<figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">UserVo</span> </span>{</span><br><span class="line">    <span class="keyword">private</span> String nickname;</span><br><span class="line">    <span class="keyword">private</span> String avatar;</span><br><span class="line">    <span class="keyword">private</span> Long id;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

<h4 id="③-CommentsController控制类"><a href="#③-CommentsController控制类" class="headerlink" title="③ CommentsController控制类"></a>③ CommentsController控制类</h4><figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="meta">@RequestMapping("/comments")</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">CommentsController</span> </span>{</span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> CommentsService commentsService;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@GetMapping("/article/{id}")</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Result <span class="title">comments</span><span class="params">(<span class="meta">@PathVariable("id")</span> Long articleId)</span></span>{</span><br><span class="line">        <span class="keyword">return</span> commentsService.findCommentsByArticleId(articleId);</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

<h4 id="④-CommentsMapper映射类"><a href="#④-CommentsMapper映射类" class="headerlink" title="④ CommentsMapper映射类"></a>④ CommentsMapper映射类</h4><figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Mapper</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">CommentsMapper</span> <span class="keyword">extends</span> <span class="title">BaseMapper</span>&lt;<span class="title">Comment</span>&gt; </span>{</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

<h4 id="⑤-CommentsService服务类"><a href="#⑤-CommentsService服务类" class="headerlink" title="⑤ CommentsService服务类"></a>⑤ CommentsService服务类</h4><figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">CommentsService</span> </span>{</span><br><span class="line">    <span class="function">Result <span class="title">findCommentsByArticleId</span><span class="params">(Long articleId)</span></span>;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

<h4 id="⑥-CommentsServiceImpl实现类"><a href="#⑥-CommentsServiceImpl实现类" class="headerlink" title="⑥ CommentsServiceImpl实现类"></a>⑥ CommentsServiceImpl实现类</h4><figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">CommentsServiceImpl</span> <span class="keyword">implements</span> <span class="title">CommentsService</span> </span>{</span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> CommentsMapper commentsMapper;</span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> SysUserService sysUserService;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Result <span class="title">findCommentsByArticleId</span><span class="params">(Long articleId)</span> </span>{</span><br><span class="line">        <span class="comment">/*根据文章id，从 comment 表中查询评论列表</span></span><br><span class="line"><span class="comment">         * 根据文章id，找到作者id，然后去用户表里查询用户信息，返回userVo</span></span><br><span class="line"><span class="comment">         * 判断 如果 level = 1 要去查询它有没有子评论</span></span><br><span class="line"><span class="comment">         * 如果有子评论，查询表中哪些记录的parent_id==评论id</span></span><br><span class="line"><span class="comment">         */</span></span><br><span class="line">        LambdaQueryWrapper&lt;Comment&gt; queryWrapper=<span class="keyword">new</span> LambdaQueryWrapper&lt;&gt;();</span><br><span class="line">        queryWrapper.eq(Comment::getArticleId,articleId);</span><br><span class="line">        queryWrapper.eq(Comment::getLevel,<span class="number">1</span>);<span class="comment">//先查询第一层的评论，再递归查询其子评论即可</span></span><br><span class="line">        List&lt;Comment&gt; commentList = commentsMapper.selectList(queryWrapper);</span><br><span class="line">        List&lt;CommentVo&gt; commentVoList=copyList(commentList);</span><br><span class="line">        <span class="keyword">return</span> Result.success(commentVoList);</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> List&lt;CommentVo&gt; <span class="title">copyList</span><span class="params">(List&lt;Comment&gt; commentList)</span> </span>{</span><br><span class="line">        List&lt;CommentVo&gt; commentVoList=<span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line">        <span class="keyword">for</span> (Comment comment : commentList) {</span><br><span class="line">            commentVoList.add(copy(comment));</span><br><span class="line">        }</span><br><span class="line">        <span class="keyword">return</span> commentVoList;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> CommentVo <span class="title">copy</span><span class="params">(Comment comment)</span> </span>{</span><br><span class="line">        CommentVo commentVo=<span class="keyword">new</span> CommentVo();</span><br><span class="line">        BeanUtils.copyProperties(comment,commentVo);</span><br><span class="line">        commentVo.setId(String.valueOf(comment.getId()));</span><br><span class="line">        Long authorId = comment.getAuthorId();</span><br><span class="line">        <span class="comment">//评论的作者</span></span><br><span class="line">        UserVo author=sysUserService.findUserVoById(authorId);<span class="comment">//通过id找到对应用户并返回一个UserVo对象</span></span><br><span class="line">        commentVo.setAuthor(author);</span><br><span class="line">        <span class="comment">//子评论</span></span><br><span class="line">        Integer level = comment.getLevel();</span><br><span class="line">        <span class="keyword">if</span>(<span class="number">1</span>==level){</span><br><span class="line">            Long id = comment.getId();</span><br><span class="line">            List&lt;CommentVo&gt; commentVoList=findCommentsByParentId(id);</span><br><span class="line">            commentVo.setChildren(commentVoList);</span><br><span class="line">        }</span><br><span class="line">        <span class="comment">//给谁评论 to user</span></span><br><span class="line">        <span class="keyword">if</span>(level&gt;<span class="number">1</span>){</span><br><span class="line">            Long toUid = comment.getToUid();</span><br><span class="line">            UserVo toUserVo=sysUserService.findUserVoById(toUid);</span><br><span class="line">            commentVo.setToUser(toUserVo);</span><br><span class="line">        }</span><br><span class="line">        <span class="keyword">return</span> commentVo;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="comment">//通过ParentId找到对应的评论</span></span><br><span class="line">    <span class="function"><span class="keyword">private</span> List&lt;CommentVo&gt; <span class="title">findCommentsByParentId</span><span class="params">(Long id)</span> </span>{</span><br><span class="line">        LambdaQueryWrapper&lt;Comment&gt; queryWrapper=<span class="keyword">new</span> LambdaQueryWrapper();</span><br><span class="line">        queryWrapper.eq(Comment::getParentId,id);<span class="comment">//传进来的评论id和遍历的评论的parentId要一样</span></span><br><span class="line">        queryWrapper.eq(Comment::getLevel,<span class="number">2</span>);</span><br><span class="line">        List&lt;Comment&gt; comments = commentsMapper.selectList(queryWrapper);</span><br><span class="line">        <span class="keyword">return</span> copyList(comments);</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

<h4 id="⑦-SysUserService服务类"><a href="#⑦-SysUserService服务类" class="headerlink" title="⑦ SysUserService服务类"></a>⑦ SysUserService服务类</h4><figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">SysUserService</span> </span>{</span><br><span class="line">    <span class="function">UserVo <span class="title">findUserVoById</span><span class="params">(Long authorId)</span></span>;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

<h4 id="⑧-SysUserServiceImpl实现类"><a href="#⑧-SysUserServiceImpl实现类" class="headerlink" title="⑧ SysUserServiceImpl实现类"></a>⑧ SysUserServiceImpl实现类</h4><figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SysUserServiceImpl</span> <span class="keyword">implements</span> <span class="title">SysUserService</span> </span>{</span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> SysUserMapper sysUserMapper;</span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> LoginService loginService;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> UserVo <span class="title">findUserVoById</span><span class="params">(Long authorId)</span> </span>{</span><br><span class="line">        UserVo userVo=<span class="keyword">new</span> UserVo();</span><br><span class="line">        SysUser sysUser = sysUserMapper.selectById(authorId);</span><br><span class="line">        <span class="keyword">if</span>(sysUser==<span class="keyword">null</span>){</span><br><span class="line">            sysUser.setId(<span class="number">1L</span>);</span><br><span class="line">            sysUser.setAvatar(<span class="string">"/static/img/logo.b3a48c0.png"</span>);</span><br><span class="line">            sysUser.setNickname(<span class="string">"xlx"</span>);</span><br><span class="line">        }</span><br><span class="line">        BeanUtils.copyProperties(sysUser,userVo);</span><br><span class="line">        <span class="keyword">return</span> userVo;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

<h3 id="3-16-3-测试结果"><a href="#3-16-3-测试结果" class="headerlink" title="3.16.3 测试结果"></a>3.16.3 测试结果</h3><p>一层评论显示正常，二层评论无法显示，没有报错，日志显示能从数据库查询到信息，估计是前端问题</p>
<h2 id="3-17-评论功能"><a href="#3-17-评论功能" class="headerlink" title="3.17 评论功能"></a>3.17 评论功能</h2><h3 id="3-17-1-接口说明"><a href="#3-17-1-接口说明" class="headerlink" title="3.17.1 接口说明"></a>3.17.1 接口说明</h3><ul>
<li><p>接口url：/comments/create/change</p>
</li>
<li><p>请求方式：POST</p>
</li>
<li><p>请求参数：</p>
</li>
</ul>
<p>参数名称    参数类型    说明</p>
<table>
<thead>
<tr>
<th>参数名称</th>
<th>参数类型</th>
<th>说明</th>
</tr>
</thead>
<tbody><tr>
<td>articleId</td>
<td>long</td>
<td>文章id</td>
</tr>
<tr>
<td>content</td>
<td>string</td>
<td>评论内容</td>
</tr>
<tr>
<td>parent</td>
<td>long</td>
<td>父评论id</td>
</tr>
<tr>
<td>toUserId</td>
<td>long</td>
<td>被评论的用户id</td>
</tr>
</tbody></table>
<ul>
<li>返回数据：</li>
</ul>
<figure class="highlight js"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">{</span><br><span class="line">    <span class="string">"success"</span>: <span class="literal">true</span>,</span><br><span class="line">    <span class="string">"code"</span>: <span class="number">200</span>,</span><br><span class="line">    <span class="string">"msg"</span>: <span class="string">"success"</span>,</span><br><span class="line">    <span class="string">"data"</span>: <span class="literal">null</span></span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

<h3 id="3-17-2-编码"><a href="#3-17-2-编码" class="headerlink" title="3.17.2 编码"></a>3.17.2 编码</h3><h4 id="①-CommentParam参数类"><a href="#①-CommentParam参数类" class="headerlink" title="① CommentParam参数类"></a>① CommentParam参数类</h4><figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">CommentParam</span> </span>{</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> Long articleId;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> String content;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> Long parent;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> Long toUserId;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

<h4 id="②-CommentsController控制类"><a href="#②-CommentsController控制类" class="headerlink" title="② CommentsController控制类"></a>② CommentsController控制类</h4><figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="meta">@RequestMapping("/comments")</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">CommentsController</span> </span>{</span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> CommentsService commentsService;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@PostMapping("create/change")</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Result <span class="title">comment</span><span class="params">(<span class="meta">@RequestBody</span> CommentParam commentParam)</span></span>{</span><br><span class="line">        <span class="keyword">return</span> commentsService.comment(commentParam);</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

<h4 id="③-CommentsService服务类"><a href="#③-CommentsService服务类" class="headerlink" title="③ CommentsService服务类"></a>③ CommentsService服务类</h4><figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">CommentsService</span> </span>{</span><br><span class="line">    <span class="function">Result <span class="title">comment</span><span class="params">(CommentParam commentParam)</span></span>;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

<h4 id="④-CommentsServiceImpl实现类"><a href="#④-CommentsServiceImpl实现类" class="headerlink" title="④ CommentsServiceImpl实现类"></a>④ CommentsServiceImpl实现类</h4><figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">CommentsServiceImpl</span> <span class="keyword">implements</span> <span class="title">CommentsService</span> </span>{</span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> CommentsMapper commentsMapper;</span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> SysUserService sysUserService;</span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> ArticleMapper articleMapper;</span><br><span class="line">    </span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Result <span class="title">comment</span><span class="params">(CommentParam commentParam)</span> </span>{</span><br><span class="line">        <span class="comment">//拿到当前用户</span></span><br><span class="line">        SysUser sysUser = UserThreadLocal.get();</span><br><span class="line">        Comment comment = <span class="keyword">new</span> Comment();</span><br><span class="line">        <span class="comment">//初始化评论</span></span><br><span class="line">        comment.setArticleId(commentParam.getArticleId());</span><br><span class="line">        comment.setAuthorId(sysUser.getId());</span><br><span class="line">        comment.setContent(commentParam.getContent());</span><br><span class="line">        comment.setCreateDate(System.currentTimeMillis());</span><br><span class="line">        Long parent = commentParam.getParent();</span><br><span class="line">        <span class="keyword">if</span> (parent == <span class="keyword">null</span> || parent == <span class="number">0</span>) {<span class="comment">//判断是否有父评论</span></span><br><span class="line">            comment.setLevel(<span class="number">1</span>);</span><br><span class="line">        }<span class="keyword">else</span>{</span><br><span class="line">            comment.setLevel(<span class="number">2</span>);</span><br><span class="line">        }</span><br><span class="line">        <span class="comment">//如果是空，parent设为0</span></span><br><span class="line">        comment.setParentId(parent == <span class="keyword">null</span> ? <span class="number">0</span> : parent);</span><br><span class="line">        Long toUserId = commentParam.getToUserId();</span><br><span class="line">        comment.setToUid(toUserId == <span class="keyword">null</span> ? <span class="number">0</span> : toUserId);</span><br><span class="line">        <span class="keyword">this</span>.commentsMapper.insert(comment);</span><br><span class="line">        <span class="comment">//拿到当前评论的文章，将评论数进行更新，并更新数据库中的值</span></span><br><span class="line">        Article article = articleMapper.selectById(commentParam.getArticleId());</span><br><span class="line">        article.setCommentCounts(article.getCommentCounts()+<span class="number">1</span>);</span><br><span class="line">        articleMapper.updateById(article);</span><br><span class="line">        <span class="keyword">return</span> Result.success(comment);</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

<h3 id="3-17-3-设置登陆拦截"><a href="#3-17-3-设置登陆拦截" class="headerlink" title="3.17.3 设置登陆拦截"></a>3.17.3 设置登陆拦截</h3><figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">WebConfig</span> <span class="keyword">implements</span> <span class="title">WebMvcConfigurer</span> </span>{</span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> LoginInterceptor loginInterceptor;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">addInterceptors</span><span class="params">(InterceptorRegistry registry)</span> </span>{</span><br><span class="line">        registry.addInterceptor(loginInterceptor)</span><br><span class="line">                .addPathPatterns(<span class="string">"/comments/create/change"</span>);</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

<h2 id="3-18-文章类别功能"><a href="#3-18-文章类别功能" class="headerlink" title="3.18 文章类别功能"></a>3.18 文章类别功能</h2><h3 id="3-18-1-接口说明"><a href="#3-18-1-接口说明" class="headerlink" title="3.18.1 接口说明"></a>3.18.1 接口说明</h3><ul>
<li><p>接口url：/categorys</p>
</li>
<li><p>请求方式：GET</p>
</li>
<li><p>请求参数：无</p>
</li>
</ul>
<ul>
<li>返回数据：</li>
</ul>
<figure class="highlight js"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">{</span><br><span class="line">    <span class="string">"success"</span>:<span class="literal">true</span>,</span><br><span class="line"> 	<span class="string">"code"</span>:<span class="number">200</span>,</span><br><span class="line">    <span class="string">"msg"</span>:<span class="string">"success"</span>,</span><br><span class="line">    <span class="string">"data"</span>:</span><br><span class="line">    [</span><br><span class="line">        {<span class="string">"id"</span>:<span class="number">1</span>,<span class="string">"avatar"</span>:<span class="string">"/category/front.png"</span>,<span class="string">"categoryName"</span>:<span class="string">"前端"</span>},	</span><br><span class="line">        {<span class="string">"id"</span>:<span class="number">2</span>,<span class="string">"avatar"</span>:<span class="string">"/category/back.png"</span>,<span class="string">"categoryName"</span>:<span class="string">"后端"</span>},</span><br><span class="line">        {<span class="string">"id"</span>:<span class="number">3</span>,<span class="string">"avatar"</span>:<span class="string">"/category/lift.jpg"</span>,<span class="string">"categoryName"</span>:<span class="string">"生活"</span>},</span><br><span class="line">        {<span class="string">"id"</span>:<span class="number">4</span>,<span class="string">"avatar"</span>:<span class="string">"/category/database.png"</span>,<span class="string">"categoryName"</span>:<span class="string">"数据库"</span>},</span><br><span class="line">        {<span class="string">"id"</span>:<span class="number">5</span>,<span class="string">"avatar"</span>:<span class="string">"/category/language.png"</span>,<span class="string">"categoryName"</span>:<span class="string">"编程语言"</span>}</span><br><span class="line">    ]</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

<h3 id="3-18-2-编码"><a href="#3-18-2-编码" class="headerlink" title="3.18.2 编码"></a>3.18.2 编码</h3><h4 id="①-CategoryController控制类"><a href="#①-CategoryController控制类" class="headerlink" title="① CategoryController控制类"></a>① CategoryController控制类</h4><figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="meta">@RequestMapping("/categorys")</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">CategoryController</span> </span>{</span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> CategoryService categoryService;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//找到所有的类别并返回</span></span><br><span class="line">    <span class="meta">@GetMapping</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Result <span class="title">categories</span><span class="params">()</span></span>{</span><br><span class="line">        <span class="keyword">return</span> categoryService.findAllCategory();</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

<h4 id="②-CategoryService服务类"><a href="#②-CategoryService服务类" class="headerlink" title="② CategoryService服务类"></a>② CategoryService服务类</h4><figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">CategoryService</span> </span>{</span><br><span class="line">    <span class="function">Result <span class="title">findAllCategory</span><span class="params">()</span></span>;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

<h4 id="③-CategoryServiceImpl实现类"><a href="#③-CategoryServiceImpl实现类" class="headerlink" title="③ CategoryServiceImpl实现类"></a>③ CategoryServiceImpl实现类</h4><figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">CategoryServiceImpl</span> <span class="keyword">implements</span> <span class="title">CategoryService</span> </span>{</span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> CategoryMapper categoryMapper;</span><br><span class="line">    </span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Result <span class="title">findAllCategory</span><span class="params">()</span> </span>{</span><br><span class="line">        LambdaQueryWrapper&lt;Category&gt; queryWrapper=<span class="keyword">new</span> LambdaQueryWrapper();</span><br><span class="line">        queryWrapper.select(Category::getId,Category::getCategoryName);</span><br><span class="line">        List&lt;Category&gt; categories = categoryMapper.selectList(queryWrapper);</span><br><span class="line">        <span class="keyword">return</span> Result.success(copyList(categories));</span><br><span class="line">    }</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">public</span> CategoryVo <span class="title">copy</span><span class="params">(Category category)</span></span>{</span><br><span class="line">        CategoryVo categoryVo = <span class="keyword">new</span> CategoryVo();</span><br><span class="line">        BeanUtils.copyProperties(category,categoryVo);</span><br><span class="line">        categoryVo.setId(String.valueOf(category.getId()));</span><br><span class="line">        <span class="keyword">return</span> categoryVo;</span><br><span class="line">    }</span><br><span class="line">    <span class="function"><span class="keyword">public</span> List&lt;CategoryVo&gt; <span class="title">copyList</span><span class="params">(List&lt;Category&gt; categoryList)</span></span>{</span><br><span class="line">        List&lt;CategoryVo&gt; categoryVoList = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line">        <span class="keyword">for</span> (Category category : categoryList) {</span><br><span class="line">            categoryVoList.add(copy(category));</span><br><span class="line">        }</span><br><span class="line">        <span class="keyword">return</span> categoryVoList;</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

<h3 id="3-18-3-测试结果"><a href="#3-18-3-测试结果" class="headerlink" title="3.18.3 测试结果"></a>3.18.3 测试结果</h3><p><img src="C:\Users\95671\AppData\Roaming\Typora\typora-user-images\image-20220125154204532.png" alt="image-20220125154204532"></p>
<p>能正常显示分类</p>
<h2 id="3-19-文章标签功能"><a href="#3-19-文章标签功能" class="headerlink" title="3.19 文章标签功能"></a>3.19 文章标签功能</h2><h3 id="3-19-1-接口说明"><a href="#3-19-1-接口说明" class="headerlink" title="3.19.1 接口说明"></a>3.19.1 接口说明</h3><ul>
<li><p>接口url：/tags</p>
</li>
<li><p>请求方式：GET</p>
</li>
<li><p>请求参数：无</p>
</li>
<li><p>返回数据：</p>
</li>
</ul>
<figure class="highlight js"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">{</span><br><span class="line">    <span class="string">"success"</span>: <span class="literal">true</span>,</span><br><span class="line">    <span class="string">"code"</span>: <span class="number">200</span>,</span><br><span class="line">    <span class="string">"msg"</span>: <span class="string">"success"</span>,</span><br><span class="line">    <span class="string">"data"</span>: [</span><br><span class="line">        {</span><br><span class="line">            <span class="string">"id"</span>: <span class="number">5</span>,</span><br><span class="line">            <span class="string">"tagName"</span>: <span class="string">"springboot"</span></span><br><span class="line">        },</span><br><span class="line">        {</span><br><span class="line">            <span class="string">"id"</span>: <span class="number">6</span>,</span><br><span class="line">            <span class="string">"tagName"</span>: <span class="string">"spring"</span></span><br><span class="line">        },</span><br><span class="line">        {</span><br><span class="line">            <span class="string">"id"</span>: <span class="number">7</span>,</span><br><span class="line">            <span class="string">"tagName"</span>: <span class="string">"springmvc"</span></span><br><span class="line">        },</span><br><span class="line">        {</span><br><span class="line">            <span class="string">"id"</span>: <span class="number">8</span>,</span><br><span class="line">            <span class="string">"tagName"</span>: <span class="string">"11"</span></span><br><span class="line">        }</span><br><span class="line">    ]</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

<h3 id="3-19-2-编码"><a href="#3-19-2-编码" class="headerlink" title="3.19.2 编码"></a>3.19.2 编码</h3><h4 id="①-TagsController控制类"><a href="#①-TagsController控制类" class="headerlink" title="① TagsController控制类"></a>① TagsController控制类</h4><figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="meta">@RequestMapping("tags")</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TagsController</span> </span>{</span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> TagService tagService;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">//找到所有标签并返回</span></span><br><span class="line">    <span class="meta">@GetMapping</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Result <span class="title">findAllTag</span><span class="params">()</span></span>{</span><br><span class="line">        <span class="keyword">return</span> tagService.findAllTag();</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

<h4 id="②-TagService服务类-1"><a href="#②-TagService服务类-1" class="headerlink" title="② TagService服务类"></a>② TagService服务类</h4><figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">TagService</span> </span>{</span><br><span class="line">    <span class="function">Result <span class="title">findAllTag</span><span class="params">()</span></span>;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

<h4 id="③-TagServiceImpl实现类-1"><a href="#③-TagServiceImpl实现类-1" class="headerlink" title="③ TagServiceImpl实现类"></a>③ TagServiceImpl实现类</h4><figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TagServiceImpl</span> <span class="keyword">implements</span> <span class="title">TagService</span> </span>{</span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> TagMapper tagMapper;</span><br><span class="line">    </span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Result <span class="title">findAllTag</span><span class="params">()</span> </span>{</span><br><span class="line">        LambdaQueryWrapper&lt;Tag&gt; queryWrapper=<span class="keyword">new</span> LambdaQueryWrapper();</span><br><span class="line">        queryWrapper.select(Tag::getId,Tag::getTagName);</span><br><span class="line">        List&lt;Tag&gt; tags = tagMapper.selectList(queryWrapper);</span><br><span class="line">        <span class="keyword">return</span> Result.success(copyList(tags));</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> List&lt;TagVo&gt; <span class="title">copyList</span><span class="params">(List&lt;Tag&gt; tags)</span> </span>{</span><br><span class="line">        List&lt;TagVo&gt; tagVoList=<span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line">        <span class="keyword">for</span> (Tag tag : tags) {</span><br><span class="line">            tagVoList.add(copy(tag));</span><br><span class="line">        }</span><br><span class="line">        <span class="keyword">return</span> tagVoList;</span><br><span class="line">    }</span><br><span class="line">    <span class="function"><span class="keyword">private</span> TagVo <span class="title">copy</span><span class="params">(Tag tag)</span></span>{</span><br><span class="line">        TagVo tagVo=<span class="keyword">new</span> TagVo();</span><br><span class="line">        BeanUtils.copyProperties(tag,tagVo);</span><br><span class="line">        tagVo.setId(String.valueOf(tag.getId()));</span><br><span class="line">        <span class="keyword">return</span> tagVo;</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

<h3 id="3-19-3-测试结果"><a href="#3-19-3-测试结果" class="headerlink" title="3.19.3 测试结果"></a>3.19.3 测试结果</h3><p><img src="C:\Users\95671\AppData\Roaming\Typora\typora-user-images\image-20220125154542434.png" alt="image-20220125154542434"></p>
<p>能正常显示所有标签</p>
<h2 id="3-20-文章发布功能"><a href="#3-20-文章发布功能" class="headerlink" title="3.20 文章发布功能"></a>3.20 文章发布功能</h2><h3 id="3-20-1-接口说明"><a href="#3-20-1-接口说明" class="headerlink" title="3.20.1 接口说明"></a>3.20.1 接口说明</h3><ul>
<li><p>接口url：/articles/publish</p>
</li>
<li><p>请求方式：POST</p>
</li>
<li><p>请求参数：</p>
</li>
</ul>
<table>
<thead>
<tr>
<th>参数名称</th>
<th>参数类型</th>
<th>说明</th>
</tr>
</thead>
<tbody><tr>
<td>title</td>
<td>string</td>
<td>文章标题</td>
</tr>
<tr>
<td>id</td>
<td>long</td>
<td>文章id</td>
</tr>
<tr>
<td>body</td>
<td>object（{content: “xx”, contentHtml: “xx”}）</td>
<td>文章内容</td>
</tr>
<tr>
<td>category</td>
<td>{id: 2, avatar: “/category/back.png”, categoryName: “后端”}</td>
<td>文章类别</td>
</tr>
<tr>
<td>summary</td>
<td>string</td>
<td>文章概述</td>
</tr>
<tr>
<td>tags</td>
<td>[{id: 5}, {id: 6}]</td>
<td>文章标签</td>
</tr>
</tbody></table>
<ul>
<li>返回数据：</li>
</ul>
<figure class="highlight js"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">{</span><br><span class="line">    <span class="string">"success"</span>: <span class="literal">true</span>,</span><br><span class="line">    <span class="string">"code"</span>: <span class="number">200</span>,</span><br><span class="line">    <span class="string">"msg"</span>: <span class="string">"success"</span>,</span><br><span class="line">    <span class="string">"data"</span>: {<span class="string">"id"</span>:xxxxx}</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

<h3 id="3-20-2-编码"><a href="#3-20-2-编码" class="headerlink" title="3.20.2 编码"></a>3.20.2 编码</h3><h4 id="①-ArticleParam、ArticleBodyParam、ArticleBody和ArticleTag类"><a href="#①-ArticleParam、ArticleBodyParam、ArticleBody和ArticleTag类" class="headerlink" title="① ArticleParam、ArticleBodyParam、ArticleBody和ArticleTag类"></a>① ArticleParam、ArticleBodyParam、ArticleBody和ArticleTag类</h4><figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ArticleParam</span> </span>{</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> Long id;</span><br><span class="line">    <span class="keyword">private</span> ArticleBodyParam body;</span><br><span class="line">    <span class="keyword">private</span> CategoryVo category;</span><br><span class="line">    <span class="keyword">private</span> String summary;</span><br><span class="line">    <span class="keyword">private</span> List&lt;TagVo&gt; tags;</span><br><span class="line">    <span class="keyword">private</span> String title;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

<figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ArticleBodyParam</span> </span>{</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> String content;</span><br><span class="line">    <span class="keyword">private</span> String contentHtml;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

<figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ArticleBody</span> </span>{</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> Long id;</span><br><span class="line">    <span class="keyword">private</span> String content;</span><br><span class="line">    <span class="keyword">private</span> String contentHtml;</span><br><span class="line">    <span class="keyword">private</span> Long articleId;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

<figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ArticleTag</span> </span>{</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> Long id;</span><br><span class="line">    <span class="keyword">private</span> Long articleId;</span><br><span class="line">    <span class="keyword">private</span> Long tagId;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

<h4 id="②-ArticleController控制类-1"><a href="#②-ArticleController控制类-1" class="headerlink" title="② ArticleController控制类"></a>② ArticleController控制类</h4><figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="meta">@RequestMapping("/articles")</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ArticleController</span> </span>{</span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> ArticleService articleService;</span><br><span class="line">    </span><br><span class="line">    <span class="meta">@PostMapping("/publish")</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Result <span class="title">publish</span><span class="params">(<span class="meta">@RequestBody</span> ArticleParam articleParam)</span></span>{</span><br><span class="line">        <span class="keyword">return</span> articleService.publish(articleParam);</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

<h4 id="③-ArticleBodyMapper和ArticleTagMapper映射类"><a href="#③-ArticleBodyMapper和ArticleTagMapper映射类" class="headerlink" title="③ ArticleBodyMapper和ArticleTagMapper映射类"></a>③ ArticleBodyMapper和ArticleTagMapper映射类</h4><figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Mapper</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">ArticleBodyMapper</span> <span class="keyword">extends</span> <span class="title">BaseMapper</span>&lt;<span class="title">ArticleBody</span>&gt; </span>{</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

<figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Mapper</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">ArticleTagMapper</span> <span class="keyword">extends</span> <span class="title">BaseMapper</span>&lt;<span class="title">ArticleTag</span>&gt; </span>{</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

<h4 id="④-服务类"><a href="#④-服务类" class="headerlink" title="④ 服务类"></a>④ 服务类</h4><figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">ArticleService</span> </span>{</span><br><span class="line">    <span class="function">Result <span class="title">publish</span><span class="params">(ArticleParam articleParam)</span></span>;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

<h4 id="⑤-实现类"><a href="#⑤-实现类" class="headerlink" title="⑤ 实现类"></a>⑤ 实现类</h4><figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ArticleServiceImpl</span> <span class="keyword">implements</span> <span class="title">ArticleService</span> </span>{</span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> ArticleMapper articleMapper;</span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> TagService tagService;</span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> SysUserService sysUserService;</span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> ArticleBodyMapper articleBodyMapper;</span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> CategoryMapper categoryMapper;</span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> CategoryService categoryService;</span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> ThreadService threadService;</span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> ArticleTagMapper articleTagMapper;</span><br><span class="line">   </span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Result <span class="title">publish</span><span class="params">(ArticleParam articleParam)</span> </span>{</span><br><span class="line">        <span class="comment">/**</span></span><br><span class="line"><span class="comment">         * 1. 发布文章 目的 构建Article对象</span></span><br><span class="line"><span class="comment">         * 2. 作者id  当前的登录用户</span></span><br><span class="line"><span class="comment">         * 3. 标签  要将标签加入到 关联列表当中</span></span><br><span class="line"><span class="comment">         * 4. body 内容存储 article bodyId</span></span><br><span class="line"><span class="comment">         */</span></span><br><span class="line"></span><br><span class="line">        Article article=<span class="keyword">new</span> Article();</span><br><span class="line">        <span class="comment">//拿到当前发布文章的用户，以获取用户id</span></span><br><span class="line">        SysUser sysUser = UserThreadLocal.get();</span><br><span class="line">        <span class="comment">//给article设置初始值，才能插入到数据库中，生成articleId</span></span><br><span class="line">        article.setAuthorId(sysUser.getId());</span><br><span class="line">        article.setTitle(articleParam.getTitle());</span><br><span class="line">        article.setSummary(articleParam.getSummary());</span><br><span class="line">        article.setViewCounts(<span class="number">0</span>);</span><br><span class="line">        article.setCommentCounts(<span class="number">0</span>);</span><br><span class="line">        article.setWeight(Article.Article_Common);</span><br><span class="line">        article.setCreateDate(System.currentTimeMillis());</span><br><span class="line">        article.setCategoryId(Long.parseLong(articleParam.getCategory().getId()));</span><br><span class="line">        article.setBodyId(-<span class="number">1L</span>);</span><br><span class="line">        <span class="comment">//插入之后 会生成一个文章id（因为新建的文章没有文章id所以要insert一下）</span></span><br><span class="line">        articleMapper.insert(article);</span><br><span class="line">        <span class="comment">//文章标签，从articleParam里拿，但是数据是存储在article_tag表里的</span></span><br><span class="line">        List&lt;TagVo&gt; tags = articleParam.getTags();</span><br><span class="line">        <span class="keyword">if</span>(tags!=<span class="keyword">null</span>){</span><br><span class="line">            <span class="keyword">for</span> (TagVo tag : tags) {</span><br><span class="line">                ArticleTag articleTag=<span class="keyword">new</span> ArticleTag();</span><br><span class="line">                articleTag.setArticleId(article.getId());</span><br><span class="line">                articleTag.setTagId(Long.parseLong(tag.getId()));</span><br><span class="line">                articleTagMapper.insert(articleTag);</span><br><span class="line">            }</span><br><span class="line">        }</span><br><span class="line">        <span class="comment">//文章主体，从articleParam里拿但是数据是存储在article_body表里的</span></span><br><span class="line">        ArticleBody articleBody=<span class="keyword">new</span> ArticleBody();</span><br><span class="line">        articleBody.setArticleId(article.getId());</span><br><span class="line">        articleBody.setContent(articleParam.getBody().getContent());</span><br><span class="line">        articleBody.setContentHtml(articleParam.getBody().getContentHtml());</span><br><span class="line">        articleBody.setArticleId(article.getId());</span><br><span class="line">        articleBodyMapper.insert(articleBody);</span><br><span class="line">        article.setBodyId(articleBody.getId());</span><br><span class="line">        <span class="comment">//将添加了BodyId的文章在数据库中进行更新</span></span><br><span class="line">        articleMapper.updateById(article);</span><br><span class="line">        <span class="comment">//由接口说明可知需要返回一个ArticleVo对象的id值</span></span><br><span class="line">        ArticleVo articleVo = <span class="keyword">new</span> ArticleVo();</span><br><span class="line">        articleVo.setId(String.valueOf(article.getId()));</span><br><span class="line">        <span class="keyword">return</span> Result.success(articleVo);</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

<h3 id="3-20-3-测试结果"><a href="#3-20-3-测试结果" class="headerlink" title="3.20.3 测试结果"></a>3.20.3 测试结果</h3><p><img src="C:\Users\95671\AppData\Roaming\Typora\typora-user-images\image-20220125160251226.png" alt="image-20220125160251226"></p>
<p>文章发布成功</p>
<h2 id="3-21-文章图片上传"><a href="#3-21-文章图片上传" class="headerlink" title="3.21 文章图片上传"></a>3.21 文章图片上传</h2><h3 id="3-21-1-接口说明"><a href="#3-21-1-接口说明" class="headerlink" title="3.21.1 接口说明"></a>3.21.1 接口说明</h3><ul>
<li><p>接口url：/upload</p>
</li>
<li><p>请求方式：POST</p>
</li>
<li><p>请求参数：</p>
</li>
</ul>
<table>
<thead>
<tr>
<th>参数名称</th>
<th>参数类型</th>
<th>说明</th>
</tr>
</thead>
<tbody><tr>
<td>image</td>
<td>file</td>
<td>上传的文件名称</td>
</tr>
</tbody></table>
<ul>
<li>返回数据：</li>
</ul>
<figure class="highlight js"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">{</span><br><span class="line">    <span class="string">"success"</span>:<span class="literal">true</span>,</span><br><span class="line"> 	<span class="string">"code"</span>:<span class="number">200</span>,</span><br><span class="line">    <span class="string">"msg"</span>:<span class="string">"success"</span>,</span><br><span class="line">    <span class="string">"data"</span>:<span class="string">"https://static.mszlu.com/aa.png"</span></span><br><span class="line">}</span><br><span class="line"></span><br></pre></td></tr></tbody></table></figure>

<h3 id="3-21-2-云服务器"><a href="#3-21-2-云服务器" class="headerlink" title="3.21.2 云服务器"></a>3.21.2 云服务器</h3><h4 id="为什么要用云服务器"><a href="#为什么要用云服务器" class="headerlink" title="为什么要用云服务器"></a>为什么要用云服务器</h4><ul>
<li>一般像图片、视频这种比较大的资源最好不要放在本地的应用服务器里，因为如果你的应用服务器带宽是1MB/s，一张图片是100k的话，只要同时有10个人访问你的图片，那么第十一个人就会被卡死</li>
<li>但是如果我们把图片上传到云服务器上，用户访问文字时在应用服务器里，访问图片时去云服务器，这样就算很多人同时访问，最多也就是图片加载慢一点，并不会影响网站的正常访问</li>
</ul>
<h3 id="3-21-3-编码"><a href="#3-21-3-编码" class="headerlink" title="3.21.3 编码"></a>3.21.3 编码</h3><h4 id="①-注册账号"><a href="#①-注册账号" class="headerlink" title="① 注册账号"></a>① 注册账号</h4><p>该项目使用的云服务器为<strong>七牛云</strong>，去七牛云官网注册账号</p>
<h4 id="②-新建空间"><a href="#②-新建空间" class="headerlink" title="② 新建空间"></a>② 新建空间</h4><p>在个人空间管理中新建一个服务器空间</p>
<p><img src="C:\Users\95671\AppData\Roaming\Typora\typora-user-images\image-20220125162247529.png" alt="image-20220125162247529"></p>
<h4 id="③-引入依赖"><a href="#③-引入依赖" class="headerlink" title="③ 引入依赖"></a>③ 引入依赖</h4><figure class="highlight xml"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.qiniu<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>qiniu-java-sdk<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">version</span>&gt;</span>[7.7.0, 7.7.99]<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></tbody></table></figure>

<h4 id="④-yml配置类"><a href="#④-yml配置类" class="headerlink" title="④ yml配置类"></a>④ yml配置类</h4><figure class="highlight yml"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#配置密钥，要去个人中心的密钥管理中获取</span></span><br><span class="line"><span class="attr">qiniu:</span></span><br><span class="line">  <span class="attr">accessKey:</span> <span class="string">mbX_tr-DPk-qxs6t5DmjDViztrlw9tKDpTGn9jq8</span></span><br><span class="line">  <span class="attr">accessSecretKey:</span> <span class="string">Xm4k8XLQSGgFx1DaIvm2XQ804z0ucCH3pX6C-U-W</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#配置上传文件总的最大值为20MB以及单个文件的最大值为2MB</span></span><br><span class="line"><span class="attr">spring:</span></span><br><span class="line">  <span class="attr">servlet:</span></span><br><span class="line">    <span class="attr">multipart:</span></span><br><span class="line">      <span class="attr">max-request-size:</span> <span class="string">20MB</span></span><br><span class="line">      <span class="attr">max-file-size:</span> <span class="string">2MB</span></span><br></pre></td></tr></tbody></table></figure>

<p><img src="C:\Users\95671\AppData\Roaming\Typora\typora-user-images\image-20220125163414556.png" alt="image-20220125163414556"></p>
<h4 id="⑤-QiniuUtils工具类"><a href="#⑤-QiniuUtils工具类" class="headerlink" title="⑤ QiniuUtils工具类"></a>⑤ QiniuUtils工具类</h4><ul>
<li>该工具类七牛云官网有提供，直接复制，然后改改参数即可</li>
</ul>
<figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">QiniuUtils</span> </span>{</span><br><span class="line"></span><br><span class="line">    <span class="comment">//这个url是最终存储在云服务器上文件的访问地址前缀，每个人都不一样</span></span><br><span class="line">    <span class="comment">//随便上传一个文件，然后去服务器的空间里面的文件管理，查看文件的访问地址即可获得</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span>  <span class="keyword">final</span> String url = <span class="string">"http://r695duold.hn-bkt.clouddn.com/"</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//修改以下两个值放到yml中，在密钥管理中获取</span></span><br><span class="line">    <span class="meta">@Value("${qiniu.accessKey}")</span></span><br><span class="line">    <span class="keyword">private</span>  String accessKey;</span><br><span class="line">    <span class="meta">@Value("${qiniu.accessSecretKey}")</span></span><br><span class="line">    <span class="keyword">private</span>  String accessSecretKey;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span>  <span class="keyword">boolean</span> <span class="title">upload</span><span class="params">(MultipartFile file,String fileName)</span></span>{</span><br><span class="line">        <span class="comment">//构造一个带指定 Region 对象的配置类</span></span><br><span class="line">        <span class="comment">//在官网创建空间时会让你指定所在区域，我选的是华南，故这里用Region.huanan()</span></span><br><span class="line">        Configuration cfg = <span class="keyword">new</span> Configuration(Region.huanan());</span><br><span class="line">        <span class="comment">//...其他参数参考类注释</span></span><br><span class="line">        UploadManager uploadManager = <span class="keyword">new</span> UploadManager(cfg);</span><br><span class="line">        <span class="comment">//...生成上传凭证，然后准备上传，修改上传名称为自己创立空间的空间名称（是你自己的）</span></span><br><span class="line">        String bucket = <span class="string">"ch1998"</span>;</span><br><span class="line">        <span class="comment">//默认不指定key的情况下，以文件内容的hash值作为文件名</span></span><br><span class="line">        <span class="keyword">try</span> {</span><br><span class="line">            <span class="keyword">byte</span>[] uploadBytes = file.getBytes();</span><br><span class="line">            Auth auth = Auth.create(accessKey, accessSecretKey);</span><br><span class="line">            String upToken = auth.uploadToken(bucket);</span><br><span class="line">                Response response = uploadManager.put(uploadBytes, fileName, upToken);</span><br><span class="line">                <span class="comment">//解析上传成功的结果</span></span><br><span class="line">                DefaultPutRet putRet = JSON.parseObject(response.bodyString(), DefaultPutRet.class);</span><br><span class="line">                <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">            } <span class="keyword">catch</span> (Exception ex) {</span><br><span class="line">                ex.printStackTrace();</span><br><span class="line">            }</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

<ul>
<li>查看url：</li>
</ul>
<p><img src="C:\Users\95671\AppData\Roaming\Typora\typora-user-images\image-20220125163607780.png" alt="image-20220125163607780"></p>
<h4 id="⑤-UploadController控制类"><a href="#⑤-UploadController控制类" class="headerlink" title="⑤ UploadController控制类"></a>⑤ UploadController控制类</h4><figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="meta">@RequestMapping("upload")</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">UploadController</span> </span>{</span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> QiniuUtils qiniuUtils;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@PostMapping</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Result <span class="title">upload</span><span class="params">(<span class="meta">@RequestParam("image")</span> MultipartFile file)</span> </span>{</span><br><span class="line">        <span class="comment">//传进来的文件名称 比如说xx.jpg</span></span><br><span class="line">        String originalFilename = file.getOriginalFilename();</span><br><span class="line">        <span class="comment">//将原始的文件名称进行转化，使之唯一化</span></span><br><span class="line">        <span class="comment">//randomUUID随机生成一个UID，然后拼接上原来文件的后缀名</span></span><br><span class="line">        <span class="comment">//substringAfterLast作用是，取originalFilename中"."后面的字符串并返回，也就是文件后缀名</span></span><br><span class="line">        String fileName = UUID.randomUUID().toString() + <span class="string">"."</span> + StringUtils.substringAfterLast(originalFilename, <span class="string">"."</span>);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">boolean</span> upload = qiniuUtils.upload(file, fileName);</span><br><span class="line">        <span class="keyword">if</span> (upload) {</span><br><span class="line">            <span class="comment">//返回最终生成的文件访问地址</span></span><br><span class="line">            <span class="keyword">return</span> Result.success(QiniuUtils.url + fileName);</span><br><span class="line">        }</span><br><span class="line">        <span class="keyword">return</span> Result.fail(<span class="number">20001</span>, <span class="string">"上传失败"</span>);</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

<h2 id="3-22-导航—文章分类功能"><a href="#3-22-导航—文章分类功能" class="headerlink" title="3.22 导航—文章分类功能"></a>3.22 导航—文章分类功能</h2><h3 id="3-22-1-接口说明"><a href="#3-22-1-接口说明" class="headerlink" title="3.22.1 接口说明"></a>3.22.1 接口说明</h3><ul>
<li><p>接口url：/categorys/detail</p>
</li>
<li><p>请求方式：GET</p>
</li>
<li><p>请求参数：</p>
</li>
<li><p>返回数据：</p>
</li>
</ul>
<figure class="highlight js"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">{</span><br><span class="line">    <span class="string">"success"</span>: <span class="literal">true</span>, </span><br><span class="line">    <span class="string">"code"</span>: <span class="number">200</span>, </span><br><span class="line">    <span class="string">"msg"</span>: <span class="string">"success"</span>, </span><br><span class="line">    <span class="string">"data"</span>: [</span><br><span class="line">        {</span><br><span class="line">            <span class="string">"id"</span>: <span class="number">1</span>, </span><br><span class="line">            <span class="string">"avatar"</span>: <span class="string">"/static/category/front.png"</span>, </span><br><span class="line">            <span class="string">"categoryName"</span>: <span class="string">"前端"</span>, </span><br><span class="line">            <span class="string">"description"</span>: <span class="string">"前端是什么，大前端"</span></span><br><span class="line">        }, </span><br><span class="line">        {</span><br><span class="line">            <span class="string">"id"</span>: <span class="number">2</span>, </span><br><span class="line">            <span class="string">"avatar"</span>: <span class="string">"/static/category/back.png"</span>, </span><br><span class="line">            <span class="string">"categoryName"</span>: <span class="string">"后端"</span>, </span><br><span class="line">            <span class="string">"description"</span>: <span class="string">"后端最牛叉"</span></span><br><span class="line">        }, </span><br><span class="line">        {</span><br><span class="line">            <span class="string">"id"</span>: <span class="number">3</span>, </span><br><span class="line">            <span class="string">"avatar"</span>: <span class="string">"/static/category/lift.jpg"</span>, </span><br><span class="line">            <span class="string">"categoryName"</span>: <span class="string">"生活"</span>, </span><br><span class="line">            <span class="string">"description"</span>: <span class="string">"生活趣事"</span></span><br><span class="line">        }, </span><br><span class="line">        {</span><br><span class="line">            <span class="string">"id"</span>: <span class="number">4</span>, </span><br><span class="line">            <span class="string">"avatar"</span>: <span class="string">"/static/category/database.png"</span>, </span><br><span class="line">            <span class="string">"categoryName"</span>: <span class="string">"数据库"</span>, </span><br><span class="line">            <span class="string">"description"</span>: <span class="string">"没数据库，啥也不管用"</span></span><br><span class="line">        }, </span><br><span class="line">        {</span><br><span class="line">            <span class="string">"id"</span>: <span class="number">5</span>, </span><br><span class="line">            <span class="string">"avatar"</span>: <span class="string">"/static/category/language.png"</span>, </span><br><span class="line">            <span class="string">"categoryName"</span>: <span class="string">"编程语言"</span>, </span><br><span class="line">            <span class="string">"description"</span>: <span class="string">"好多语言，该学哪个？"</span></span><br><span class="line">        }</span><br><span class="line">    ]</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

<h3 id="3-22-2-编码"><a href="#3-22-2-编码" class="headerlink" title="3.22.2 编码"></a>3.22.2 编码</h3><h4 id="①-CategoryController控制类-1"><a href="#①-CategoryController控制类-1" class="headerlink" title="① CategoryController控制类"></a>① CategoryController控制类</h4><figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="meta">@RequestMapping("/categorys")</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">CategoryController</span> </span>{</span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> CategoryService categoryService;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@GetMapping("/detail")</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Result <span class="title">categoriesDetail</span><span class="params">()</span></span>{</span><br><span class="line">        <span class="keyword">return</span> categoryService.findAllCategoryDetail();</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

<h4 id="②-CategoryService服务类-1"><a href="#②-CategoryService服务类-1" class="headerlink" title="② CategoryService服务类"></a>② CategoryService服务类</h4><figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">CategoryService</span> </span>{</span><br><span class="line"></span><br><span class="line">    <span class="function">Result <span class="title">findAllCategoryDetail</span><span class="params">()</span></span>;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

<h4 id="③-CategoryServiceImpl实现类-1"><a href="#③-CategoryServiceImpl实现类-1" class="headerlink" title="③ CategoryServiceImpl实现类"></a>③ CategoryServiceImpl实现类</h4><figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">CategoryServiceImpl</span> <span class="keyword">implements</span> <span class="title">CategoryService</span> </span>{</span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> CategoryMapper categoryMapper;</span><br><span class="line">   </span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Result <span class="title">findAllCategoryDetail</span><span class="params">()</span> </span>{</span><br><span class="line">        List&lt;Category&gt; categories = categoryMapper.selectList(<span class="keyword">new</span> LambdaQueryWrapper&lt;&gt;());</span><br><span class="line">        <span class="keyword">return</span> Result.success(copyList(categories));</span><br><span class="line">    }</span><br><span class="line">    </span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

<h3 id="3-22-3-测试结果"><a href="#3-22-3-测试结果" class="headerlink" title="3.22.3 测试结果"></a>3.22.3 测试结果</h3><p><img src="C:\Users\95671\AppData\Roaming\Typora\typora-user-images\image-20220126145554083.png" alt="image-20220126145554083"></p>
<p>可以正常显示所有分类</p>
<h2 id="3-23-导航—文章标签功能"><a href="#3-23-导航—文章标签功能" class="headerlink" title="3.23 导航—文章标签功能"></a>3.23 导航—文章标签功能</h2><h3 id="3-23-1-接口说明"><a href="#3-23-1-接口说明" class="headerlink" title="3.23.1 接口说明"></a>3.23.1 接口说明</h3><ul>
<li>接口url：/tags/detail</li>
<li>请求方式：GET</li>
<li>请求参数：</li>
<li>返回数据：</li>
</ul>
<figure class="highlight js"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">{</span><br><span class="line">    <span class="string">"success"</span>: <span class="literal">true</span>, </span><br><span class="line">    <span class="string">"code"</span>: <span class="number">200</span>, </span><br><span class="line">    <span class="string">"msg"</span>: <span class="string">"success"</span>, </span><br><span class="line">    <span class="string">"data"</span>: [</span><br><span class="line">        {</span><br><span class="line">            <span class="string">"id"</span>: <span class="number">5</span>, </span><br><span class="line">            <span class="string">"tagName"</span>: <span class="string">"springboot"</span>, </span><br><span class="line">            <span class="string">"avatar"</span>: <span class="string">"/static/tag/java.png"</span></span><br><span class="line">        }, </span><br><span class="line">        {</span><br><span class="line">            <span class="string">"id"</span>: <span class="number">6</span>, </span><br><span class="line">            <span class="string">"tagName"</span>: <span class="string">"spring"</span>, </span><br><span class="line">            <span class="string">"avatar"</span>: <span class="string">"/static/tag/java.png"</span></span><br><span class="line">        }, </span><br><span class="line">        {</span><br><span class="line">            <span class="string">"id"</span>: <span class="number">7</span>, </span><br><span class="line">            <span class="string">"tagName"</span>: <span class="string">"springmvc"</span>, </span><br><span class="line">            <span class="string">"avatar"</span>: <span class="string">"/static/tag/java.png"</span></span><br><span class="line">        }, </span><br><span class="line">        {</span><br><span class="line">            <span class="string">"id"</span>: <span class="number">8</span>, </span><br><span class="line">            <span class="string">"tagName"</span>: <span class="string">"11"</span>, </span><br><span class="line">            <span class="string">"avatar"</span>: <span class="string">"/static/tag/css.png"</span></span><br><span class="line">        }</span><br><span class="line">    ]</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

<h3 id="3-23-2-编码"><a href="#3-23-2-编码" class="headerlink" title="3.23.2 编码"></a>3.23.2 编码</h3><h4 id="①-TagsController控制类-1"><a href="#①-TagsController控制类-1" class="headerlink" title="① TagsController控制类"></a>① TagsController控制类</h4><figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="meta">@RequestMapping("tags")</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TagsController</span> </span>{</span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> TagService tagService;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@GetMapping("/detail")</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Result <span class="title">findAllTagDetail</span><span class="params">()</span></span>{</span><br><span class="line">        <span class="keyword">return</span> tagService.findAllTagDetail();</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

<h4 id="②-TagService服务类-2"><a href="#②-TagService服务类-2" class="headerlink" title="② TagService服务类"></a>② TagService服务类</h4><figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">TagService</span> </span>{</span><br><span class="line">    <span class="function">Result <span class="title">findAllTagDetail</span><span class="params">()</span></span>;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

<h4 id="③-TagServiceImpl实现类-2"><a href="#③-TagServiceImpl实现类-2" class="headerlink" title="③ TagServiceImpl实现类"></a>③ TagServiceImpl实现类</h4><figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TagServiceImpl</span> <span class="keyword">implements</span> <span class="title">TagService</span> </span>{</span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> TagMapper tagMapper;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Result <span class="title">findAllTagDetail</span><span class="params">()</span> </span>{</span><br><span class="line">        List&lt;Tag&gt; tags = tagMapper.selectList(<span class="keyword">new</span> LambdaQueryWrapper&lt;&gt;());</span><br><span class="line">        <span class="keyword">return</span> Result.success(copyList(tags));</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

<h3 id="3-23-3-测试结果"><a href="#3-23-3-测试结果" class="headerlink" title="3.23.3 测试结果"></a>3.23.3 测试结果</h3><p><img src="C:\Users\95671\AppData\Roaming\Typora\typora-user-images\image-20220126145848483.png" alt="image-20220126145848483"></p>
<p>可以正常显示所有标签</p>
<h2 id="3-24-分类文章列表以及标签文章列表功能"><a href="#3-24-分类文章列表以及标签文章列表功能" class="headerlink" title="3.24 分类文章列表以及标签文章列表功能"></a>3.24 分类文章列表以及标签文章列表功能</h2><h3 id="3-24-1-接口说明"><a href="#3-24-1-接口说明" class="headerlink" title="3.24.1 接口说明"></a>3.24.1 接口说明</h3><h4 id="①-分类文章列表"><a href="#①-分类文章列表" class="headerlink" title="① 分类文章列表"></a>① 分类文章列表</h4><ul>
<li>接口url：/category/detail/{id}</li>
<li>请求方式：GET</li>
<li>请求参数：</li>
</ul>
<table>
<thead>
<tr>
<th>参数名称</th>
<th>参数类型</th>
<th>说明</th>
</tr>
</thead>
<tbody><tr>
<td>id</td>
<td>分类id</td>
<td>路径参数</td>
</tr>
</tbody></table>
<ul>
<li>返回数据：</li>
</ul>
<figure class="highlight js"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">{</span><br><span class="line">    <span class="string">"success"</span>: <span class="literal">true</span>, </span><br><span class="line">    <span class="string">"code"</span>: <span class="number">200</span>, </span><br><span class="line">    <span class="string">"msg"</span>: <span class="string">"success"</span>, </span><br><span class="line">    <span class="string">"data"</span>: </span><br><span class="line">        {</span><br><span class="line">            <span class="string">"id"</span>: <span class="number">1</span>, </span><br><span class="line">            <span class="string">"avatar"</span>: <span class="string">"/static/category/front.png"</span>, </span><br><span class="line">            <span class="string">"categoryName"</span>: <span class="string">"前端"</span>, </span><br><span class="line">            <span class="string">"description"</span>: <span class="string">"前端是什么，大前端"</span></span><br><span class="line">        }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

<h4 id="②-标签文章列表"><a href="#②-标签文章列表" class="headerlink" title="② 标签文章列表"></a>② 标签文章列表</h4><ul>
<li>接口url：/tags/detail/{id}</li>
<li>请求方式：GET</li>
<li>请求参数：</li>
</ul>
<table>
<thead>
<tr>
<th>参数名称</th>
<th>参数类型</th>
<th>说明</th>
</tr>
</thead>
<tbody><tr>
<td>id</td>
<td>标签id</td>
<td>路径参数</td>
</tr>
</tbody></table>
<ul>
<li>返回数据：</li>
</ul>
<figure class="highlight js"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">{</span><br><span class="line">    <span class="string">"success"</span>: <span class="literal">true</span>, </span><br><span class="line">    <span class="string">"code"</span>: <span class="number">200</span>, </span><br><span class="line">    <span class="string">"msg"</span>: <span class="string">"success"</span>, </span><br><span class="line">    <span class="string">"data"</span>: </span><br><span class="line">        {</span><br><span class="line">            <span class="string">"id"</span>: <span class="number">5</span>, </span><br><span class="line">            <span class="string">"tagName"</span>: <span class="string">"springboot"</span>, </span><br><span class="line">            <span class="string">"avatar"</span>: <span class="string">"/static/tag/java.png"</span></span><br><span class="line">        }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

<h3 id="3-24-2-编码"><a href="#3-24-2-编码" class="headerlink" title="3.24.2 编码"></a>3.24.2 编码</h3><h4 id="①-PageParam参数类"><a href="#①-PageParam参数类" class="headerlink" title="① PageParam参数类"></a>① PageParam参数类</h4><ul>
<li>当点击某一分类时，本质上是调用了显示文章列表的接口，但是只会显示所有文章，不能根据分类来显示，故需要在分页参数中加入categoryId这一属性，然后在接收参数时判断categoryId是否为空，若不为空，则在显示文章列表时，要过滤掉那些分类id不等于categoryId的文章</li>
<li>同理，要根据标签分类，就要加入tagId属性，要根据日期分类，就要加入year和month属性</li>
</ul>
<figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">PageParam</span> </span>{</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> page=<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> pageSize=<span class="number">10</span>;</span><br><span class="line">    <span class="keyword">private</span> Long categoryId;</span><br><span class="line">    <span class="keyword">private</span> Long tagId;</span><br><span class="line">    <span class="keyword">private</span> String year;</span><br><span class="line">    <span class="keyword">private</span> String month;</span><br><span class="line">    <span class="comment">//传递6的话变成06</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getMonth</span><span class="params">()</span></span>{</span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">this</span>.month != <span class="keyword">null</span> &amp;&amp; <span class="keyword">this</span>.month.length() == <span class="number">1</span>){</span><br><span class="line">            <span class="keyword">return</span> <span class="string">"0"</span>+<span class="keyword">this</span>.month;</span><br><span class="line">        }</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">this</span>.month;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

<h4 id="②-CategoryController和TagsController控制类"><a href="#②-CategoryController和TagsController控制类" class="headerlink" title="② CategoryController和TagsController控制类"></a>② CategoryController和TagsController控制类</h4><figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="meta">@RequestMapping("/categorys")</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">CategoryController</span> </span>{</span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> CategoryService categoryService;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@GetMapping("/detail/{id}")</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Result <span class="title">categoryDetailById</span><span class="params">(<span class="meta">@PathVariable("id")</span> Long id)</span></span>{</span><br><span class="line">        <span class="keyword">return</span> categoryService.categoryDetailById(id);</span><br><span class="line">    }</span><br><span class="line">}</span><br><span class="line"></span><br></pre></td></tr></tbody></table></figure>

<figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="meta">@RequestMapping("tags")</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TagsController</span> </span>{</span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> TagService tagService;</span><br><span class="line">    </span><br><span class="line">    <span class="meta">@GetMapping("/detail/{id}")</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Result <span class="title">findTagDetailById</span><span class="params">(<span class="meta">@PathVariable("id")</span> Long id)</span></span>{</span><br><span class="line">        <span class="keyword">return</span> tagService.findTagDetailById(id);</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

<h4 id="③-CategoryService和TagService服务类"><a href="#③-CategoryService和TagService服务类" class="headerlink" title="③ CategoryService和TagService服务类"></a>③ CategoryService和TagService服务类</h4><figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">CategoryService</span> </span>{</span><br><span class="line">    <span class="function">Result <span class="title">categoryDetailById</span><span class="params">(Long id)</span></span>;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

<figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">TagService</span> </span>{</span><br><span class="line">    <span class="function">Result <span class="title">findTagDetailById</span><span class="params">(Long id)</span></span>;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

<h4 id="④-CategoryServiceImpl和TagServiceImpl实现类"><a href="#④-CategoryServiceImpl和TagServiceImpl实现类" class="headerlink" title="④ CategoryServiceImpl和TagServiceImpl实现类"></a>④ CategoryServiceImpl和TagServiceImpl实现类</h4><figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">CategoryServiceImpl</span> <span class="keyword">implements</span> <span class="title">CategoryService</span> </span>{</span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> CategoryMapper categoryMapper;</span><br><span class="line">   </span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Result <span class="title">categoryDetailById</span><span class="params">(Long id)</span> </span>{</span><br><span class="line">        Category category=categoryMapper.selectById(id);</span><br><span class="line">        <span class="keyword">return</span> Result.success(copy(category));</span><br><span class="line">    }</span><br><span class="line">}</span><br><span class="line"></span><br></pre></td></tr></tbody></table></figure>

<figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TagServiceImpl</span> <span class="keyword">implements</span> <span class="title">TagService</span> </span>{</span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> TagMapper tagMapper;</span><br><span class="line">    </span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Result <span class="title">findTagDetailById</span><span class="params">(Long id)</span> </span>{</span><br><span class="line">        Tag tag=tagMapper.selectById(id);</span><br><span class="line">        <span class="keyword">return</span> Result.success(copy(tag));</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

<h4 id="⑤-ArticleServiceImpl实现类-1"><a href="#⑤-ArticleServiceImpl实现类-1" class="headerlink" title="⑤ ArticleServiceImpl实现类"></a>⑤ ArticleServiceImpl实现类</h4><figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ArticleServiceImpl</span> <span class="keyword">implements</span> <span class="title">ArticleService</span> </span>{</span><br><span class="line">    </span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> List&lt;ArticleVo&gt; <span class="title">listArticle</span><span class="params">(PageParam pageParam)</span> </span>{</span><br><span class="line">        Page&lt;Article&gt; page=<span class="keyword">new</span> Page&lt;&gt;(pageParam.getPage(),pageParam.getPageSize());</span><br><span class="line">        LambdaQueryWrapper&lt;Article&gt; queryWrapper=<span class="keyword">new</span> LambdaQueryWrapper&lt;&gt;();</span><br><span class="line">        <span class="comment">//第一项是根据是否置顶排序，第二项是根据创建时间排序</span></span><br><span class="line">        queryWrapper.orderByDesc(Article::getWeight,Article::getCreateDate);</span><br><span class="line">        <span class="keyword">if</span>(pageParam.getCategoryId()!=<span class="keyword">null</span>){<span class="comment">//若CategoryId不为空</span></span><br><span class="line">            <span class="comment">//只显示CategoryId与接收到的pageParam.getCategoryId()相同的文章</span></span><br><span class="line">            queryWrapper.eq(Article::getCategoryId,pageParam.getCategoryId());</span><br><span class="line">        }</span><br><span class="line">        List&lt;Long&gt; articleIdList =<span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line">        <span class="keyword">if</span>(pageParam.getTagId()!=<span class="keyword">null</span>){<span class="comment">//若TagId不为空</span></span><br><span class="line">            LambdaQueryWrapper&lt;ArticleTag&gt; articleTagLambdaQueryWrapper=<span class="keyword">new</span> LambdaQueryWrapper&lt;&gt;();</span><br><span class="line">            articleTagLambdaQueryWrapper.eq(ArticleTag::getTagId, pageParam.getTagId());</span><br><span class="line">            <span class="comment">//从article_tag表中获取与接收到的tagId相同的记录</span></span><br><span class="line">            List&lt;ArticleTag&gt; articleTags = articleTagMapper.selectList(articleTagLambdaQueryWrapper);</span><br><span class="line">            <span class="keyword">for</span> (ArticleTag articleTag : articleTags) {</span><br><span class="line">                <span class="comment">//将获取到的记录的articleId添加到articleIdList中</span></span><br><span class="line">                articleIdList.add(articleTag.getArticleId());</span><br><span class="line">            }</span><br><span class="line">            <span class="comment">//若articleIdList不为0，也就是有记录，到article表中根据id查询对应文章</span></span><br><span class="line">            <span class="keyword">if</span> (articleTags.size() &gt; <span class="number">0</span>) {</span><br><span class="line">                <span class="comment">// and id in(1,2,3)</span></span><br><span class="line">                queryWrapper.in(Article::getId,articleIdList);</span><br><span class="line">            }</span><br><span class="line">        }</span><br><span class="line">        Page&lt;Article&gt; articlePage = articleMapper.selectPage(page, queryWrapper);</span><br><span class="line">        List&lt;Article&gt; records = articlePage.getRecords();</span><br><span class="line">        List&lt;ArticleVo&gt;  articleVoList= copyList(records,<span class="keyword">true</span>,<span class="keyword">true</span>);</span><br><span class="line">        <span class="keyword">return</span> articleVoList;</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

<h3 id="3-24-3-测试结果"><a href="#3-24-3-测试结果" class="headerlink" title="3.24.3 测试结果"></a>3.24.3 测试结果</h3><p><img src="C:\Users\95671\AppData\Roaming\Typora\typora-user-images\image-20220126150314982.png" alt="image-20220126150314982"></p>
<p><img src="C:\Users\95671\AppData\Roaming\Typora\typora-user-images\image-20220126152445290.png" alt="image-20220126152445290"></p>
<p>可以正常显示某个分类或标签对应的文章列表</p>
<h2 id="3-25-归档文章列表"><a href="#3-25-归档文章列表" class="headerlink" title="3.25 归档文章列表"></a>3.25 归档文章列表</h2><p>实现出来有bug，能够成功从数据库查到文章数据，并且也返回给前端了，但是前端不显示任何文章，怀疑是前端问题，目前解决不了，暂不完成</p>
<h2 id="3-26-统一缓存处理（优化）"><a href="#3-26-统一缓存处理（优化）" class="headerlink" title="3.26 统一缓存处理（优化）"></a>3.26 统一缓存处理（优化）</h2><h3 id="3-26-1-功能说明"><a href="#3-26-1-功能说明" class="headerlink" title="3.26.1 功能说明"></a>3.26.1 功能说明</h3><ul>
<li>将一些访问量比较大的接口放入内存中，可以加快用户访问速度</li>
</ul>
<h3 id="3-26-2-编码"><a href="#3-26-2-编码" class="headerlink" title="3.26.2 编码"></a>3.26.2 编码</h3><h4 id="①-Cache接口"><a href="#①-Cache接口" class="headerlink" title="① Cache接口"></a>① Cache接口</h4><figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.ch.common.cache;</span><br><span class="line"><span class="keyword">import</span> java.lang.annotation.*;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Target({ElementType.METHOD})</span></span><br><span class="line"><span class="meta">@Retention(RetentionPolicy.RUNTIME)</span></span><br><span class="line"><span class="meta">@Documented</span></span><br><span class="line"><span class="keyword">public</span> <span class="meta">@interface</span> Cache {</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">long</span> <span class="title">expire</span><span class="params">()</span> <span class="keyword">default</span> 1 * 60 * 1000</span>;</span><br><span class="line"></span><br><span class="line">    <span class="function">String <span class="title">name</span><span class="params">()</span> <span class="keyword">default</span> ""</span>;</span><br><span class="line"></span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

<h4 id="②-CacheAspect增强类"><a href="#②-CacheAspect增强类" class="headerlink" title="② CacheAspect增强类"></a>② CacheAspect增强类</h4><ul>
<li>比较固定，可以直接copy</li>
</ul>
<figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.ch.common.cache;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.alibaba.fastjson.JSON;</span><br><span class="line"><span class="keyword">import</span> com.ch.model.params.Result;</span><br><span class="line"><span class="keyword">import</span> lombok.extern.slf4j.Slf4j;</span><br><span class="line"><span class="keyword">import</span> org.apache.commons.codec.digest.DigestUtils;</span><br><span class="line"><span class="keyword">import</span> org.apache.commons.lang3.StringUtils;</span><br><span class="line"><span class="keyword">import</span> org.aspectj.lang.ProceedingJoinPoint;</span><br><span class="line"><span class="keyword">import</span> org.aspectj.lang.Signature;</span><br><span class="line"><span class="keyword">import</span> org.aspectj.lang.annotation.Around;</span><br><span class="line"><span class="keyword">import</span> org.aspectj.lang.annotation.Aspect;</span><br><span class="line"><span class="keyword">import</span> org.aspectj.lang.annotation.Pointcut;</span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line"><span class="keyword">import</span> org.springframework.data.redis.core.RedisTemplate;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Component;</span><br><span class="line"><span class="keyword">import</span> java.lang.reflect.Method;</span><br><span class="line"><span class="keyword">import</span> java.time.Duration;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Aspect</span></span><br><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="meta">@Slf4j</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">CacheAspect</span> </span>{</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> RedisTemplate&lt;String, String&gt; redisTemplate;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Pointcut("@annotation(com.ch.common.cache.Cache)")</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">pt</span><span class="params">()</span></span>{}</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Around("pt()")</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Object <span class="title">around</span><span class="params">(ProceedingJoinPoint pjp)</span></span>{</span><br><span class="line">        <span class="keyword">try</span> {</span><br><span class="line">            Signature signature = pjp.getSignature();</span><br><span class="line">            <span class="comment">//类名</span></span><br><span class="line">            String className = pjp.getTarget().getClass().getSimpleName();</span><br><span class="line">            <span class="comment">//调用的方法名</span></span><br><span class="line">            String methodName = signature.getName();</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">            Class[] parameterTypes = <span class="keyword">new</span> Class[pjp.getArgs().length];</span><br><span class="line">            Object[] args = pjp.getArgs();</span><br><span class="line">            <span class="comment">//参数</span></span><br><span class="line">            String params = <span class="string">""</span>;</span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>; i&lt;args.length; i++) {</span><br><span class="line">                <span class="keyword">if</span>(args[i] != <span class="keyword">null</span>) {</span><br><span class="line">                    params += JSON.toJSONString(args[i]);</span><br><span class="line">                    parameterTypes[i] = args[i].getClass();</span><br><span class="line">                }<span class="keyword">else</span> {</span><br><span class="line">                    parameterTypes[i] = <span class="keyword">null</span>;</span><br><span class="line">                }</span><br><span class="line">            }</span><br><span class="line">            <span class="keyword">if</span> (StringUtils.isNotEmpty(params)) {</span><br><span class="line">                <span class="comment">//加密 以防出现key过长以及字符转义获取不到的情况</span></span><br><span class="line">                params = DigestUtils.md5Hex(params);</span><br><span class="line">            }</span><br><span class="line">            Method method = pjp.getSignature().getDeclaringType().getMethod(methodName, parameterTypes);</span><br><span class="line">            <span class="comment">//获取Cache注解</span></span><br><span class="line">            Cache annotation = method.getAnnotation(Cache.class);</span><br><span class="line">            <span class="comment">//缓存过期时间</span></span><br><span class="line">            <span class="keyword">long</span> expire = annotation.expire();</span><br><span class="line">            <span class="comment">//缓存名称</span></span><br><span class="line">            String name = annotation.name();</span><br><span class="line">            <span class="comment">//先从redis获取</span></span><br><span class="line">            String redisKey = name + <span class="string">"::"</span> + className+<span class="string">"::"</span>+methodName+<span class="string">"::"</span>+params;</span><br><span class="line">            String redisValue = redisTemplate.opsForValue().get(redisKey);</span><br><span class="line">            <span class="keyword">if</span> (StringUtils.isNotEmpty(redisValue)){</span><br><span class="line">                log.info(<span class="string">"走了缓存~~~,{},{}"</span>,className,methodName);</span><br><span class="line">                <span class="keyword">return</span> JSON.parseObject(redisValue, Result.class);</span><br><span class="line">            }</span><br><span class="line">            Object proceed = pjp.proceed();</span><br><span class="line">            redisTemplate.opsForValue().set(redisKey,JSON.toJSONString(proceed), Duration.ofMillis(expire));</span><br><span class="line">            log.info(<span class="string">"存入缓存~~~ {},{}"</span>,className,methodName);</span><br><span class="line">            <span class="keyword">return</span> proceed;</span><br><span class="line">        } <span class="keyword">catch</span> (Throwable throwable) {</span><br><span class="line">            throwable.printStackTrace();</span><br><span class="line">        }</span><br><span class="line">        <span class="keyword">return</span> Result.fail(-<span class="number">999</span>,<span class="string">"系统错误"</span>);</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

<h4 id="③-应用"><a href="#③-应用" class="headerlink" title="③ 应用"></a>③ 应用</h4><figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//比如说在ArticleController中的请求上加上@Cache注解，expire和name是我们规定的参数，一个表示缓存时间，一个表示功能名字</span></span><br><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="meta">@RequestMapping("/articles")</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ArticleController</span> </span>{</span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> ArticleService articleService;</span><br><span class="line">    </span><br><span class="line">    <span class="meta">@PostMapping</span></span><br><span class="line">    <span class="meta">@Cache(expire = 5 * 60 * 1000,name = "listArticle")</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Result <span class="title">listArticle</span><span class="params">(<span class="meta">@RequestBody</span> PageParam pageParam)</span></span>{<span class="comment">//用pageParam接收前端的参数</span></span><br><span class="line">        <span class="keyword">return</span> Result.success(articleService.listArticle(pageParam));</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

<h3 id="3-26-3-测试结果"><a href="#3-26-3-测试结果" class="headerlink" title="3.26.3 测试结果"></a>3.26.3 测试结果</h3><p><img src="C:\Users\95671\AppData\Roaming\Typora\typora-user-images\image-20220127134901207.png" alt="image-20220127134901207"></p>
<p><img src="C:\Users\95671\AppData\Roaming\Typora\typora-user-images\image-20220127134934438.png" alt="image-20220127134934438"></p>
<p>成功存入内存，并且再次访问时，从内存中读取缓存</p>

                
            </div>
            <hr/>

            

    <div class="reprint" id="reprint-statement">
        
            <div class="reprint__author">
                <span class="reprint-meta" style="font-weight: bold;">
                    <i class="fas fa-user">
                        文章作者:
                    </i>
                </span>
                <span class="reprint-info">
                    <a href="/about" rel="external nofollow noreferrer">ch</a>
                </span>
            </div>
            <div class="reprint__type">
                <span class="reprint-meta" style="font-weight: bold;">
                    <i class="fas fa-link">
                        文章链接:
                    </i>
                </span>
                <span class="reprint-info">
                    <a href="http://example.com/2022/01/19/%E5%8D%9A%E5%AE%A2%E7%B3%BB%E7%BB%9F%E7%AC%94%E8%AE%B0/">http://example.com/2022/01/19/%E5%8D%9A%E5%AE%A2%E7%B3%BB%E7%BB%9F%E7%AC%94%E8%AE%B0/</a>
                </span>
            </div>
            <div class="reprint__notice">
                <span class="reprint-meta" style="font-weight: bold;">
                    <i class="fas fa-copyright">
                        版权声明:
                    </i>
                </span>
                <span class="reprint-info">
                    本博客所有文章除特別声明外，均采用
                    <a href="https://creativecommons.org/licenses/by/4.0/deed.zh" rel="external nofollow noreferrer" target="_blank">CC BY 4.0</a>
                    许可协议。转载请注明来源
                    <a href="/about" target="_blank">ch</a>
                    !
                </span>
            </div>
        
    </div>

    <script async defer>
      document.addEventListener("copy", function (e) {
        let toastHTML = '<span>复制成功，请遵循本文的转载规则</span><button class="btn-flat toast-action" onclick="navToReprintStatement()" style="font-size: smaller">查看</a>';
        M.toast({html: toastHTML})
      });

      function navToReprintStatement() {
        $("html, body").animate({scrollTop: $("#reprint-statement").offset().top - 80}, 800);
      }
    </script>



            <div class="tag_share" style="display: block;">
                <div class="post-meta__tag-list" style="display: inline-block;">
                    
                        <div class="article-tag">
                            <span class="chip bg-color">无标签</span>
                        </div>
                    
                </div>
                <div class="post_share" style="zoom: 80%; width: fit-content; display: inline-block; float: right; margin: -0.15rem 0;">
                    <link rel="stylesheet" type="text/css" href="/libs/share/css/share.min.css">
<div id="article-share">

    
    <div class="social-share" data-sites="twitter,facebook,google,qq,qzone,wechat,weibo,douban,linkedin" data-wechat-qrcode-helper="<p>微信扫一扫即可分享！</p>"></div>
    <script src="/libs/share/js/social-share.min.js"></script>
    

    

</div>

                </div>
            </div>
            
        </div>
    </div>

    

    

    

    

    

    

    

    

    

    

<article id="prenext-posts" class="prev-next articles">
    <div class="row article-row">
        
        <div class="article col s12 m6" data-aos="fade-up">
            <div class="article-badge left-badge text-color">
                <i class="fas fa-chevron-left"></i>&nbsp;上一篇</div>
            <div class="card">
                <a href="/2022/01/28/hello-world/">
                    <div class="card-image">
                        
                        
                        <img src="/medias/featureimages/12.jpg" class="responsive-img" alt="Hello World">
                        
                        <span class="card-title">Hello World</span>
                    </div>
                </a>
                <div class="card-content article-content">
                    <div class="summary block-with-text">
                        
                            
                        
                    </div>
                    <div class="publish-info">
                        <span class="publish-date">
                            <i class="far fa-clock fa-fw icon-date"></i>2022-01-28
                        </span>
                        <span class="publish-author">
                            
                            <i class="fas fa-user fa-fw"></i>
                            ch
                            
                        </span>
                    </div>
                </div>
                
            </div>
        </div>
        
        
        <div class="article col s12 m6" data-aos="fade-up">
            <div class="article-badge right-badge text-color">
                下一篇&nbsp;<i class="fas fa-chevron-right"></i>
            </div>
            <div class="card">
                <a href="/2022/01/13/20220113_springboot2/">
                    <div class="card-image">
                        
                        
                        <img src="/medias/featureimages/0.jpg" class="responsive-img" alt="">
                        
                        <span class="card-title"></span>
                    </div>
                </a>
                <div class="card-content article-content">
                    <div class="summary block-with-text">
                        
                            
                        
                    </div>
                    <div class="publish-info">
                            <span class="publish-date">
                                <i class="far fa-clock fa-fw icon-date"></i>2022-01-13
                            </span>
                        <span class="publish-author">
                            
                            <i class="fas fa-user fa-fw"></i>
                            ch
                            
                        </span>
                    </div>
                </div>
                
            </div>
        </div>
        
    </div>
</article>

</div>



<!-- 代码块功能依赖 -->
<script type="text/javascript" src="/libs/codeBlock/codeBlockFuction.js"></script>

<!-- 代码语言 -->

<script type="text/javascript" src="/libs/codeBlock/codeLang.js"></script>


<!-- 代码块复制 -->

<script type="text/javascript" src="/libs/codeBlock/codeCopy.js"></script>


<!-- 代码块收缩 -->

<script type="text/javascript" src="/libs/codeBlock/codeShrink.js"></script>


    </div>
    <div id="toc-aside" class="expanded col l3 hide-on-med-and-down">
        <div class="toc-widget card" style="background-color: white;">
            <div class="toc-title"><i class="far fa-list-alt"></i>&nbsp;&nbsp;目录</div>
            <div id="toc-content"></div>
        </div>
    </div>
</div>

<!-- TOC 悬浮按钮. -->

<div id="floating-toc-btn" class="hide-on-med-and-down">
    <a class="btn-floating btn-large bg-color">
        <i class="fas fa-list-ul"></i>
    </a>
</div>


<script src="/libs/tocbot/tocbot.min.js"></script>
<script>
    $(function () {
        tocbot.init({
            tocSelector: '#toc-content',
            contentSelector: '#articleContent',
            headingsOffset: -($(window).height() * 0.4 - 45),
            collapseDepth: Number('0'),
            headingSelector: 'h2, h3, h4'
        });

        // modify the toc link href to support Chinese.
        let i = 0;
        let tocHeading = 'toc-heading-';
        $('#toc-content a').each(function () {
            $(this).attr('href', '#' + tocHeading + (++i));
        });

        // modify the heading title id to support Chinese.
        i = 0;
        $('#articleContent').children('h2, h3, h4').each(function () {
            $(this).attr('id', tocHeading + (++i));
        });

        // Set scroll toc fixed.
        let tocHeight = parseInt($(window).height() * 0.4 - 64);
        let $tocWidget = $('.toc-widget');
        $(window).scroll(function () {
            let scroll = $(window).scrollTop();
            /* add post toc fixed. */
            if (scroll > tocHeight) {
                $tocWidget.addClass('toc-fixed');
            } else {
                $tocWidget.removeClass('toc-fixed');
            }
        });

        
        /* 修复文章卡片 div 的宽度. */
        let fixPostCardWidth = function (srcId, targetId) {
            let srcDiv = $('#' + srcId);
            if (srcDiv.length === 0) {
                return;
            }

            let w = srcDiv.width();
            if (w >= 450) {
                w = w + 21;
            } else if (w >= 350 && w < 450) {
                w = w + 18;
            } else if (w >= 300 && w < 350) {
                w = w + 16;
            } else {
                w = w + 14;
            }
            $('#' + targetId).width(w);
        };

        // 切换TOC目录展开收缩的相关操作.
        const expandedClass = 'expanded';
        let $tocAside = $('#toc-aside');
        let $mainContent = $('#main-content');
        $('#floating-toc-btn .btn-floating').click(function () {
            if ($tocAside.hasClass(expandedClass)) {
                $tocAside.removeClass(expandedClass).hide();
                $mainContent.removeClass('l9');
            } else {
                $tocAside.addClass(expandedClass).show();
                $mainContent.addClass('l9');
            }
            fixPostCardWidth('artDetail', 'prenext-posts');
        });
        
    });
</script>

    

</main>




    <footer class="page-footer bg-color">
    
        <link rel="stylesheet" href="/libs/aplayer/APlayer.min.css">
<style>
    .aplayer .aplayer-lrc p {
        
        display: none;
        
        font-size: 12px;
        font-weight: 700;
        line-height: 16px !important;
    }

    .aplayer .aplayer-lrc p.aplayer-lrc-current {
        
        display: none;
        
        font-size: 15px;
        color: #42b983;
    }

    
    .aplayer.aplayer-fixed.aplayer-narrow .aplayer-body {
        left: -66px !important;
    }

    .aplayer.aplayer-fixed.aplayer-narrow .aplayer-body:hover {
        left: 0px !important;
    }

    
</style>
<div class="">
    
    <div class="row">
        <meting-js class="col l8 offset-l2 m10 offset-m1 s12"
                   server="netease"
                   type="song"
                   id="1436193759"
                   fixed='true'
                   autoplay='true'
                   theme='#42b983'
                   loop='all'
                   order='random'
                   preload='auto'
                   volume='0.7'
                   list-folded='true'
        >
        </meting-js>
    </div>
</div>

<script src="/libs/aplayer/APlayer.min.js"></script>
<script src="/libs/aplayer/Meting.min.js"></script>

    

    <div class="container row center-align"
         style="margin-bottom: 15px !important;">
        <div class="col s12 m8 l8 copy-right">
            Copyright&nbsp;&copy;
            
                <span id="year">2021-2022</span>
            
            <a href="/about" target="_blank">ch</a>
            |&nbsp;Powered by CH;
            |&nbsp;Theme ❤;
            <br>
            
            
            
                
            
            
                <span id="busuanzi_container_site_pv">
                &nbsp;|&nbsp;<i class="far fa-eye"></i>&nbsp;总访问量:&nbsp;
                    <span id="busuanzi_value_site_pv" class="white-color"></span>
            </span>
            
            
                <span id="busuanzi_container_site_uv">
                &nbsp;|&nbsp;<i class="fas fa-users"></i>&nbsp;总访问人数:&nbsp;
                    <span id="busuanzi_value_site_uv" class="white-color"></span>
            </span>
            
            <br>

            <!-- 运行天数提醒. -->
            
                <span id="sitetime"> Loading ...</span>
                <script>
                    var calcSiteTime = function () {
                        var seconds = 1000;
                        var minutes = seconds * 60;
                        var hours = minutes * 60;
                        var days = hours * 24;
                        var years = days * 365;
                        var today = new Date();
                        var startYear = "2021";
                        var startMonth = "8";
                        var startDate = "16";
                        var startHour = "0";
                        var startMinute = "0";
                        var startSecond = "0";
                        var todayYear = today.getFullYear();
                        var todayMonth = today.getMonth() + 1;
                        var todayDate = today.getDate();
                        var todayHour = today.getHours();
                        var todayMinute = today.getMinutes();
                        var todaySecond = today.getSeconds();
                        var t1 = Date.UTC(startYear, startMonth, startDate, startHour, startMinute, startSecond);
                        var t2 = Date.UTC(todayYear, todayMonth, todayDate, todayHour, todayMinute, todaySecond);
                        var diff = t2 - t1;
                        var diffYears = Math.floor(diff / years);
                        var diffDays = Math.floor((diff / days) - diffYears * 365);

                        // 区分是否有年份.
                        var language = 'zh-CN';
                        if (startYear === String(todayYear)) {
                            document.getElementById("year").innerHTML = todayYear;
                            var daysTip = 'This site has been running for ' + diffDays + ' days';
                            if (language === 'zh-CN') {
                                daysTip = '本站已运行 ' + diffDays + ' 天';
                            } else if (language === 'zh-HK') {
                                daysTip = '本站已運行 ' + diffDays + ' 天';
                            }
                            document.getElementById("sitetime").innerHTML = daysTip;
                        } else {
                            document.getElementById("year").innerHTML = startYear + " - " + todayYear;
                            var yearsAndDaysTip = 'This site has been running for ' + diffYears + ' years and '
                                + diffDays + ' days';
                            if (language === 'zh-CN') {
                                yearsAndDaysTip = '本站已运行 ' + diffYears + ' 年 ' + diffDays + ' 天';
                            } else if (language === 'zh-HK') {
                                yearsAndDaysTip = '本站已運行 ' + diffYears + ' 年 ' + diffDays + ' 天';
                            }
                            document.getElementById("sitetime").innerHTML = yearsAndDaysTip;
                        }
                    }

                    calcSiteTime();
                </script>
            
            <br>
            
        </div>
        <div class="col s12 m4 l4 social-link social-statis">














</div>
    </div>
</footer>

<div class="progress-bar"></div>


    <!-- 搜索遮罩框 -->
<div id="searchModal" class="modal">
    <div class="modal-content">
        <div class="search-header">
            <span class="title"><i class="fas fa-search"></i>&nbsp;&nbsp;搜索</span>
            <input type="search" id="searchInput" name="s" placeholder="请输入搜索的关键字"
                   class="search-input">
        </div>
        <div id="searchResult"></div>
    </div>
</div>

<script type="text/javascript">
$(function () {
    var searchFunc = function (path, search_id, content_id) {
        'use strict';
        $.ajax({
            url: path,
            dataType: "xml",
            success: function (xmlResponse) {
                // get the contents from search data
                var datas = $("entry", xmlResponse).map(function () {
                    return {
                        title: $("title", this).text(),
                        content: $("content", this).text(),
                        url: $("url", this).text()
                    };
                }).get();
                var $input = document.getElementById(search_id);
                var $resultContent = document.getElementById(content_id);
                $input.addEventListener('input', function () {
                    var str = '<ul class=\"search-result-list\">';
                    var keywords = this.value.trim().toLowerCase().split(/[\s\-]+/);
                    $resultContent.innerHTML = "";
                    if (this.value.trim().length <= 0) {
                        return;
                    }
                    // perform local searching
                    datas.forEach(function (data) {
                        var isMatch = true;
                        var data_title = data.title.trim().toLowerCase();
                        var data_content = data.content.trim().replace(/<[^>]+>/g, "").toLowerCase();
                        var data_url = data.url;
                        data_url = data_url.indexOf('/') === 0 ? data.url : '/' + data_url;
                        var index_title = -1;
                        var index_content = -1;
                        var first_occur = -1;
                        // only match artiles with not empty titles and contents
                        if (data_title !== '' && data_content !== '') {
                            keywords.forEach(function (keyword, i) {
                                index_title = data_title.indexOf(keyword);
                                index_content = data_content.indexOf(keyword);
                                if (index_title < 0 && index_content < 0) {
                                    isMatch = false;
                                } else {
                                    if (index_content < 0) {
                                        index_content = 0;
                                    }
                                    if (i === 0) {
                                        first_occur = index_content;
                                    }
                                }
                            });
                        }
                        // show search results
                        if (isMatch) {
                            str += "<li><a href='" + data_url + "' class='search-result-title'>" + data_title + "</a>";
                            var content = data.content.trim().replace(/<[^>]+>/g, "");
                            if (first_occur >= 0) {
                                // cut out 100 characters
                                var start = first_occur - 20;
                                var end = first_occur + 80;
                                if (start < 0) {
                                    start = 0;
                                }
                                if (start === 0) {
                                    end = 100;
                                }
                                if (end > content.length) {
                                    end = content.length;
                                }
                                var match_content = content.substr(start, end);
                                // highlight all keywords
                                keywords.forEach(function (keyword) {
                                    var regS = new RegExp(keyword, "gi");
                                    match_content = match_content.replace(regS, "<em class=\"search-keyword\">" + keyword + "</em>");
                                });

                                str += "<p class=\"search-result\">" + match_content + "...</p>"
                            }
                            str += "</li>";
                        }
                    });
                    str += "</ul>";
                    $resultContent.innerHTML = str;
                });
            }
        });
    };

    searchFunc('/search.xml', 'searchInput', 'searchResult');
});
</script>

    <!-- 回到顶部按钮 -->
<div id="backTop" class="top-scroll">
    <a class="btn-floating btn-large waves-effect waves-light" href="#!">
        <i class="fas fa-arrow-up"></i>
    </a>
</div>


    <script src="/libs/materialize/materialize.min.js"></script>
    <script src="/libs/masonry/masonry.pkgd.min.js"></script>
    <script src="/libs/aos/aos.js"></script>
    <script src="/libs/scrollprogress/scrollProgress.min.js"></script>
    <script src="/libs/lightGallery/js/lightgallery-all.min.js"></script>
    <script src="/js/matery.js"></script>

    

    

    <!-- 雪花特效 -->
    

    <!-- 鼠标星星特效 -->
    

     
        <script src="https://ssl.captcha.qq.com/TCaptcha.js"></script>
        <script src="/libs/others/TencentCaptcha.js"></script>
        <button id="TencentCaptcha" data-appid="xxxxxxxxxx" data-cbfn="callback" type="button" hidden></button>
    

    <!-- Baidu Analytics -->

    <!-- Baidu Push -->

<script>
    (function () {
        var bp = document.createElement('script');
        var curProtocol = window.location.protocol.split(':')[0];
        if (curProtocol === 'https') {
            bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';
        } else {
            bp.src = 'http://push.zhanzhang.baidu.com/push.js';
        }
        var s = document.getElementsByTagName("script")[0];
        s.parentNode.insertBefore(bp, s);
    })();
</script>

    
    <script src="/libs/others/clicklove.js" async="async"></script>
    
    
    <script async src="/libs/others/busuanzi.pure.mini.js"></script>
    

    

     <!-- 天气接口 -->
    
        <!-- 天气接口-->
<script type="text/javascript">
    WIDGET = {FID: '1tFpFZ5Mtj'}
  </script>
<script type="text/javascript">
    //只在桌面版网页启用特效
    var windowWidth = $(window).width();
    if (windowWidth > 768) {
        document.write('<script type="text/javascript" src="https://apip.weatherdt.com/float/static/js/r.js?v=1111"><\/script>');
        }
  </script>

      

  <!-- 动态标题 -->
    <script type="text/javascript"> var OriginTitile = document.title, st; 
        document.addEventListener("visibilitychange", function () { document.hidden ? (document.title = "Σ(っ °Д °;)っ喔哟，你要走了吗！", clearTimeout(st)) : (document.title = "φ(゜▽゜*)♪咦，你回来辣！", st = setTimeout(function () { document.title = OriginTitile }, 3e3)) }) </script>
        


    

    <!--腾讯兔小巢-->
    
    

    

    

    
    <script src="/libs/instantpage/instantpage.js" type="module"></script>
    

</body>

</html>
